"use strict";(self.webpackChunkvelzon=self.webpackChunkvelzon||[]).push([[392],{75922:(B,x,c)=>{c.d(x,{X:()=>T});var n=c(67569),v=c(45312),f=c(21413),e=c(54438),C=c(21626);let T=(()=>{class O extends n.d{constructor(_){super(_,v.c.apiUrl+"Agent/"),this.clientNumber=new f.B,this.clientNumber$=this.clientNumber.asObservable()}GetAgentLookUps(){return this.http.get(this.baseUrl+"AgentLookUps")}getOrders(_){return this.http.post(this.baseUrl+"ClientOrders",_)}getInvoices(_){return this.http.post(this.baseUrl+"ClientInvoices",_)}GetByMobile(_){return this.http.get(this.baseUrl+"GetByMobile/"+_)}AddLocation(_){return this.http.post(this.baseUrl+"AddLocation",_)}EditLocation(_){return this.http.put(this.baseUrl+"EditLocation",_)}DeleteLocation(_){return this.http.delete(this.baseUrl+"DeleteLocation/"+_,this.httpOptions)}static{this.\u0275fac=function(M){return new(M||O)(e.KVO(C.Qq))}}static{this.\u0275prov=e.jDH({token:O,factory:O.\u0275fac,providedIn:"root"})}}return O})()},33826:(B,x,c)=>{c.d(x,{Q:()=>C});var n=c(67569),v=c(45312),f=c(54438),e=c(21626);let C=(()=>{class T extends n.d{constructor(l){super(l,v.c.apiUrl+"Order/")}GetOrderLookUp(){return this.http.get(this.baseUrl+"OrderLookUp")}districtsByCity(l){return this.http.get(this.baseUrl+"districtsByCity/"+l)}registerNewOrder(l){return this.http.post(this.baseUrl+"RegisterNewOrder",l)}EditOrder(l){return this.http.post(this.baseUrl+"EditOrder",l)}getServicesByCategory(l){return this.http.post(this.baseUrl+"servicesByCategory",l)}getPendingOrders(l){return this.http.post(this.baseUrl+"GetAllPendingOrder",l)}getRecallOrders(l){return this.http.post(this.baseUrl+"GetAllRecallOrder",l)}getAfterSale(l){return this.http.post(this.baseUrl+"GetAfterSale",l)}UpdateCallCounter(l){return this.http.put(this.baseUrl+"UpdateCallCounter/"+l,{})}SubmitOrder(l){return this.http.put(this.baseUrl+"SureOrder/"+l,{})}assignOrder(l){return this.http.put(this.baseUrl+"AssignOrder/"+l,{})}SureOrderRollBack(l){return this.http.put(this.baseUrl+"SureOrderRollBack/"+l,{})}GetChartData(l){return this.http.post(this.baseUrl+"GetDailySummary",l)}GetTotalOrderSummaryChart(l){return this.http.post(this.baseUrl+"GetTotalOrderSummaryChart",l)}GetTotalOrderTableSummaryChart(l){return this.http.post(this.baseUrl+"GetTotalOrderTableSummaryChart",l)}GetChartLookup(){return this.http.get(this.baseUrl+"GetChartLookup")}GetTimeAvailableLookup(){return this.http.get(this.baseUrl+"GetTimeAvailableLookup")}GetAvailableTime(l){return this.http.post(this.baseUrl+"GetAvailableTime",l)}ReopenOrder(l){return this.http.put(this.baseUrl+"ReopenOrder",l)}CancelOrder(l){return this.http.put(this.baseUrl+"CancelOrder",l)}ChangeTeamStatus(l){return this.http.put(this.baseUrl+"ChangeTeamStatus",l)}GetById(l){return this.http.get(this.baseUrl+"GetById/"+l)}GoLead(l){return this.http.get(this.baseUrl+"GoLead/"+l)}GetOrderTimeLine(l){return this.http.get(this.baseUrl+"GetOrderTimeLine/"+l)}SaveNoAnswer(l){return this.http.get(this.baseUrl+"SaveNoAnswer/"+l)}RemoveAssign(l){return this.http.put(this.baseUrl+"RemoveAssign/"+l,{})}GetTeamByCity(l){return this.http.post(this.baseUrl+"GetTeamByCity",l)}static{this.\u0275fac=function(_){return new(_||T)(f.KVO(e.Qq))}}static{this.\u0275prov=f.jDH({token:T,factory:T.\u0275fac,providedIn:"root"})}}return T})()},75392:(B,x,c)=>{c.d(x,{L:()=>De});var n=c(21413),v=c(56977),f=c(36158),e=c(54438),C=c(8147),T=c(33826),O=c(3888),l=c(1530),_=c(60177),M=c(69005),b=c(89417),R=c(29935),P=c(80388),G=c(75922),L=c(72510),$=c(41631);function U(s,u){if(1&s){const t=e.RV6();e.j41(0,"button",20),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.checkByMobile())}),e.EFF(1),e.nI1(2,"translate"),e.k0s()}2&s&&(e.R7$(),e.JRh(e.bMT(2,1,"general.search")))}function V(s,u){if(1&s){const t=e.RV6();e.j41(0,"button",20),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.checkByOrderCode())}),e.EFF(1),e.nI1(2,"translate"),e.k0s()}2&s&&(e.R7$(),e.JRh(e.bMT(2,1,"general.search")))}function w(s,u){1&s&&(e.j41(0,"div",21),e.EFF(1," general.message.filedIdRequired "),e.k0s())}let X=(()=>{class s{constructor(t,i,r,o,p){this.translateService=t,this.baseService=i,this.clientService=r,this.alertService=o,this.ngxLoader=p,this.form={},this.keySelected="",this.notifier=new n.B,this.mainDelay=100,this.loaderSearchShap=f.cX,this.loaderOperationShap=f.$$,this.operationLoader=f.ZW,this.isEditForm=!1,this.showEdit=!1,this.channels=[],this.districts=[],this.cities=[],this.orderTypes=[],this.isInner=!1,this.paymentTypes=[],this.isClientFound=!0,this.errorMessage="",this.setFormByOrderCode=new e.bkB,this.calacTotal=new e.bkB,this.isOrderEdit=!0}ngOnDestroy(){this.notifier.next(),this.notifier.complete()}ngOnInit(){this.form.orderCode>0?this.checkByOrderCode():this.form.agent.mobile>0&&this.checkByMobile(),this.clientService.clientNumber$.subscribe(()=>{this.checkByMobile(!1)})}getDistricts(t){this.ngxLoader.startLoader(f.ZW),this.baseService.districtsByCity(t).pipe((0,v.Q)(this.notifier)).subscribe(i=>{this.districts=i.data,this.ngxLoader.stopLoader(f.ZW)},i=>{console.log(i)})}mapRegisterForm(t){let i={...t};return i.id=0,i}getTranslationText(t){let i="";return this.translateService.get(t).pipe((0,v.Q)(this.notifier)).subscribe(r=>{i=r}),i}checkByOrderCode(){this.ngxLoader.startLoader("order"),this.baseService.GetById(this.form.orderCode).pipe((0,v.Q)(this.notifier)).subscribe(t=>{t.success?(this.ngxLoader.stopLoader("order"),this.setFormByOrderCode.next(t.data)):(this.ngxLoader.stopLoader("order"),this.alertService.error())},()=>{this.ngxLoader.stopLoader("order"),this.alertService.error()})}checkByMobile(t=!0){this.validatePhoneNumber(this.form.agent.mobile)?(this.ngxLoader.startLoader("order"),this.clientService.GetByMobile(this.form.agent.mobile).pipe((0,v.Q)(this.notifier)).subscribe(i=>{i.success?(this.form.agent.agentName=i.data.agentName,this.form.agent.agentCode=i.data.agentCode,this.form.agent.cityCode=i.data.cityCode,this.form.agent.agentAddStatusCode=2,this.form.locations=i.data.locations,this.getDistricts(i.data.cityCode),t&&this.alertService.success("orderManagement.order.clientFound"),this.isClientFound=!0):(this.isClientFound=!1,t&&this.alertService.error("orderManagement.order.clientNotFound")),this.ngxLoader.stopLoader("order")},()=>{this.ngxLoader.stopLoader("order")})):this.alertService.error(this.errorMessage)}validatePhoneNumber(t){return this.errorMessage="",10!==t.length?(this.errorMessage="orderManagement.order.phoneMust10Digit",!1):t.startsWith("05")?/^\d+$/.test(t)?(this.errorMessage="",!0):(this.errorMessage="orderManagement.order.phoneMustContainOnlyDigit",!1):(this.errorMessage="orderManagement.order.phoneMustStart05.",!1)}static{this.\u0275fac=function(i){return new(i||s)(e.rXU(C.c$),e.rXU(T.Q),e.rXU(G.X),e.rXU(O.u),e.rXU(l.eD))}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["app-client-info"]],inputs:{form:"form",channels:"channels",districts:"districts",cities:"cities",orderTypes:"orderTypes",isInner:"isInner",isOrderEdit:"isOrderEdit"},outputs:{setFormByOrderCode:"setFormByOrderCode",calacTotal:"calacTotal"},decls:37,vars:23,consts:[["mobile","ngModel"],["orderCode","ngModel"],["agentName","ngModel"],[1,"row","mt-4"],[1,"col-12","col-md-6","mb-3"],["for","mobile","translate","",1,"required","fw-bold","form-label"],[1,"input-group"],["InputTirmFilter","","name","mobile","type","search","maxlength","10","minlength","10","id","mobile","required","",1,"form-control","fs-6",3,"keydown.enter","ngModelChange","disabled","ngModel"],["class","btn btn-primary","type","button","id","button-addon2",3,"click",4,"ngIf"],["for","mobile","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","name","orderCode","type","search","id","orderCode",1,"form-control","fs-6",3,"ngModelChange","disabled","ngModel"],["for","name","translate","",1,"required","fw-bold","form-label"],["InputTirmFilter","","name","agentName","type","text","id","agentName","required","",1,"form-control","fs-6",3,"ngModelChange","disabled","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["translate","",1,"required","fw-bold","form-label","w-100"],["name","cityCode","bindValue","id","bindLabel","name","required","",3,"ngModelChange","disabled","items","multiple","ngModel"],["translate","",1,"fw-bold","form-label","w-100"],["name","cityCode","bindValue","id","bindLabel","name",3,"ngModelChange","disabled","items","multiple","ngModel"],["name","channelCode","bindValue","id","bindLabel","name",3,"ngModelChange","disabled","filter","items","multiple","ngModel"],["name","isUrgent","inputId","isUrgent",3,"ngModelChange","ngModel"],["type","button","id","button-addon2",1,"btn","btn-primary",3,"click"],["translate","",1,"text-danger","text-center"]],template:function(i,r){if(1&i){const o=e.RV6();e.j41(0,"div",3)(1,"div",4)(2,"label",5),e.EFF(3,"orderManagement.order.mobile"),e.k0s(),e.j41(4,"div",6)(5,"input",7,0),e.bIt("keydown.enter",function(){return e.eBV(o),e.Njj(r.checkByMobile())}),e.mxI("ngModelChange",function(d){return e.eBV(o),e.DH7(r.form.agent.mobile,d)||(r.form.agent.mobile=d),e.Njj(d)}),e.k0s(),e.DNE(7,U,3,3,"button",8),e.k0s()(),e.j41(8,"div",4)(9,"label",9),e.EFF(10,"orderManagement.order.orderCode"),e.k0s(),e.j41(11,"div",6)(12,"input",10,1),e.mxI("ngModelChange",function(d){return e.eBV(o),e.DH7(r.form.orderCode,d)||(r.form.orderCode=d),e.Njj(d)}),e.k0s(),e.DNE(14,V,3,3,"button",8),e.k0s()(),e.j41(15,"div",4)(16,"label",11),e.EFF(17,"orderManagement.order.name"),e.k0s(),e.j41(18,"input",12,2),e.mxI("ngModelChange",function(d){return e.eBV(o),e.DH7(r.form.agent.agentName,d)||(r.form.agent.agentName=d),e.Njj(d)}),e.k0s(),e.DNE(20,w,2,0,"div",13),e.k0s(),e.j41(21,"div",4)(22,"label",14),e.EFF(23,"orderManagement.order.cityName"),e.k0s(),e.j41(24,"ng-select",15),e.mxI("ngModelChange",function(d){return e.eBV(o),e.DH7(r.form.agent.cityCode,d)||(r.form.agent.cityCode=d),e.Njj(d)}),e.k0s()(),e.j41(25,"div",4)(26,"label",16),e.EFF(27,"orderManagement.order.districtName"),e.k0s(),e.j41(28,"ng-select",17),e.mxI("ngModelChange",function(d){return e.eBV(o),e.DH7(r.form.districtCode,d)||(r.form.districtCode=d),e.Njj(d)}),e.k0s()(),e.j41(29,"div",4)(30,"label",16),e.EFF(31,"orderManagement.order.channelName"),e.k0s(),e.j41(32,"ng-select",18),e.mxI("ngModelChange",function(d){return e.eBV(o),e.DH7(r.form.channelCode,d)||(r.form.channelCode=d),e.Njj(d)}),e.k0s()(),e.j41(33,"div",4)(34,"label",16),e.EFF(35,"orderManagement.order.isUrgent"),e.k0s(),e.j41(36,"p-inputSwitch",19),e.mxI("ngModelChange",function(d){return e.eBV(o),e.DH7(r.form.isUrgent,d)||(r.form.isUrgent=d),e.Njj(d)}),e.k0s()()()}if(2&i){const o=e.sdS(19);e.R7$(5),e.Y8G("disabled",r.isInner),e.R50("ngModel",r.form.agent.mobile),e.R7$(2),e.Y8G("ngIf",!r.isInner),e.R7$(5),e.Y8G("disabled",r.isInner),e.R50("ngModel",r.form.orderCode),e.R7$(2),e.Y8G("ngIf",!r.isInner),e.R7$(4),e.Y8G("disabled",!r.isOrderEdit),e.R50("ngModel",r.form.agent.agentName),e.R7$(2),e.Y8G("ngIf",o.invalid&&o.touched),e.R7$(4),e.Y8G("disabled",!r.isOrderEdit)("items",r.cities)("multiple",!1),e.R50("ngModel",r.form.agent.cityCode),e.R7$(4),e.Y8G("disabled",!r.isOrderEdit)("items",r.districts)("multiple",!1),e.R50("ngModel",r.form.districtCode),e.R7$(4),e.Y8G("disabled",!r.isOrderEdit)("filter",!0)("items",r.channels)("multiple",!1),e.R50("ngModel",r.form.channelCode),e.R7$(4),e.R50("ngModel",r.form.isUrgent)}},dependencies:[_.bT,b.me,b.BC,b.YS,b.xh,b.tU,b.vS,C.Mm,R.m,L.vr,$.HW,C.D9],encapsulation:2})}}return s})();var j=c(37021),k=c(35335),E=c(45236),I=c(70980),D=c(99437),N=c(18810),Y=c(25947),W=c(67569),h=c(45312),y=c(21626);let a=(()=>{class s extends W.d{constructor(t){super(t,h.c.apiUrl+"WhatsAppMessages/")}SendCallCounterMessage(t){return this.http.post(this.baseUrl+"SendCallCounterMessage/"+t,{})}SendNewOrderMessage(t){return this.http.post(this.baseUrl+"SendNewOrderMessage/"+t,{})}SendInvoiceMessage(t){return this.http.post(this.baseUrl+"SendInvoiceMessage/"+t,{})}static{this.\u0275fac=function(i){return new(i||s)(e.KVO(y.Qq))}}static{this.\u0275prov=e.jDH({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})();var g=c(12260),m=c(15084);function S(s,u){if(1&s){const t=e.RV6();e.qex(0),e.j41(1,"div",15)(2,"div",16)(3,"input",17),e.bIt("change",function(){const r=e.eBV(t).$implicit,o=e.XpG();return e.Njj(o.locationChange(r))}),e.k0s(),e.j41(4,"label",18)(5,"span",19),e.EFF(6),e.k0s(),e.j41(7,"span",20),e.EFF(8),e.k0s()()(),e.j41(9,"div",21)(10,"div")(11,"a",22),e.bIt("click",function(){const r=e.eBV(t).$implicit,o=e.XpG(),p=e.sdS(9);return e.Njj(o.openEditModal(r,p))}),e.nrm(12,"i",23)(13,"span",24),e.k0s()(),e.j41(14,"div")(15,"a",25),e.bIt("click",function(){const r=e.eBV(t).$implicit,o=e.XpG(),p=e.sdS(11);return e.Njj(o.confirm(r.id,p))}),e.nrm(16,"i",26)(17,"span",27),e.k0s()()()(),e.bVm()}if(2&s){const t=u.$implicit;e.R7$(3),e.Mz_("id","S",t.id,""),e.Y8G("checked",t.isSelected),e.R7$(),e.Mz_("for","S",t.id,""),e.R7$(2),e.SpI(" ",t.name,""),e.R7$(2),e.SpI(" ",t.address,"")}}function F(s,u){1&s&&(e.j41(0,"span",54),e.EFF(1,"general.action.register "),e.k0s())}function K(s,u){1&s&&(e.j41(0,"span",54),e.EFF(1,"general.action.edit "),e.k0s())}function Z(s,u){1&s&&(e.j41(0,"div",55),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function z(s,u){1&s&&(e.j41(0,"div",55),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function J(s,u){if(1&s){const t=e.RV6();e.j41(0,"div",28)(1,"div",29)(2,"h4",30),e.DNE(3,F,2,0,"span",31)(4,K,2,0,"span",31),e.k0s(),e.j41(5,"button",32),e.bIt("click",function(){const r=e.eBV(t).$implicit;return e.Njj(r.dismiss("Cross click"))}),e.k0s()(),e.j41(6,"div",33),e.nrm(7,"ngx-ui-loader",34),e.j41(8,"form",35,2),e.bIt("submit",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.OnSubmit())}),e.j41(10,"div",36),e.nrm(11,"label",37)(12,"ng-select",38),e.nI1(13,"translate"),e.k0s(),e.j41(14,"div",36),e.nrm(15,"label",39),e.j41(16,"input",40,3),e.mxI("ngModelChange",function(r){e.eBV(t);const o=e.XpG();return e.DH7(o.formEdit.name,r)||(o.formEdit.name=r),e.Njj(r)}),e.k0s(),e.DNE(18,Z,2,0,"div",41),e.k0s(),e.j41(19,"div",36),e.nrm(20,"label",42),e.j41(21,"textarea",43,4),e.mxI("ngModelChange",function(r){e.eBV(t);const o=e.XpG();return e.DH7(o.formEdit.address,r)||(o.formEdit.address=r),e.Njj(r)}),e.k0s(),e.DNE(23,z,2,0,"div",41),e.k0s(),e.j41(24,"div",36),e.nrm(25,"label",44),e.j41(26,"input",45,5),e.mxI("ngModelChange",function(r){e.eBV(t);const o=e.XpG();return e.DH7(o.formEdit.lat,r)||(o.formEdit.lat=r),e.Njj(r)}),e.k0s()(),e.j41(28,"div",36),e.nrm(29,"label",46),e.j41(30,"input",47,6),e.mxI("ngModelChange",function(r){e.eBV(t);const o=e.XpG();return e.DH7(o.formEdit.lng,r)||(o.formEdit.lng=r),e.Njj(r)}),e.k0s()(),e.j41(32,"div",48)(33,"button",49),e.nrm(34,"i",50)(35,"span",51),e.k0s(),e.j41(36,"button",52),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.OnSubmit(!0))}),e.nrm(37,"i",50)(38,"span",53),e.k0s()()()()()}if(2&s){const t=e.sdS(9),i=e.sdS(17),r=e.sdS(22),o=e.XpG();e.R7$(3),e.Y8G("ngIf",!o.isEditForm),e.R7$(),e.Y8G("ngIf",o.isEditForm),e.R7$(3),e.Y8G("hasProgressBar",!1)("fgsType",o.loaderOperationShap)("loaderId","locationOperation"),e.R7$(5),e.FS9("placeholder",e.bMT(13,16,"orderManagement.order.cityName")),e.Y8G("items",o.cities)("multiple",!1),e.R7$(4),e.R50("ngModel",o.formEdit.name),e.R7$(2),e.Y8G("ngIf",i.invalid&&i.touched),e.R7$(3),e.R50("ngModel",o.formEdit.address),e.R7$(2),e.Y8G("ngIf",r.invalid&&r.touched),e.R7$(3),e.R50("ngModel",o.formEdit.lat),e.R7$(4),e.R50("ngModel",o.formEdit.lng),e.R7$(3),e.Y8G("disabled",!t.valid),e.R7$(3),e.Y8G("disabled",!t.valid)}}function q(s,u){if(1&s){const t=e.RV6();e.j41(0,"delete-modal",56),e.bIt("deleteConfirm",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.DeleteConfirm())})("dismiss",function(){const r=e.eBV(t).$implicit;return e.Njj(r.dismiss())}),e.k0s()}}let te=(()=>{class s{constructor(t,i,r,o,p,d,Q){this.modalService=t,this.baseService=i,this.alertService=r,this.ngxLoader=o,this.whatsupService=p,this.whatsAppMessagesService=d,this.cityService=Q,this.submitted=!1,this.form={},this.mainDelay=20,this.notifier=new n.B,this.operationLoader=f.ZW,this.isEditForm=!1,this.loaderOperationShap=f.$$,this.isLoad=!1,this.formEdit={},this.cities=[],this.idSelected=0,this.isOrderEdit=!0,this.modalRefs={}}ngOnInit(){this.checkLocation(),this.GetCities()}confirm(t,i){this.idSelected=t,this.modalService.open(i,{centered:!0})}openModal(t){this.ngxLoader.stopLoader(this.operationLoader),this.submitted=!1,this.modalRefs=this.modalService.open(t,{size:"md",centered:!0})}openEditModal(t,i){this.submitted=!1,this.formEdit=t,this.isEditForm=!0,this.modalRefs=this.modalService.open(i,{size:"md",centered:!0})}changeActiveTab(t){this.nav.select(t)}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}registerEntity(t=!1){this.ngxLoader.startLoader("locationOperation");let i=this.mapRegisterForm(this.formEdit);i.isSend=t,this.baseService.AddLocation(i).pipe((0,j.O)(),(0,k.c)(this.mainDelay),(0,E.Z)(),(0,v.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader("locationOperation")),(0,D.W)(r=>(0,N.$)(r))).subscribe(r=>{r.success?(this.alertService.success(),this.modalRefs.dismiss(),this.refresh()):this.alertService.error("general.message."+r.message)},r=>{this.alertService.error("general.message."+r)})}editEntity(t=!1){this.ngxLoader.startLoader("locationOperation");let i=this.mapForm(this.formEdit);i.isSend=t,this.baseService.EditLocation(i).pipe((0,j.O)(),(0,k.c)(this.mainDelay),(0,E.Z)(),(0,v.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader("locationOperation"))).subscribe(r=>{r.success?(this.alertService.success(),this.modalRefs.dismiss(),this.refresh()):this.alertService.error("general.message."+r.message)},r=>{this.alertService.error("general.message."+r)})}mapForm(t){return t.agentCode=this.form.agent.agentCode,t.cityCode=this.form.agent.cityCode,t.agentName=this.form.agent.agentName,t.mobile=this.form.agent.mobile,t.orderCode=this.form.orderCode,t}mapRegisterForm(t){return t.id=0,t.agentCode=this.form.agent.agentCode,t.cityCode=this.form.agent.cityCode,t.agentName=this.form.agent.agentName,t.mobile=this.form.agent.mobile,t.orderCode=this.form.orderCode,t}submitFunished(){this.alertService.success(),this.modalService?.dismissAll()}OnSubmit(t=!1){this.ngxLoader.startLoader(this.operationLoader),!0===this.isEditForm?this.editEntity(t):this.registerEntity(t)}getFromClient(){this.form.agent.mobile||this.alertService.error("orderManagement.order.mustEnterNumber"),this.isLoad=!0,this.whatsupService.GetLocationFromClient(this.form.agent.mobile).pipe((0,v.Q)(this.notifier),(0,I.j)(()=>this.isLoad=!1)).subscribe(t=>{t.success?this.alertService.success("orderManagement.order.successSendLocation"):this.alertService.error("orderManagement.order.failSendLocation")},()=>{this.alertService.error("orderManagement.order.failSendLocation")})}DeleteConfirm(){this.baseService.DeleteLocation(this.idSelected).pipe((0,j.O)(),(0,k.c)(this.mainDelay),(0,E.Z)(),(0,v.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader("deleteLoader"))).subscribe(t=>{if(t.success){const i=this.form.locations.findIndex(r=>r.id===this.idSelected);-1!==i&&this.form.locations.splice(i,1),this.alertService.success(),this.modalService.dismissAll()}else this.alertService.error("general.message."+t)},()=>{this.alertService.error()})}refresh(){this.baseService.clientNumber.next(!0)}locationChange(t){this.form.orderLocations=[{lat:t.lat,lng:t.lng,agentLocationId:t.id,orderLocationCode:0,orderCode:0}];let i=this.form.locations.find(r=>r.id==t.id);i.isSelected=!i.isSelected}checkLocation(){}ngOnDestroy(){this.notifier.next(),this.notifier.complete()}static{this.\u0275fac=function(i){return new(i||s)(e.rXU(M.Bq),e.rXU(G.X),e.rXU(O.u),e.rXU(l.eD),e.rXU(Y.A),e.rXU(a),e.rXU(g.h))}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["client-location"]],viewQuery:function(i,r){if(1&i&&e.GBs(M.X9,5),2&i){let o;e.mGM(o=e.lsd())&&(r.nav=o.first)}},inputs:{form:"form",isOrderEdit:"isOrderEdit"},features:[e.Jv_([M.X9])],decls:12,vars:2,consts:[["content",""],["deleteModal",""],["formEntity","ngForm"],["name","ngModel"],["address","ngModel"],["lat","ngModel"],["lng","ngModel"],[1,"mt-4"],[1,"d-flex","align-items-center","mb-2"],[1,"flex-grow-1"],["translate","orderManagement.order.savedAddress",1,"fs-15","mb-0"],[1,"flex-shrink-0"],["type","button","translate","orderManagement.order.sendToClient",1,"btn","btn-sm","btn-success","mb-3",3,"click","disabled"],[1,"row","gy-3"],[4,"ngFor","ngForOf"],[1,"col-lg-4","col-sm-6"],[1,"form-check","card-radio"],["name","location","type","radio",1,"form-check-input",3,"change","id","checked"],[1,"form-check-label",3,"for"],[1,"mb-4","fw-bold","d-block","text-muted","text-uppercase"],[1,"text-muted","fw-normal","text-wrap","mb-1","d-block"],[1,"d-flex","flex-wrap","p-2","py-1","bg-light","rounded-bottom","border","mt-n1"],["href","javascript:void(0);","data-bs-toggle","modal","data-bs-target","#addAddressModal",1,"d-block","text-body","p-1","px-2",3,"click"],[1,"ri-pencil-fill","text-muted","align-bottom","me-1"],["translate","general.action.edit"],["href","javascript:void(0);","data-bs-toggle","modal","data-bs-target","#removeItemModal",1,"d-block","text-body","p-1","px-2",3,"click"],[1,"ri-delete-bin-fill","text-muted","align-bottom","me-1"],["translate","general.action.delete"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["class","fw-bold fs-4","translate","",4,"ngIf"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"submit"],[1,"mb-3"],["for","name","translate","orderManagement.order.cityName",1,"required","fw-bold","form-label"],["bindValue","code","bindLabel","name",3,"placeholder","items","multiple"],["for","name","translate","orderManagement.order.name",1,"required","fw-bold","form-label"],["InputTirmFilter","","name","name","type","text","id","name","required","",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["for","address","translate","orderManagement.order.address",1,"fw-bold","form-label"],["rows","2","InputTirmFilter","","name","address","type","text","id","address",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["for","lat","translate","orderManagement.order.lat",1,"fw-bold","form-label"],["disabled","","InputTirmFilter","","name","lat","type","text","id","lat",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["for","lng","translate","orderManagement.order.lng",1,"fw-bold","form-label"],["disabled","","InputTirmFilter","","name","lng","type","text","id","lng",1,"form-control","fs-6",3,"ngModelChange","ngModel"],[1,"text-center"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["type","button","type","submit",1,"mx-1","btn","btn-success","btn-label","waves-effect","waves-light","rounded-pill",3,"click","disabled"],["translate","general.action.saveAndSend"],["translate","",1,"fw-bold","fs-4"],["translate","",1,"text-danger","text-center"],[3,"deleteConfirm","dismiss"]],template:function(i,r){if(1&i){const o=e.RV6();e.j41(0,"div",7)(1,"div",8)(2,"div",9),e.nrm(3,"h5",10),e.k0s(),e.j41(4,"div",11)(5,"button",12),e.bIt("click",function(){e.eBV(o);const d=e.sdS(9);return e.Njj(r.openModal(d))}),e.k0s()()(),e.j41(6,"div",13),e.DNE(7,S,18,7,"ng-container",14),e.k0s()(),e.DNE(8,J,39,18,"ng-template",null,0,e.C5r)(10,q,1,0,"ng-template",null,1,e.C5r)}2&i&&(e.R7$(5),e.Y8G("disabled",r.isLoad),e.R7$(2),e.Y8G("ngForOf",r.form.locations))},dependencies:[_.Sq,_.bT,b.qT,b.me,b.BC,b.cb,b.YS,b.vS,b.cV,C.Mm,R.m,L.vr,l.Cv,m.w,C.D9],encapsulation:2})}}return s})();var A=c(51188);let re=(()=>{class s{constructor(t,i,r,o,p,d,Q,Ne){this.routerActive=t,this.translateService=i,this.baseService=r,this.alertService=o,this.datePipe=p,this.modalService=d,this.ngxLoader=Q,this.router=Ne,this.editOrders="orderManagement.order.editOrders",this.addOrders="orderManagement.order.addOrders",this.titleOperation="orderManagement.order.titleOperation",this.form={},this.keySelected="",this.assignUsers=[],this.times=[],this.active=0,this.shifts=[],this.searchForm="",this.jobTypes=[],this.weekDays=[],this.breadCrumbItems=[],this.todayDate="",this.idForm=0,this.totalPaid=0,this.priceModel=0,this.priceModelIndex=0,this.subtotal=0,this.total=0,this.isResolveList=!0,this.extraDiscountCalc=!1,this.employeeGroups=[],this.notifier=new n.B,this.mainDelay=100,this.loaderSearchShap=f.cX,this.loaderOperationShap=f.$$,this.operationLoader=f.ZW,this.isEditForm=!1,this.showEdit=!1,this.channels=[],this.districts=[],this.cities=[],this.orderTypes=[],this.serviceCategories=[],this.services=[],this.paymentTypes=[],this.fileName="",this.base64String=null,this.orderCode=[],this.newOrder=new e.bkB;const H=new Date;this.todayDate=`${H.getFullYear()}-${(H.getMonth()+1).toString().padStart(2,"0")}-${H.getDate().toString().padStart(2,"0")}`,console.log(this.todayDate)}nextDate(){let t=this.todayDate.split("-");this.todayDate=`${t[0]}-${t[1]}-${+t[2]+1}`,console.log(this.todayDate)}OpenChangInput(t,i){this.showEdit=!0,console.log(i),this.priceModel=i.price,this.priceModelIndex=t}ChangInput(){this.form.tbOrderServices[`${this.priceModelIndex}`].price=this.priceModel,this.showEdit=!1}previousDate(){let t=this.todayDate.split("-");this.todayDate=`${t[0]}-${t[1]}-${+t[2]-1}`,console.log(this.todayDate)}ngOnDestroy(){this.notifier.next(),this.notifier.complete()}ngOnInit(){this.configRoute(),this.breadCrumbItems=[{label:"layout.sidebar.orders"},{label:"orderManagement.order.title",active:!0,url:"order/list"},{label:this.isEditForm?"general.action.edit":"general.action.register",active:!0}],this.GetOrderLookUp()}onFileSelected(t){const i=t.target;if(i.files&&i.files.length>0){const r=i.files[0];this.fileName=r.name,console.log(r);const o=new FileReader;o.onload=()=>{this.base64String=o.result,console.log("Base64 String:",this.base64String)},o.onerror=p=>{console.error("Error reading file:",p)},o.readAsDataURL(r)}}addService(){let t=this.form.formServices,i=this.services.filter(o=>o.serviceCode==t.serviceCode)[0];this.form.tbOrderServices.push({service:i.name,serviceCode:i.code,price:t.price,notes:t.notes});let r=0;this.form.tbOrderServices.forEach(o=>{r+=+o.price}),this.subtotal=r,console.log(this.subtotal),this.checkTotal(),this.resetServiceForm()}addPayment(){let t=this.form.formPayment,i=this.paymentTypes.filter(o=>o.id==t.paymentTypeCode)[0];this.form.orderPayments.push({paymentType:i.name,paymentTypeCode:t.paymentTypeCode,value:t.value,fileName:this.fileName});let r=0;this.form.orderPayments.forEach(o=>{r+=+o.value}),this.totalPaid=r,this.resetPaymentForm()}checkTotal(){this.total=this.subtotal-+this.form.DiscountAmount}deleteService(t){this.form.tbOrderServices.splice(t,1)}deletePayment(t){this.form.orderPayments.splice(t,1)}resetServiceForm(){let t=this.form.formServices;t.serviceCode=void 0,t.price=null,t.notes=null}resetPaymentForm(){let t=this.form.formPayment;t.paymentTypeCode=null,t.value=null,t.attachRecietPath=null,t.fileName=null}configRoute(){this.routerActive.data.pipe((0,v.Q)(this.notifier)).subscribe(t=>{let i=t.data.data;i&&(this.isEditForm=!0,this.form=i,"Proposed"==i.leadsTypes?this.form.leadsTypes=1:"Inquiry"==i.leadsTypes&&(this.form.leadsTypes=2))},()=>{this.alertService.error()})}GetOrderLookUp(){this.baseService.GetOrderLookUp().subscribe(t=>{this.channels=t.data.channels,this.cities=t.data.cityNames,this.orderTypes=t.data.orderStatus,this.serviceCategories=t.data.serviceCategories,this.paymentTypes=t.data.paymentTypes},t=>{console.log(t)})}getDistricts(t){this.ngxLoader.startLoader(f.ZW),this.baseService.districtsByCity(t).subscribe(i=>{this.districts=i.data,this.ngxLoader.stopLoader(f.ZW)},i=>{console.log(i)})}getServicesByCategory(t){console.log(t),this.ngxLoader.startLoader(f.ZW),this.baseService.getServicesByCategory(t).subscribe(i=>{this.ngxLoader.stopLoader(f.ZW),this.services=i.data},i=>{console.log(i)})}OnSubmit(){this.ngxLoader.startLoader(this.operationLoader),!0===this.isEditForm?this.editEntity():this.registerEntity()}mapRegisterForm(t){let i={...t};return i.id=0,i}registerEntity(){this.ngxLoader.startLoader(f.ZW);let t=this.mapRegisterForm(this.form);this.baseService.registerNewOrder(t).pipe((0,j.O)(),(0,k.c)(this.mainDelay),(0,E.Z)(),(0,v.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader(f.ZW)),(0,D.W)(i=>(0,N.$)(i))).subscribe(i=>{i.success?(this.alertService.success(),this.router.navigateByUrl("/order/list")):this.alertService.error("general.message."+i.message)},i=>{this.alertService.error("general.message."+i)})}editEntity(){this.baseService.editPut(this.form.id,this.form).pipe((0,j.O)(),(0,k.c)(this.mainDelay),(0,E.Z)(),(0,v.Q)(this.notifier),(0,I.j)(()=>this.ngxLoader.stopLoader(f.ZW))).subscribe(t=>{t.success?this.alertService.success():this.alertService.error("general.message."+t.message)},t=>{this.alertService.error("general.message."+t)})}getTranslationText(t){let i="";return this.translateService.get(t).pipe((0,v.Q)(this.notifier)).subscribe(r=>{i=r}),i}onTimeSelected(t){this.form.orderTeams=t}newOrderAgain(){this.newOrder.next(!0)}static{this.\u0275fac=function(i){return new(i||s)(e.rXU(A.nX),e.rXU(C.c$),e.rXU(T.Q),e.rXU(O.u),e.rXU(_.vh),e.rXU(M.Bq),e.rXU(l.eD),e.rXU(A.Ix))}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["app-finish-order"]],inputs:{form:"form",orderCode:"orderCode"},outputs:{newOrder:"newOrder"},decls:12,vars:1,consts:[[1,"text-center","py-5"],[1,"mb-4"],["src","https://cdn.lordicon.com/lupuorrc.json","trigger","loop","colors","primary:#0ab39c,secondary:#405189",2,"width","120px","height","120px"],["translate","orderManagement.order.orderSaveSuccess"],[1,"fw-semibold"],["translate","orderManagement.order.orderCode"],["routerLink","/ecommerce/order-details",1,"text-decoration-underline"],[1,"d-flex","align-items-start","gap-3","mt-4"],["type","button","data-nexttab","pills-finish-tab",1,"btn","btn-primary","btn-label","right","ms-auto","nexttab",3,"click"],[1,"ri-chat-new-line","label-icon","align-middle","fs-16","ms-2"],["translate","orderManagement.order.newOrderAgain"]],template:function(i,r){1&i&&(e.j41(0,"div",0)(1,"div",1),e.nrm(2,"lord-icon",2),e.k0s(),e.nrm(3,"h5",3),e.j41(4,"h3",4),e.nrm(5,"span",5),e.j41(6,"a",6),e.EFF(7),e.k0s()()(),e.j41(8,"div",7)(9,"button",8),e.bIt("click",function(){return r.newOrderAgain()}),e.nrm(10,"i",9)(11,"span",10),e.k0s()()),2&i&&(e.R7$(7),e.SpI("#SO#",r.orderCode,""))},dependencies:[C.Mm],encapsulation:2})}}return s})();var ie=c(99902);function ne(s,u){if(1&s){const t=e.RV6();e.j41(0,"button",24),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.addPayment())}),e.nrm(1,"i",25),e.k0s()}}function se(s,u){if(1&s){const t=e.RV6();e.j41(0,"button",26),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.editPaymentNew())}),e.nrm(1,"i",27),e.k0s()}}function oe(s,u){if(1&s&&e.nrm(0,"img",34),2&s){const t=e.XpG().$implicit,i=e.XpG();e.Y8G("src",i.serverUrl+t.url,e.B4B)("alt",t.name)}}function ae(s,u){if(1&s){const t=e.RV6();e.j41(0,"tr",28)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.DNE(8,oe,1,2,"img",29),e.k0s(),e.j41(9,"td")(10,"button",30),e.bIt("click",function(){const r=e.eBV(t).$implicit,o=e.XpG();return e.Njj(o.editPayment(r))}),e.nrm(11,"i",31),e.k0s(),e.j41(12,"button",32),e.bIt("click",function(){const r=e.eBV(t).index,o=e.XpG();return e.Njj(o.deletePayment(r))}),e.nrm(13,"i",33),e.k0s()()()}if(2&s){const t=u.$implicit,i=u.index;e.R7$(2),e.JRh(i+1),e.R7$(2),e.JRh(t.paymentType),e.R7$(2),e.JRh(t.value),e.R7$(2),e.Y8G("ngIf",t.url)}}function le(s,u){1&s&&(e.j41(0,"tr")(1,"td",35),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&s&&(e.R7$(2),e.JRh(e.bMT(3,1,"orderManagement.order.noData")))}function de(s,u){if(1&s){const t=e.RV6();e.j41(0,"button",36),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.orderFinished())}),e.nrm(1,"i",37)(2,"span",38),e.k0s()}}function ce(s,u){if(1&s){const t=e.RV6();e.j41(0,"button",40),e.bIt("click",function(){e.eBV(t);const r=e.XpG(2);return e.Njj(r.orderEdit())}),e.nrm(1,"i",41)(2,"span",42),e.k0s()}}function me(s,u){if(1&s&&(e.qex(0),e.DNE(1,ce,3,0,"button",39),e.bVm()),2&s){const t=e.XpG();e.R7$(),e.Y8G("ngIf",t.form.orderCode>0)}}let he=(()=>{class s{constructor(t,i,r,o,p,d){this.routerActive=t,this.translateService=i,this.baseService=r,this.alertService=o,this.formDataService=p,this.ngxLoader=d,this.editOrders="orderManagement.order.editOrders",this.addOrders="orderManagement.order.addOrders",this.titleOperation="orderManagement.order.titleOperation",this.form={},this.keySelected="",this.assignUsers=[],this.times=[],this.active=0,this.shifts=[],this.searchForm="",this.jobTypes=[],this.weekDays=[],this.breadCrumbItems=[],this.todayDate="",this.idForm=0,this.totalPaid=0,this.priceModel=0,this.priceModelIndex=0,this.subtotal=0,this.total=0,this.isResolveList=!0,this.extraDiscountCalc=!1,this.employeeGroups=[],this.notifier=new n.B,this.mainDelay=100,this.loaderSearchShap=f.cX,this.loaderOperationShap=f.$$,this.operationLoader=f.ZW,this.isEditForm=!1,this.showEdit=!1,this.channels=[],this.districts=[],this.cities=[],this.orderTypes=[],this.paymentTypes=[],this.fileName="",this.base64String=null,this.formPayment={},this.isEdit=!1,this.finishedOrder=new e.bkB,this.finishedUpdateOrder=new e.bkB,this.CalcTotal=new e.bkB,this.isOrderEdit=!0,this.serverUrl=h.c.mediaUrl}OpenChangInput(t,i){this.showEdit=!0,this.priceModel=i.price,this.priceModelIndex=t}ChangInput(){this.form.tbOrderServices[`${this.priceModelIndex}`].price=this.priceModel,this.showEdit=!1}ngOnDestroy(){this.notifier.next(),this.notifier.complete()}ngOnInit(){}onFileSelected(t){const i=t.target;if(i.files&&i.files.length>0){const r=i.files[0];this.fileSelected=r,this.fileName=r.name;const o=new FileReader;o.onload=()=>{this.base64String=o.result},o.onerror=p=>{console.error("Error reading file:",p)},o.readAsDataURL(r),i.value=""}}addPayment(){let t=this.formPayment;if(t.value>this.form.total)return void this.alertService.error("orderManagement.order.addCostLargeTotal");let i=this.paymentTypes.filter(p=>p.id==t.paymentTypeCode)[0];this.form.orderPayments.push({orderPaymentCode:this.form.orderPaymentCode||0,orderCode:this.form.orderCode||0,paymentType:i.name,paymentTypeCode:t.paymentTypeCode,value:t.value,fileName:this.fileName,url:this.base64String,index:this.form.orderPayments.length+1,file:this.fileSelected});let o=0;this.form.orderPayments.forEach(p=>{o+=+p.value}),this.totalPaid=o,this.resetPaymentForm(),this.CalcTotal.next(!0),console.log(this.form.orderPayments)}checkTotal(){this.total=this.subtotal-+this.form.DiscountAmount}deleteService(t){this.form.tbOrderServices.splice(t,1)}deletePayment(t){this.form.orderPayments.splice(t,1),this.CalcTotal.next(!0)}resetServiceForm(){let t=this.form.formServices;t.serviceCode=void 0,t.price=null,t.notes=null}resetPaymentForm(){this.formPayment={},this.base64String="",this.fileName=""}configRoute(){this.routerActive.data.pipe((0,v.Q)(this.notifier)).subscribe(t=>{let i=t.data.data;i&&(this.isEditForm=!0,this.form=i,"Proposed"==i.leadsTypes?this.form.leadsTypes=1:"Inquiry"==i.leadsTypes&&(this.form.leadsTypes=2))},()=>{this.alertService.error()})}getTranslationText(t){let i="";return this.translateService.get(t).pipe((0,v.Q)(this.notifier)).subscribe(r=>{i=r}),i}editPayment(t){this.isEdit=!0,this.formPayment={},this.formPayment={...t}}editPaymentNew(){let t=this.formPayment;if(0==t.orderPaymentCode){let i=this.paymentTypes.filter(o=>o.id==t.paymentTypeCode)[0],r=this.form.orderPayments.find(o=>o.index==t.index);r.paymentType=i.name,r.value=t.value,r.fileName=""==this.fileName?r.fileName:this.fileName,r.url=""==this.base64String?r.base64String:this.base64String}this.isEdit=!1,this.formPayment={},this.CalcTotal.next(!0)}onTimeSelected(t){this.form.orderTeams=t,console.log(t)}orderFinished(){let t=this.mapForm();this.ngxLoader.startLoader("order"),this.baseService.registerNewOrder(t).subscribe(i=>{i.success?(this.ngxLoader.stopLoader("order"),this.finishedOrder.next(i.data.orderCode),this.alertService.success()):(this.alertService.error(),this.ngxLoader.stopLoader("order"))},()=>{this.alertService.error(),this.ngxLoader.stopLoader("order")})}mapForm(){let t=this.form;delete t.locations,delete t.formServices,delete t.formPayment,delete t.serviceCategoryCode,delete t.total,t.agentCode=t.agent.agentCode;let i=[...this.form.orderPayments];return this.form.orderPayments=[],i.forEach(r=>{this.form.orderPayments.push({orderPaymentCode:r.orderPaymentCode,paymentType:r.paymentType,orderCode:r.orderCode,paymentTypeCode:r.paymentTypeCode,value:r.value,file:r.file})}),console.log(t),this.formDataService.formatFormData(t)}orderEdit(){let t=this.mapForm();this.ngxLoader.startLoader("order"),this.baseService.EditOrder(t).subscribe(i=>{i.success?(this.finishedUpdateOrder.next(i.data.orderCode),this.alertService.success(),this.ngxLoader.stopLoader("order")):(this.alertService.error(),this.ngxLoader.stopLoader("order"))},()=>{this.alertService.error(),this.ngxLoader.stopLoader("order")})}static{this.\u0275fac=function(i){return new(i||s)(e.rXU(A.nX),e.rXU(C.c$),e.rXU(T.Q),e.rXU(O.u),e.rXU(ie.Q),e.rXU(l.eD))}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["app-order-payment"]],inputs:{form:"form",paymentTypes:"paymentTypes",isOrderEdit:"isOrderEdit"},outputs:{finishedOrder:"finishedOrder",finishedUpdateOrder:"finishedUpdateOrder",CalcTotal:"CalcTotal"},decls:37,vars:10,consts:[["value","ngModel"],["fileInput",""],[1,"row","mt-3"],[1,"col-6","col-md-4","mb-2"],["translate","",1,"required","fw-bold","form-label","w-100"],["name","paymentTypeCode","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","ngModel"],["for","value","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","name","value","type","number","id","value",1,"form-control","fs-6",3,"ngModelChange","ngModel"],[1,"col-6","col-md-3","mb-2"],["type","file","placeholder","dfd",1,"form-control","fs-6",3,"change"],[1,"col-6","col-md-1","mb-2","d-flex","justify-content-center","align-items-end"],["type","button","class","btn btn-success btn-icon waves-effect waves-light",3,"click",4,"ngIf"],["type","button","class","btn btn-info btn-icon waves-effect waves-light",3,"click",4,"ngIf"],[1,"col-12","mt-3"],[1,"table-responsive"],[1,"table","table-border"],[1,""],["translate","",2,"width",".5%"],["translate","",2,"width","10%"],["translate","",2,"width","8%"],["class","fs-5",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"d-flex","align-items-start","gap-3","mt-4"],["type","button","class","btn btn-primary   right ms-auto nexttab","data-nexttab","pills-finish-tab",3,"click",4,"ngIf"],["type","button",1,"btn","btn-success","btn-icon","waves-effect","waves-light",3,"click"],[1,"ri-add-fill"],["type","button",1,"btn","btn-info","btn-icon","waves-effect","waves-light",3,"click"],[1,"ri-edit-2-line"],[1,"fs-5"],["class","img-thumbnail","width","50","height","50",3,"src","alt",4,"ngIf"],[1,"btn","btn-sm","btn-soft-info","edit-list","mx-2",3,"click"],[1,"ri-pencil-fill","align-bottom","mx-1"],[1,"btn","btn-sm","btn-soft-danger","remove-list",3,"click"],[1,"ri-delete-bin-5-fill","align-bottom"],["width","50","height","50",1,"img-thumbnail",3,"src","alt"],["colspan","5",1,"text-center","text-danger","my-5"],["type","button","data-nexttab","pills-finish-tab",1,"btn","btn-primary","right","ms-auto","nexttab",3,"click"],[1,"ri-checkbox-circle-fill","label-icon","align-middle","fs-16","ms-2"],["translate","orderManagement.order.orderComplete"],["type","button","class","btn btn-info   right ms-auto nexttab","data-nexttab","pills-finish-tab",3,"click",4,"ngIf"],["type","button","data-nexttab","pills-finish-tab",1,"btn","btn-info","right","ms-auto","nexttab",3,"click"],[1,"ri-edit-2-fill","label-icon","align-middle","fs-16","ms-2"],["translate","orderManagement.order.orderEdit"]],template:function(i,r){if(1&i){const o=e.RV6();e.j41(0,"div",2)(1,"div",3)(2,"label",4),e.EFF(3," orderManagement.order.paymentMethods"),e.k0s(),e.j41(4,"ng-select",5),e.mxI("ngModelChange",function(d){return e.eBV(o),e.DH7(r.formPayment.paymentTypeCode,d)||(r.formPayment.paymentTypeCode=d),e.Njj(d)}),e.k0s()(),e.j41(5,"div",3)(6,"label",6),e.EFF(7,"orderManagement.order.paid"),e.k0s(),e.j41(8,"input",7,0),e.mxI("ngModelChange",function(d){return e.eBV(o),e.DH7(r.formPayment.value,d)||(r.formPayment.value=d),e.Njj(d)}),e.k0s()(),e.j41(10,"div",8)(11,"label",6),e.EFF(12,"orderManagement.order.paid"),e.k0s(),e.j41(13,"input",9,1),e.bIt("change",function(d){return e.eBV(o),e.Njj(r.onFileSelected(d))}),e.k0s()(),e.j41(15,"div",10),e.DNE(16,ne,2,0,"button",11)(17,se,2,0,"button",12),e.k0s(),e.j41(18,"div",13)(19,"div",14)(20,"table",15)(21,"tr",16)(22,"th",17),e.EFF(23,"#"),e.k0s(),e.j41(24,"th",18),e.EFF(25," orderManagement.order.paymentMethods "),e.k0s(),e.j41(26,"th",18),e.EFF(27," orderManagement.order.paid "),e.k0s(),e.j41(28,"th",18),e.EFF(29," orderManagement.order.attchment "),e.k0s(),e.j41(30,"th",19),e.EFF(31," orderManagement.order.actions "),e.k0s()(),e.DNE(32,ae,14,4,"tr",20)(33,le,4,3,"tr",21),e.k0s()()()(),e.j41(34,"div",22),e.DNE(35,de,3,0,"button",23)(36,me,2,1,"ng-container",21),e.k0s()}2&i&&(e.R7$(4),e.Y8G("items",r.paymentTypes)("multiple",!1),e.R50("ngModel",r.formPayment.paymentTypeCode),e.R7$(4),e.R50("ngModel",r.formPayment.value),e.R7$(8),e.Y8G("ngIf",!r.isEdit),e.R7$(),e.Y8G("ngIf",r.isEdit),e.R7$(15),e.Y8G("ngForOf",r.form.orderPayments),e.R7$(),e.Y8G("ngIf",r.form.orderPayments.length<=0),e.R7$(2),e.Y8G("ngIf",r.form.orderCode<=0),e.R7$(),e.Y8G("ngIf",r.isOrderEdit))},dependencies:[_.Sq,_.bT,b.me,b.Q0,b.BC,b.vS,C.Mm,R.m,L.vr,C.D9],encapsulation:2})}}return s})();var pe=c(16743),ge=c(5779);const ue=s=>({"active-category":s}),fe=s=>({" border-service ":s});function _e(s,u){if(1&s){const t=e.RV6();e.j41(0,"div",16)(1,"div",17),e.bIt("click",function(){const r=e.eBV(t).$implicit,o=e.XpG();return e.Njj(o.chooseCategory(r))}),e.j41(2,"div",18),e.nrm(3,"img",19),e.j41(4,"span",20),e.EFF(5),e.k0s()()()()}if(2&s){const t=u.$implicit,i=e.XpG();e.R7$(),e.Mz_("id","category",t.id,""),e.Y8G("ngClass",e.eq3(6,ue,t.isSelected)),e.R7$(2),e.Y8G("width",100)("src",i.serverImage+t.imageUrl,e.B4B),e.R7$(2),e.JRh(t.name)}}function be(s,u){if(1&s&&(e.j41(0,"span",21),e.EFF(1),e.k0s()),2&s){const t=e.XpG();e.R7$(),e.JRh(t.seviceCount)}}function ve(s,u){1&s&&(e.j41(0,"div",22),e.nrm(1,"button",23),e.k0s())}function Ce(s,u){if(1&s){const t=e.RV6();e.qex(0),e.j41(1,"div",24)(2,"div",25)(3,"input",26),e.bIt("change",function(r){const o=e.eBV(t).$implicit,p=e.XpG();return e.Njj(p.onServiceChange(o.code,r))}),e.k0s(),e.j41(4,"label",27)(5,"div",28)(6,"div",29),e.qSk(),e.j41(7,"svg",30)(8,"style"),e.EFF(9," .s0 { opacity: .06; fill: var(--vz-primary) } "),e.k0s(),e.nrm(10,"path",31),e.k0s()(),e.joV(),e.j41(11,"div",32),e.nrm(12,"img",33),e.k0s(),e.j41(13,"div",34)(14,"h5",35),e.EFF(15),e.k0s()(),e.j41(16,"h6",36),e.EFF(17),e.nI1(18,"translate"),e.k0s(),e.j41(19,"div",37)(20,"button",38),e.bIt("click",function(r){const o=e.eBV(t).$implicit,p=e.XpG();return e.Njj(p.btnMinus(o.code,r))}),e.EFF(21,"\u2013 "),e.k0s(),e.nrm(22,"input",39),e.j41(23,"button",40),e.bIt("click",function(r){const o=e.eBV(t).$implicit,p=e.XpG();return e.Njj(p.btnPlus(o.code,r))}),e.EFF(24,"+ "),e.k0s()()()()()(),e.bVm()}if(2&s){const t=u.$implicit,i=e.XpG();e.R7$(3),e.Mz_("id","S",t.code,""),e.Y8G("value",t.isSelected)("checked",t.isSelected),e.R7$(),e.Mz_("for","S",t.code,""),e.R7$(),e.Y8G("ngClass",e.eq3(20,fe,t.isSelected)),e.R7$(7),e.Y8G("width",150)("src",i.serverImage+t.imageUrl,e.B4B),e.R7$(3),e.JRh(t.name),e.R7$(2),e.Lme("",e.bMT(18,18,"orderManagement.order.currancy")," ",t.price," "),e.R7$(3),e.Y8G("disabled",!t.isSelected),e.R7$(2),e.Mz_("id","cart-",t.code,""),e.FS9("value",t.quantity),e.Y8G("disabled",!t.isSelected),e.R7$(),e.Y8G("disabled",!t.isSelected)}}let ye=(()=>{class s{constructor(t,i,r,o,p){this.routerActive=t,this.translateService=i,this.baseService=r,this.alertService=o,this.ngxLoader=p,this.form={},this.selectedServices=[],this.notifier=new n.B,this.mainDelay=100,this.loaderSearchShap=f.cX,this.loaderOperationShap=f.$$,this.operationLoader=f.ZW,this.isEditForm=!1,this.showEdit=!1,this.serviceCategories=[],this.services=[],this.currentLang=this.translateService.currentLang,this.subtotal=0,this.total=0,this.serverImage=h.c.mediaUrl,this.filteredServices=[],this.seviceCount=0,this.serviceSelected=[],this.CalcTotal=new e.bkB,this.isOrderEdit=!0,this.responsiveOptions=[{breakpoint:"1400px",numVisible:4,numScroll:3},{breakpoint:"1220px",numVisible:4,numScroll:2},{breakpoint:"1100px",numVisible:4,numScroll:1}]}ngOnDestroy(){this.notifier.next(),this.notifier.complete()}ngOnInit(){this.getServicesByCategory(),this.checkCategorySelected()}checkCategorySelected(){this.serviceCategories.forEach(t=>{t.isSelected=this.form.serviceCategoryCode.includes(t.id)})}addService(t){const i=this.form.orderServices.findIndex(r=>r.serviceCode===t.code);i>-1?this.form.orderServices.splice(i,1):this.form.orderServices.push({serviceName:t.name,serviceCode:t.code,quantity:t.quantity,price:t.price*t.quantity,notes:t.notes}),this.checkTotal(),this.resetServiceForm()}updatePrice(t){this.form.orderServices.find(r=>r.serviceCode===t.code).price=t.price*t.quantity}checkTotal(){this.CalcTotal.next(!0)}deleteService(t){this.form.orderServices.splice(t,1)}deletePayment(t){this.form.orderPayments.splice(t,1)}resetServiceForm(){let t=this.form.formServices;t.serviceCode=void 0,t.price=null,t.notes=null}resetPaymentForm(){let t=this.form.formPayment;t.paymentTypeCode=null,t.value=null,t.attachRecietPath=null,t.fileName=null}configRoute(){this.routerActive.data.pipe((0,v.Q)(this.notifier)).subscribe(t=>{let i=t.data.data;i&&(this.isEditForm=!0,this.form=i,"Proposed"==i.leadsTypes?this.form.leadsTypes=1:"Inquiry"==i.leadsTypes&&(this.form.leadsTypes=2))},()=>{this.alertService.error()})}getServicesByCategory(){let t=this.form.serviceCategoryCode;return t.length<=0?(this.services=[],this.filteredServices=[],0):(this.ngxLoader.startLoader("order"),this.baseService.getServicesByCategory(t).subscribe(i=>{this.ngxLoader.stopLoader("order"),this.services=i.data,this.filteredServices=this.services,this.checkSelected()},i=>{this.ngxLoader.stopLoader("order"),console.log(i)}),1)}checkSelected(){this.form.orderServices.forEach(t=>{let i=this.filteredServices.find(r=>r.code===t.serviceCode);i&&(i.isSelected=!0)})}getTranslationText(t){let i="";return this.translateService.get(t).pipe((0,v.Q)(this.notifier)).subscribe(r=>{i=r}),i}onTimeSelected(t){this.form.orderTeams=t,console.log(t)}chooseCategory(t){if(!this.isOrderEdit)return;let i=this.serviceCategories.find(r=>r.id===t.id);if(i.isSelected=!i.isSelected,i.isSelected)this.form.serviceCategoryCode.push(t.id);else{let r=this.serviceCategories.findIndex(o=>o.id===t.id);-1!==r&&this.form.serviceCategoryCode.splice(r,1)}this.getServicesByCategory()}onServiceChange(t,i){if(!this.isOrderEdit)return;i.stopPropagation();const r=this.filteredServices.find(o=>o.code===t);r&&(r.isSelected=!r.isSelected),this.seviceCount=this.filteredServices.filter(o=>o.isSelected).length,this.addService(r)}btnPlus(t,i){i.stopPropagation();const r=this.filteredServices.find(o=>o.code===t);r&&(r.quantity++,this.updatePrice(r),this.checkTotal())}btnMinus(t,i){i.stopPropagation();const r=this.filteredServices.find(o=>o.code===t);r&&r.quantity>1?r.quantity-=1:r.quantity=1,this.updatePrice(r),this.checkTotal()}searchChange(t){const i=t.target.value.toLowerCase();this.filteredServices=""===i?[...this.services]:this.services.filter(r=>r.name.toLowerCase().includes(i))}static{this.\u0275fac=function(i){return new(i||s)(e.rXU(A.nX),e.rXU(C.c$),e.rXU(T.Q),e.rXU(O.u),e.rXU(l.eD))}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["app-order-services"]],inputs:{form:"form",serviceCategories:"serviceCategories",isOrderEdit:"isOrderEdit"},outputs:{CalcTotal:"CalcTotal"},decls:23,vars:18,consts:[[1,"service-container"],[1,"mt-2"],[1,"mb-0"],[3,"circular","value","numVisible","numScroll","rtl","responsiveOptions"],["pTemplate","item"],[1,"row","justify-content-between","align-items-center"],[1,"col-12","col-md-5"],[1,"mb-0","d-inline-block","position-relative"],["class","badge bg-primary mx-1",4,"ngIf"],[1,"col-12","col-md-5","mx-5"],[1,"search-box"],["type","search","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"change","placeholder"],[1,"ri-search-line","search-icon"],["class","d-flex justify-content-center",4,"ngIf"],[1,"mt-3","row","row-cols-3"],[4,"ngFor","ngForOf"],[1,"border-1","surface-border","border-round","m-2","p-3"],[1,"card",2,"max-width","194px!important","border-radius","15px !important","cursor","pointer","box-shadow","0px 0px 15px 0px #00000026 !important",3,"click","ngClass","id"],[1,"card-body","text-center"],["height","50","onerror","this.onerror=null;this.src='assets/images/custom/no-img.jpg';",1,"rounded",3,"width","src"],[1,"d-block","mt-2",2,"font-size",".9rem !important","min-height","55px","font-weight","500 !important","line-height","27.2px !important"],[1,"badge","bg-primary","mx-1"],[1,"d-flex","justify-content-center"],["type","button","translate","orderManagement.order.noCategoryMessage",1,"btn","btn-sm","my-2","btn-danger","fs-4","mb-3"],[1,"col-12","col-md-3","text-center"],[1,"btn-group","w-100"],["type","checkbox",1,"btn-check",3,"change","value","id","checked"],[1,"w-100",3,"for"],[1,"card","card-service","card-body",3,"ngClass"],[1,"position-absolute","start-0",2,"z-index","0"],["version","1.2","xmlns","http://www.w3.org/2000/svg","viewBox","0 0 200 120","width","90","height","120"],["id","Shape 8","d","m189.5-25.8c0 0 20.1 46.2-26.7 71.4 0 0-60 15.4-62.3 65.3-2.2 49.8-50.6 59.3-57.8 61.5-7.2 2.3-60.8 0-60.8 0l-11.9-199.4z",1,"s0"],[1,"w-100"],["height","80","onerror","this.onerror=null;this.src='assets/images/custom/no-img.jpg';",1,"avatar-sm","rounded-circle",3,"width","src"],[1,"ms-2","my-2"],[1,"card-title","mb-1"],[1,"mb-1"],[1,"input-step","my-2"],["type","button",1,"minus",3,"click","disabled"],["type","number","min","0","max","100",1,"product-quantity",3,"disabled","id","value"],["type","button",1,"plus",3,"click","disabled"]],template:function(i,r){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"h4",2),e.EFF(3),e.nI1(4,"translate"),e.k0s(),e.j41(5,"bdi")(6,"p-carousel",3),e.DNE(7,_e,6,8,"ng-template",4),e.k0s()()(),e.j41(8,"div")(9,"div",5)(10,"div",6)(11,"h4",7),e.EFF(12),e.nI1(13,"translate"),e.k0s(),e.DNE(14,be,2,1,"span",8),e.k0s(),e.j41(15,"div",9)(16,"div",10)(17,"input",11),e.nI1(18,"translate"),e.bIt("change",function(p){return r.searchChange(p)}),e.k0s(),e.nrm(19,"i",12),e.k0s()()(),e.DNE(20,ve,2,0,"div",13),e.j41(21,"div",14),e.DNE(22,Ce,25,22,"ng-container",15),e.k0s()()()),2&i&&(e.R7$(3),e.JRh(e.bMT(4,12,"orderManagement.order.serviceCategory")),e.R7$(3),e.Y8G("circular",!0)("value",r.serviceCategories)("numVisible",4)("numScroll",1)("rtl",!1)("responsiveOptions",r.responsiveOptions),e.R7$(6),e.JRh(e.bMT(13,14,"orderManagement.order.selectedServices")),e.R7$(2),e.Y8G("ngIf",r.seviceCount>0),e.R7$(3),e.FS9("placeholder",e.bMT(18,16,"orderManagement.order.searchService")),e.R7$(3),e.Y8G("ngIf",0==r.filteredServices.length),e.R7$(2),e.Y8G("ngForOf",r.filteredServices))},dependencies:[_.YU,_.Sq,_.bT,pe.F,ge.Ei,C.Mm,C.D9],encapsulation:2})}}return s})();const Se=(s,u)=>({"border-right: solid #E5E5E6 2px":s,"border-left: solid #E5E5E6 2px":u}),Te=s=>({"border-bottom:1px solid #E5E5E6;":s});function Oe(s,u){if(1&s){const t=e.RV6();e.j41(0,"app-client-info",40),e.bIt("calacTotal",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.checkTotal())})("setFormByOrderCode",function(r){e.eBV(t);const o=e.XpG();return e.Njj(o.setFormByOrderCode(r))}),e.k0s()}if(2&s){const t=e.XpG();e.Y8G("isOrderEdit",t.isOrderEdit)("isInner",t.isInner)("orderTypes",t.orderTypes)("channels",t.channels)("cities",t.cities)("form",t.form)}}function Me(s,u){if(1&s&&e.nrm(0,"client-location",41),2&s){const t=e.XpG();e.Y8G("isOrderEdit",t.isOrderEdit)("form",t.form)}}function Ie(s,u){if(1&s){const t=e.RV6();e.j41(0,"app-order-services",42),e.bIt("CalcTotal",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.checkTotal())}),e.k0s()}if(2&s){const t=e.XpG();e.Y8G("isOrderEdit",t.isOrderEdit)("serviceCategories",t.serviceCategories)("form",t.form)}}function xe(s,u){if(1&s){const t=e.RV6();e.j41(0,"time-available",43),e.bIt("onTimeSelected",function(r){e.eBV(t);const o=e.XpG();return e.Njj(o.onTimeSelected(r))}),e.k0s()}if(2&s){const t=e.XpG();e.Y8G("isReopen",t.isReopen)("dataVisit",t.form.visitDate)("isOrderEdit",t.isOrderEdit)("categoryId",t.form.serviceCategoryCode)("orderSelected",t.form.orderTeams)("cityId",t.form.agent.cityCode)("isShowFilter",!1)}}function je(s,u){if(1&s){const t=e.RV6();e.j41(0,"app-order-payment",44),e.bIt("CalcTotal",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.checkTotal())})("finishedUpdateOrder",function(r){e.eBV(t);const o=e.XpG();return e.Njj(o.finishedUpdateOrder(r))})("finishedOrder",function(r){e.eBV(t);const o=e.XpG();return e.Njj(o.finishedOrder(r))}),e.k0s()}if(2&s){const t=e.XpG();e.Y8G("isOrderEdit",t.isOrderEdit)("paymentTypes",t.paymentTypes)("form",t.form)}}function ke(s,u){if(1&s){const t=e.RV6();e.j41(0,"app-finish-order",46),e.bIt("newOrder",function(){e.eBV(t);const r=e.XpG(2);return e.Njj(r.newOrder())}),e.k0s()}if(2&s){const t=e.XpG(2);e.Y8G("orderCode",t.orderCode)("form",t.form)}}function Ee(s,u){1&s&&(e.j41(0,"li",12)(1,"a",13),e.nrm(2,"i",45),e.j41(3,"span",15),e.EFF(4),e.nI1(5,"translate"),e.k0s()(),e.DNE(6,ke,1,2,"ng-template",16),e.k0s()),2&s&&(e.Y8G("ngbNavItem",6),e.R7$(4),e.SpI(" ",e.bMT(5,2,"orderManagement.order.finish")," "))}function Fe(s,u){if(1&s){const t=e.RV6();e.qex(0),e.j41(1,"tr",49)(2,"td",50)(3,"div",51)(4,"div",52)(5,"span",53),e.EFF(6),e.k0s(),e.EFF(7),e.k0s(),e.j41(8,"div",54)(9,"div",55)(10,"button",56),e.bIt("click",function(){const r=e.eBV(t),o=r.$implicit,p=r.index,d=e.XpG(2);return d.form.orderServices[p].quantity=d.form.orderServices[p].quantity-1,d.updatePrice(o,p),e.Njj(d.checkTotal())}),e.EFF(11,"\u2013 "),e.k0s(),e.nrm(12,"input",57),e.j41(13,"button",58),e.bIt("click",function(){const r=e.eBV(t),o=r.$implicit,p=r.index,d=e.XpG(2);return d.form.orderServices[p].quantity=d.form.orderServices[p].quantity+1,d.updatePrice(o,p),e.Njj(d.checkTotal())}),e.EFF(14,"+ "),e.k0s()()(),e.j41(15,"div",59),e.EFF(16),e.nI1(17,"translate"),e.j41(18,"i",60),e.bIt("click",function(){const r=e.eBV(t).index,o=e.XpG(2);return o.removeService(r),e.Njj(o.checkTotal())}),e.k0s()()()()(),e.bVm()}if(2&s){const t=u.$implicit,i=u.index,r=e.XpG(2);e.R7$(),e.Y8G("ngStyle",e.eq3(10,Te,i===r.form.orderServices.length-1)),e.R7$(5),e.JRh(i+1),e.R7$(),e.SpI(" ",t.serviceName," "),e.R7$(5),e.Mz_("id","cart-",t.code,""),e.FS9("value",t.quantity),e.R7$(4),e.Lme(" ",t.price," ",e.bMT(17,8,"orderManagement.order.currancy")," ")}}function Re(s,u){if(1&s&&(e.qex(0),e.j41(1,"h5",47),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.DNE(4,Fe,19,12,"ng-container",48),e.bVm()),2&s){const t=e.XpG();e.R7$(2),e.SpI(" ",e.bMT(3,2,"orderManagement.order.clientServices")," "),e.R7$(2),e.Y8G("ngForOf",t.form.orderServices)}}function Le(s,u){1&s&&(e.j41(0,"tr")(1,"td",61),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&s&&(e.R7$(2),e.SpI(" ",e.bMT(3,1,"orderManagement.order.noServices")," "))}function Ge(s,u){1&s&&(e.j41(0,"tr")(1,"td",62),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"td",63),e.EFF(5," 0 "),e.k0s()()),2&s&&(e.R7$(2),e.SpI(" ",e.bMT(3,1,"orderManagement.order.ServicePrice")," "))}let De=(()=>{class s{constructor(t,i,r,o){this.translateService=t,this.baseService=i,this.alertService=r,this.ngxLoader=o,this.editOrders="orderManagement.order.editOrders",this.addOrders="orderManagement.order.addOrders",this.titleOperation="orderManagement.order.titleOperation",this.keySelected="",this.active=1,this.language=this.translateService.currentLang,this.searchForm="",this.breadCrumbItems=[],this.form={orderCode:null,isUrgent:!1,discountAmount:0,total:0,serviceCategoryCode:[],formServices:{serviceCode:null,price:null,notes:null},formPayment:{paymentTypeCode:null,value:null,attachRecietPath:"",fileName:""},agent:{},orderTeams:[],orderPayments:[],orderLocations:{},orderServices:[]},this.orderCode=0,this.mobile=0,this.cityCode=0,this.agentName="",this.pendingCode=0,this.isInner=!1,this.isOrderEdit=!0,this.idForm=0,this.totalPaid=0,this.priceModel=0,this.priceModelIndex=0,this.subtotal=0,this.paidTotal=0,this.total=0,this.isResolveList=!0,this.extraDiscountCalc=!1,this.employeeGroups=[],this.notifier=new n.B,this.mainDelay=100,this.loaderSearchShap=f.cX,this.loaderOperationShap=f.$$,this.operationLoader=f.ZW,this.isEditForm=!1,this.showEdit=!1,this.channels=[],this.districts=[],this.cities=[],this.orderTypes=[],this.serviceCategories=[],this.services=[],this.paymentTypes=[],this.isFinished=!1,this.isUpdate=!1,this.isReopen=!1}OpenChangInput(t,i){this.showEdit=!0,this.priceModel=i.price,this.priceModelIndex=t}ChangInput(){this.form.orderServices[`${this.priceModelIndex}`].price=this.priceModel,this.showEdit=!1}ngOnDestroy(){this.notifier.next(),this.notifier.complete()}ngOnInit(){this.resetForm(),this.breadCrumbItems=[{label:"layout.sidebar.orders"},{label:"orderManagement.order.title",active:!0,url:"order/list"},{label:this.isEditForm?"general.action.edit":"general.action.register",active:!0}],this.GetOrderLookUp(),this.checkTotal()}GetOrderLookUp(){this.baseService.GetOrderLookUp().subscribe(t=>{this.channels=t.data.channels,this.cities=t.data.cityNames,this.orderTypes=t.data.orderStatus,this.serviceCategories=t.data.serviceCategories,this.paymentTypes=t.data.paymentTypes},t=>{console.log(t)})}getDistricts(t){this.ngxLoader.startLoader(f.ZW),this.baseService.districtsByCity(t).subscribe(i=>{this.districts=i.data,this.ngxLoader.stopLoader(f.ZW)},i=>{console.log(i)})}getTranslationText(t){let i="";return this.translateService.get(t).pipe((0,v.Q)(this.notifier)).subscribe(r=>{i=r}),i}checkTotal(){this.subtotal=this.form.orderServices.reduce((t,i)=>t+(i.price||0),0),this.paidTotal=this.form.orderPayments.reduce((t,i)=>t+(i.value||0),0),this.total=this.subtotal-(+this.form.discountAmount||0),this.form.total=this.total}setFormByOrderCode(t){this.form=t,this.checkTotal()}onTimeSelected(t){this.form.orderTeams=t,console.log(t)}onNavChange(t){2===t.nextId?!this.form.agent.mobile&&!this.form.agent.agentName&&!this.form.agent.cityCode&&(this.alertService.error("orderManagement.order.mustSelectClientInfo"),t.preventDefault()):4===t.nextId?this.form.orderServices.length<=0?(this.alertService.error("orderManagement.order.mustSelectServices"),t.preventDefault()):this.form.agent.cityCode||(this.alertService.error("orderManagement.order.mustSelectClientInfo"),t.preventDefault()):5===t.nextId?this.form.orderTeams.length<=0&&(this.alertService.error("orderManagement.order.mustSelectTimes"),t.preventDefault()):6===t.nextId&&(this.isFinished||t.preventDefault())}changeTab(){}finishedOrder(t){this.isFinished=!0,this.orderCode=t,this.active=6,this.resetForm()}finishedUpdateOrder(t){this.isFinished=!0,this.orderCode=t,this.active=6}newOrder(){this.resetForm(),this.orderCode=0,this.active=1,this.total=0,this.subtotal=0}resetForm(){this.form={orderCode:this.orderCode,pendingCode:this.pendingCode,discountAmount:0,total:0,serviceCategoryCode:[],formServices:{serviceCode:null,price:null,notes:null},formPayment:{paymentTypeCode:null,value:null,attachRecietPath:"",fileName:""},agent:{mobile:this.mobile,agentName:this.agentName,cityCode:this.cityCode},orderTeams:[],orderPayments:[],orderLocations:[],orderServices:[]}}removeService(t){this.form.orderServices.splice(t,1)}updatePrice(t,i){this.form.orderServices[i].price=t.price*t.quantity}static{this.\u0275fac=function(i){return new(i||s)(e.rXU(C.c$),e.rXU(T.Q),e.rXU(O.u),e.rXU(l.eD))}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["order-operation"]],inputs:{form:"form",orderCode:"orderCode",mobile:"mobile",cityCode:"cityCode",agentName:"agentName",pendingCode:"pendingCode",isInner:"isInner",isOrderEdit:"isOrderEdit",isReopen:"isReopen"},decls:102,vars:66,consts:[["formEntity","ngForm"],["customNav","ngbNav"],["discountAmount","ngModel"],[1,"row"],[1,"col-xl-12"],["fgsColor","rgba(255,255,255,0)",3,"loaderId"],[1,"checkout-tab"],[1,"col-12","col-lg-8","col-md-12","pe-3",3,"ngStyle"],[1,"card","mb-4","card-summary","card-order-operation","m-0",2,"border-radius","20px"],[1,"card-body",2,"padding","2rem"],[1,"step-arrow-nav","mt-n3","mx-n3","mb-3"],["ngbNav","","role","tablist",1,"nav","nav-pills","custom-nav","nav-justified",3,"navChange","activeId"],[3,"ngbNavItem"],["ngbNavLink","","data-bs-toggle","tab","role","tab",1,"nav-link","fs-15","p-3"],[1,"ri-user-3-fill","fs-16","p-2","bg-primary-subtle","text-primary","rounded-circle","align-middle","mx-2"],[1,"d-block","mt-2"],["ngbNavContent",""],[1,"ri-user-location-fill","fs-16","p-2","bg-primary-subtle","text-primary","rounded-circle","align-middle","mx-2"],[1,"ri-shopping-cart-fill","fs-16","p-2","bg-primary-subtle","text-primary","rounded-circle","align-middle","mx-2"],[1,"ri-alarm-line","fs-16","p-2","bg-primary-subtle","text-primary","rounded-circle","align-middle","mx-2"],[1,"ri-money-dollar-box-fill","fs-16","p-2","bg-primary-subtle","text-primary","rounded-circle","align-middle","mx-2"],[3,"ngbNavItem",4,"ngIf"],[1,"tab-content"],[3,"ngbNavOutlet"],[1,"col-12","col-lg-4","col-md-12","mt-3","mt-lg-0","mt-md-3","ps-3","summary"],[1,"card","card-summary","card-summary-pos","card-order-operation","m-0"],[1,"table-responsive","table-card","mt-3","overflow-hidden"],[1,"w-100","bg-success",2,"border-radius","10px"],[1,"text-white","p-2","text-center"],[1,"table","table-borderless","align-middle","mb-0"],[4,"ngIf"],[2,"border-top","hsl(226, 36%, 80%) solid 1px!important"],["colspan","2",1,"fw-semibold"],[1,"fw-semibold","text-end"],["colspan","2"],["InputTirmFilter","","name","discountAmount","type","text","id","discountAmount","required","",1,"100","form-control","text-right",3,"change","ngModelChange","ngModel"],[1,"table-active","py-1"],[1,"text-end"],[1,"fw-semibold"],[1,"table-active","text-danger","py-1"],[3,"calacTotal","setFormByOrderCode","isOrderEdit","isInner","orderTypes","channels","cities","form"],[3,"isOrderEdit","form"],[3,"CalcTotal","isOrderEdit","serviceCategories","form"],[3,"onTimeSelected","isReopen","dataVisit","isOrderEdit","categoryId","orderSelected","cityId","isShowFilter"],[3,"CalcTotal","finishedUpdateOrder","finishedOrder","isOrderEdit","paymentTypes","form"],[1,"ri-check-double-fill","fs-16","p-2","bg-primary-subtle","text-primary","rounded-circle","align-middle","mx-2"],[3,"newOrder","orderCode","form"],[1,"text-start","text-muted","fw-semibold","mt-3"],[4,"ngFor","ngForOf"],[3,"ngStyle"],["colspan","3",1,"p-1","m-1"],[1,"row","justify-content-between","align-items-center"],[1,"col-12","col-md-4","h6"],[1,"badge","bg-success-subtle","text-success"],[1,"col-12","col-md-4","text-mute","text-center"],[1,"input-step","my-2"],["type","button",1,"minus",3,"click"],["type","number","min","0","max","100",1,"product-quantity",3,"id","value"],["type","button",1,"plus",3,"click"],[1,"col-12","col-md-4","text-mute","text-right"],[1,"ri-close-fill","text-danger","cursor-pointer",3,"click"],["colspan","3",1,"text-center","text-danger"],[1,"text-start","text-muted","fw-semibold"],["colspan","2",1,"text-end"]],template:function(i,r){if(1&i){const o=e.RV6();e.j41(0,"div",3)(1,"div",4)(2,"div"),e.nrm(3,"ngx-ui-loader",5),e.j41(4,"div",6)(5,"div",3)(6,"div",7)(7,"div",8)(8,"div",9)(9,"div",10)(10,"form",null,0)(12,"ul",11,1),e.bIt("navChange",function(d){return e.eBV(o),e.Njj(r.onNavChange(d))}),e.j41(14,"li",12)(15,"a",13),e.nrm(16,"i",14),e.j41(17,"span",15),e.EFF(18),e.nI1(19,"translate"),e.k0s()(),e.DNE(20,Oe,1,6,"ng-template",16),e.k0s(),e.j41(21,"li",12)(22,"a",13),e.nrm(23,"i",17),e.j41(24,"span",15),e.EFF(25),e.nI1(26,"translate"),e.k0s()(),e.DNE(27,Me,1,2,"ng-template",16),e.k0s(),e.j41(28,"li",12)(29,"a",13),e.nrm(30,"i",18),e.j41(31,"span",15),e.EFF(32),e.nI1(33,"translate"),e.k0s()(),e.DNE(34,Ie,1,3,"ng-template",16),e.k0s(),e.j41(35,"li",12)(36,"a",13),e.nrm(37,"i",19),e.j41(38,"span",15),e.EFF(39),e.nI1(40,"translate"),e.k0s()(),e.DNE(41,xe,1,7,"ng-template",16),e.k0s(),e.j41(42,"li",12)(43,"a",13),e.nrm(44,"i",20),e.j41(45,"span",15),e.EFF(46),e.nI1(47,"translate"),e.k0s()(),e.DNE(48,je,1,3,"ng-template",16),e.k0s(),e.DNE(49,Ee,7,4,"li",21),e.k0s(),e.j41(50,"div",22),e.nrm(51,"div",23),e.k0s()()()()()(),e.j41(52,"div",24)(53,"div",25)(54,"div",9)(55,"div",26)(56,"div",27)(57,"h3",28),e.EFF(58),e.nI1(59,"translate"),e.k0s()(),e.j41(60,"table",29)(61,"tbody"),e.DNE(62,Re,5,4,"ng-container",30)(63,Le,4,3,"tr",30)(64,Ge,6,3,"tr",30),e.j41(65,"tr",31)(66,"td",32),e.EFF(67),e.nI1(68,"translate"),e.k0s(),e.j41(69,"td",33),e.EFF(70),e.nI1(71,"translate"),e.k0s()(),e.j41(72,"tr",31)(73,"td",32),e.EFF(74),e.nI1(75,"translate"),e.k0s(),e.j41(76,"td",33),e.EFF(77),e.nI1(78,"translate"),e.k0s()(),e.j41(79,"tr")(80,"td",34),e.EFF(81),e.nI1(82,"translate"),e.k0s(),e.j41(83,"td")(84,"input",35,2),e.bIt("change",function(){return e.eBV(o),e.Njj(r.checkTotal())}),e.mxI("ngModelChange",function(d){return e.eBV(o),e.DH7(r.form.discountAmount,d)||(r.form.discountAmount=d),e.Njj(d)}),e.k0s()()(),e.j41(86,"tr",36)(87,"th",34),e.EFF(88),e.nI1(89,"translate"),e.k0s(),e.j41(90,"td",37)(91,"span",38),e.EFF(92),e.nI1(93,"translate"),e.k0s()()(),e.j41(94,"tr",39)(95,"th",34),e.EFF(96),e.nI1(97,"translate"),e.k0s(),e.j41(98,"td",37)(99,"span",38),e.EFF(100),e.nI1(101,"translate"),e.k0s()()()()()()()()()()()()()()}if(2&i){const o=e.sdS(13);e.R7$(3),e.Y8G("loaderId","order"),e.R7$(3),e.Y8G("ngStyle",e.l_i(63,Se,"en"==r.language,"en"==r.language)),e.R7$(6),e.Y8G("activeId",r.active),e.R7$(2),e.Y8G("ngbNavItem",1),e.R7$(4),e.SpI(" ",e.bMT(19,33,"orderManagement.order.clientInfo")," "),e.R7$(3),e.Y8G("ngbNavItem",2),e.R7$(4),e.SpI(" ",e.bMT(26,35,"orderManagement.order.locations")," "),e.R7$(3),e.Y8G("ngbNavItem",3),e.R7$(4),e.SpI(" ",e.bMT(33,37,"orderManagement.order.services")," "),e.R7$(3),e.Y8G("ngbNavItem",4),e.R7$(4),e.SpI(" ",e.bMT(40,39,"orderManagement.order.timesNav")," "),e.R7$(3),e.Y8G("ngbNavItem",5),e.R7$(4),e.SpI(" ",e.bMT(47,41,"orderManagement.order.paid")," "),e.R7$(3),e.Y8G("ngIf",r.isOrderEdit),e.R7$(2),e.Y8G("ngbNavOutlet",o),e.R7$(7),e.SpI(" ",e.bMT(59,43,"orderManagement.order.orderSummary")," "),e.R7$(4),e.Y8G("ngIf",r.form.orderServices.length>0),e.R7$(),e.Y8G("ngIf",0==r.form.orderServices.length),e.R7$(),e.Y8G("ngIf",0==r.form.orderServices.length),e.R7$(3),e.SpI("",e.bMT(68,45,"orderManagement.order.SubTotal"),": "),e.R7$(3),e.Lme("",r.subtotal," ",e.bMT(71,47,"orderManagement.order.currancy"),""),e.R7$(4),e.SpI("",e.bMT(75,49,"orderManagement.order.paidTotal"),": "),e.R7$(3),e.Lme("",r.paidTotal," ",e.bMT(78,51,"orderManagement.order.currancy"),""),e.R7$(4),e.SpI("",e.bMT(82,53,"orderManagement.order.Discount"),":"),e.R7$(3),e.R50("ngModel",r.form.discountAmount),e.R7$(4),e.SpI("",e.bMT(89,55,"orderManagement.order.Total")," :"),e.R7$(4),e.Lme(" ",r.total," ",e.bMT(93,57,"orderManagement.order.currancy")," "),e.R7$(4),e.SpI("",e.bMT(97,59,"orderManagement.order.reminder")," :"),e.R7$(4),e.Lme(" ",r.total-r.paidTotal," ",e.bMT(101,61,"orderManagement.order.currancy")," ")}},dependencies:[_.Sq,_.bT,_.B3,M.Um,M.X9,M.sy,M.Gx,M.Ri,M.WA,M.m_,b.qT,b.me,b.BC,b.cb,b.YS,b.vS,b.cV,R.m,l.Cv,P.h,X,te,re,he,ye,C.D9],encapsulation:2})}}return s})()},80388:(B,x,c)=>{c.d(x,{h:()=>W});var n=c(54438),v=c(21413),f=c(56977),e=c(3888),C=c(33826),T=c(60177),O=c(8147),l=c(1530),_=c(89417),M=c(72510),b=c(91022);const R=(h,y)=>({"btn-outline-success":h,"btn-outline-danger":y});function P(h,y){if(1&h){const a=n.RV6();n.j41(0,"div",15)(1,"div",16),n.nrm(2,"label",17),n.j41(3,"div",18)(4,"ng-select",19),n.bIt("change",function(){n.eBV(a);const m=n.XpG();return n.Njj(m.getChange())}),n.mxI("ngModelChange",function(m){n.eBV(a);const S=n.XpG();return n.DH7(S.cityId,m)||(S.cityId=m),n.Njj(m)}),n.k0s()()(),n.j41(5,"div",20),n.nrm(6,"label",21),n.j41(7,"div",18)(8,"ng-select",22),n.bIt("change",function(){n.eBV(a);const m=n.XpG();return n.Njj(m.getChange())}),n.mxI("ngModelChange",function(m){n.eBV(a);const S=n.XpG();return n.DH7(S.categoryId,m)||(S.categoryId=m),n.Njj(m)}),n.k0s()()()()}if(2&h){const a=n.XpG();n.R7$(4),n.R50("ngModel",a.cityId),n.Y8G("items",a.cities)("multiple",!1),n.R7$(4),n.R50("ngModel",a.categoryId),n.Y8G("items",a.categories)("multiple",!0)}}function G(h,y){if(1&h){const a=n.RV6();n.j41(0,"button",23),n.bIt("click",function(){n.eBV(a);const m=n.XpG();return n.Njj(m.goNext())}),n.nrm(1,"i",24)(2,"span",25),n.k0s()}if(2&h){const a=n.XpG();n.Y8G("disabled",!a.isOrderEdit)}}function L(h,y){if(1&h){const a=n.RV6();n.j41(0,"button",23),n.bIt("click",function(){n.eBV(a);const m=n.XpG();return n.Njj(m.goBack())}),n.nrm(1,"i",26)(2,"span",27),n.k0s()}if(2&h){const a=n.XpG();n.Y8G("disabled",!a.isOrderEdit)}}function $(h,y){if(1&h){const a=n.RV6();n.j41(0,"button",23),n.bIt("click",function(){n.eBV(a);const m=n.XpG();return n.Njj(m.goBack())}),n.nrm(1,"span",27)(2,"i",26),n.k0s()}if(2&h){const a=n.XpG();n.Y8G("disabled",!a.isOrderEdit)}}function U(h,y){if(1&h){const a=n.RV6();n.j41(0,"button",23),n.bIt("click",function(){n.eBV(a);const m=n.XpG();return n.Njj(m.goNext())}),n.nrm(1,"span",25)(2,"i",24),n.k0s()}if(2&h){const a=n.XpG();n.Y8G("disabled",!a.isOrderEdit)}}function V(h,y){if(1&h&&(n.qex(0),n.j41(1,"th",38),n.EFF(2),n.k0s(),n.bVm()),2&h){const a=y.$implicit;n.R7$(2),n.SpI(" ",a.teamName," ")}}function w(h,y){if(1&h&&(n.qex(0),n.j41(1,"span",40),n.EFF(2),n.k0s(),n.nrm(3,"br"),n.j41(4,"span",41),n.EFF(5),n.k0s(),n.bVm()),2&h){const a=n.XpG(2).$implicit;n.R7$(2),n.JRh(a.serviceName),n.R7$(3),n.JRh(a.orderId)}}function X(h,y){1&h&&(n.qex(0),n.nrm(1,"span",42)(2,"br"),n.bVm())}function j(h,y){if(1&h&&(n.qex(0),n.j41(1,"td"),n.DNE(2,w,6,2,"ng-container",39)(3,X,3,0,"ng-container",39),n.k0s(),n.bVm()),2&h){const a=n.XpG().$implicit;n.R7$(2),n.Y8G("ngIf",!a.isHoliday),n.R7$(),n.Y8G("ngIf",a.isHoliday)}}function k(h,y){1&h&&n.nrm(0,"span",48)}function E(h,y){1&h&&n.nrm(0,"span",49)}function I(h,y){if(1&h){const a=n.RV6();n.qex(0),n.j41(1,"td")(2,"div",43)(3,"input",44),n.bIt("change",function(){n.eBV(a);const m=n.XpG(4);return n.Njj(m.onTimeAvaliables())}),n.mxI("ngModelChange",function(m){n.eBV(a);const S=n.XpG().$implicit;return n.DH7(S.isSelected,m)||(S.isSelected=m),n.Njj(m)}),n.k0s(),n.j41(4,"label",45),n.DNE(5,k,1,0,"span",46)(6,E,1,0,"span",47),n.k0s()()(),n.bVm()}if(2&h){const a=n.XpG().$implicit,g=n.XpG(3);n.R7$(3),n.Y8G("disabled",!g.isOrderEdit),n.R50("ngModel",a.isSelected),n.Y8G("id",a.id),n.R7$(),n.FS9("for",a.id),n.Y8G("ngClass",n.l_i(7,R,a.isSelected,!a.isSelected)),n.R7$(),n.Y8G("ngIf",a.isSelected),n.R7$(),n.Y8G("ngIf",!a.isSelected)}}function D(h,y){if(1&h&&(n.qex(0),n.DNE(1,j,4,2,"ng-container",39)(2,I,7,10,"ng-container",39),n.bVm()),2&h){const a=y.$implicit;n.R7$(),n.Y8G("ngIf",!a.isAvaliable),n.R7$(),n.Y8G("ngIf",a.isAvaliable)}}function N(h,y){if(1&h&&(n.qex(0),n.j41(1,"tr")(2,"td"),n.EFF(3),n.k0s(),n.DNE(4,D,3,2,"ng-container",37),n.k0s(),n.bVm()),2&h){const a=y.$implicit;n.R7$(3),n.JRh(a.diaplayName),n.R7$(),n.Y8G("ngForOf",a.availableTimes)}}function Y(h,y){if(1&h&&(n.j41(0,"div",28)(1,"div",29)(2,"div",30),n.nrm(3,"ngx-ui-loader",31),n.j41(4,"div",32)(5,"div",33)(6,"table",34)(7,"thead",35)(8,"tr"),n.nrm(9,"th",36),n.DNE(10,V,3,1,"ng-container",37),n.k0s()(),n.j41(11,"tbody"),n.DNE(12,N,5,2,"ng-container",37),n.k0s()()()()()()()),2&h){const a=n.XpG();n.R7$(3),n.Y8G("loaderId","timeAvailable"),n.R7$(7),n.Y8G("ngForOf",a.teams),n.R7$(2),n.Y8G("ngForOf",a.timesList)}}let W=(()=>{class h{constructor(a,g,m,S,F){this.alertService=a,this.orderService=g,this.datePipe=m,this.translateService=S,this.loader=F,this.title="orderManagement.timeAvailable.title",this.searchForm={date:new Date},this.cities=[],this.categories=[],this.dateCurrent=new Date,this.timesList=[],this.teams=[],this.onTimeSelected=new n.bkB,this.notifier=new v.B,this.isShowFilter=!0,this.dataVisit="",this.orderSelected=[],this.isFirst=!0,this.isOrderEdit=[],this.isReopen=!1}ngOnInit(){this.searchForm.date=null!=this.dataVisit&&""!=this.dataVisit?new Date(this.dataVisit):new Date,this.lang=this.translateService.currentLang,this.GetTimeAvailableLookup(),this.getTimeAvailables()}GetTimeAvailableLookup(){this.orderService.GetTimeAvailableLookup().pipe((0,f.Q)(this.notifier)).subscribe(a=>{this.cities=a.data.cities,this.categories=a.data.categories})}getChange(){setTimeout(()=>{this.getTimeAvailables()},50)}getTimeAvailables(){if(!this.validateForm())return;let g={};g.serviceCategoryId=this.categoryId,g.cityId=this.cityId,(""==this.dataVisit&&this.searchForm.date||null==this.dataVisit&&this.searchForm.date)&&(g.date=this.datePipe.transform(this.searchForm.date,"yyyy-MM-ddT00:00:00.000")),null!=this.dataVisit&&""!=this.dataVisit&&(g.date=this.dataVisit),this.loader.startLoader("timeAvailable"),this.orderService.GetAvailableTime(g).subscribe(m=>{this.loader.stopLoader("timeAvailable"),this.isFirst=!1,this.timesList=m.data.timesList,this.getOrderSelected(),this.teams=m.data.teams})}getOrderSelected(){console.log(this.orderSelected),this.orderSelected.length>0&&this.timesList.forEach(a=>{a.availableTimes.forEach(g=>{let m=this.orderSelected.find(S=>(S.orderCode===g.orderId||S.orderCode===g.orderCode)&&S.teamCode===g.teamId&&S.workTimeCode===g.timeId);(null!=m||null!=m)&&(this.isReopen?(g.isAvaliable=!0,g.isSelected=!1):g.isSelected=!0,g.orderTeamCode=m.orderTeamCode,g.orderCode=m.orderCode),g.isSelected&&(g.orderTeamCode=m.orderTeamCode,g.orderCode=m.orderCode,g.isAvaliable=g.isSelected),g.isOrderSelected=g.isSelected,console.log(g)})}),this.isReopen&&(this.orderSelected=[])}validateForm(){return this.cityId?this.categoryId?!!this.searchForm.date||(this.isFirst||this.alertService.error("orderManagement.timeAvailable.selectDate"),!1):(this.isFirst||this.alertService.error("orderManagement.timeAvailable.selectServiceCategory"),!1):(this.isFirst||this.alertService.error("orderManagement.timeAvailable.selectCity"),!1)}goBack(){this.searchForm.date=new Date(this.searchForm.date),this.searchForm.date.setDate(this.searchForm.date.getDate()-1),this.getTimeAvailables()}goNext(){this.searchForm.date=new Date(this.searchForm.date),this.searchForm.date.setDate(this.searchForm.date.getDate()+1),this.getTimeAvailables()}onTimeAvaliables(){const a=this.timesList.flatMap(g=>g.availableTimes.filter(m=>m.isSelected).map(m=>({orderTeamCode:m.orderTeamCode||0,orderCode:m.orderCode||0,teamCode:m.teamId,workTimeCode:m.timeId})));this.onTimeSelected.emit(a)}ngOnDestroy(){this.notifier.next(),this.notifier.complete()}static{this.\u0275fac=function(g){return new(g||h)(n.rXU(e.u),n.rXU(C.Q),n.rXU(T.vh),n.rXU(O.c$),n.rXU(l.eD))}}static{this.\u0275cmp=n.VBU({type:h,selectors:[["time-available"]],inputs:{isShowFilter:"isShowFilter",cityId:"cityId",categoryId:"categoryId",dataVisit:"dataVisit",orderSelected:"orderSelected",isOrderEdit:"isOrderEdit",isReopen:"isReopen"},outputs:{onTimeSelected:"onTimeSelected"},decls:17,vars:13,consts:[[1,"card","d-print-none"],[1,"card-body"],["class","row  justify-content-around  mb-2",4,"ngIf"],[1,"row","justify-content-center"],[1,"col-12","col-md-3"],["class","btn w-auto btn-sm btn-success fs-5",3,"disabled","click",4,"ngIf"],["class","btn  w-auto btn-sm btn-success fs-5",3,"disabled","click",4,"ngIf"],[1,"col-12","col-sm-6","col-md-4"],[1,"input-group"],["id","basic-addon1",1,"input-group-text","border","btn","btn-success",3,"click"],[1,"ri-calendar-line","align-bottom","me-1"],["type","text","mwlFlatpickr","","id","date","name","date",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"change","ngModelChange","disabled","altInput","convertModelValue","placeholder","ngModel"],[1,"col-12","col-md-3","text-right"],["class","btn   w-auto  btn-sm btn-success fs-5",3,"disabled","click",4,"ngIf"],["class","row",4,"ngIf"],[1,"row","justify-content-around","mb-2"],[1,"col-12","col-md-4"],["translate","orderManagement.timeAvailable.city",1,"required"],[1,"search-box"],["id","cityId","name","cityId","bindValue","id","bindLabel","name",3,"change","ngModelChange","ngModel","items","multiple"],[1,"col-12","col-md-6"],["translate","orderManagement.timeAvailable.categories",1,"required"],["id","categoryId","name","categoryId","bindValue","id","bindLabel","name",3,"change","ngModelChange","ngModel","items","multiple"],[1,"btn","w-auto","btn-sm","btn-success","fs-5",3,"click","disabled"],[1,"ri-arrow-left-circle-line","mx-2"],["translate","orderManagement.timeAvailable.next"],[1,"ri-arrow-right-circle-line","mx-2"],["translate","orderManagement.timeAvailable.back"],[1,"row"],[1,"col-12"],[1,"card"],["fgsColor","rgba(255,255,255,0)",3,"loaderId"],["id","printTable",1,"card-body"],[1,"table-responsive","table-card"],[1,"table","table-border","text-center","table-hover","table-centered","align-middle","table-nowrap","mb-0"],[1,"text-muted","border","table-light"],["translate","orderManagement.timeAvailable.time"],[4,"ngFor","ngForOf"],["scope","col",1,"border-1","text-center"],[4,"ngIf"],[1,"badge","d-inline-block","bg-primary-subtle","text-primary"],[1,"badge","d-inline-block","bg-success-subtle","text-success"],["translate","orderManagement.timeAvailable.holidayTeam",1,"badge","d-inline-block","bg-warning-subtle","text-warning"],[1,"p-0","flex-wrap","text-center"],["type","checkbox",1,"btn-check",3,"change","ngModelChange","disabled","ngModel","id"],[1,"btn","btn-outline-primary",3,"ngClass","for"],["translate","orderManagement.timeAvailable.block",4,"ngIf"],["translate","orderManagement.timeAvailable.unBlock",4,"ngIf"],["translate","orderManagement.timeAvailable.block"],["translate","orderManagement.timeAvailable.unBlock"]],template:function(g,m){1&g&&(n.j41(0,"div",0)(1,"div",1),n.DNE(2,P,9,6,"div",2),n.j41(3,"div",3)(4,"div",4),n.DNE(5,G,3,1,"button",5)(6,L,3,1,"button",6),n.k0s(),n.j41(7,"div",7)(8,"div",8)(9,"span",9),n.bIt("click",function(){return m.getTimeAvailables()}),n.nrm(10,"i",10),n.k0s(),n.j41(11,"input",11),n.nI1(12,"translate"),n.bIt("change",function(){return m.getChange()}),n.mxI("ngModelChange",function(F){return n.DH7(m.searchForm.date,F)||(m.searchForm.date=F),F}),n.k0s()()(),n.j41(13,"div",12),n.DNE(14,$,3,1,"button",5)(15,U,3,1,"button",13),n.k0s()()()(),n.DNE(16,Y,13,3,"div",14)),2&g&&(n.R7$(2),n.Y8G("ngIf",m.isShowFilter),n.R7$(3),n.Y8G("ngIf","ar"!=m.lang),n.R7$(),n.Y8G("ngIf","ar"==m.lang),n.R7$(5),n.FS9("placeholder",n.bMT(12,11,"orderManagement.timeAvailable.date")),n.Y8G("disabled",!m.isOrderEdit)("altInput",!0)("convertModelValue",!0),n.R50("ngModel",m.searchForm.date),n.R7$(3),n.Y8G("ngIf","ar"!=m.lang),n.R7$(),n.Y8G("ngIf","ar"==m.lang),n.R7$(),n.Y8G("ngIf",m.timesList.length>0))},dependencies:[T.YU,T.Sq,T.bT,_.me,_.Zm,_.BC,_.vS,O.Mm,M.vr,b.kL,l.Cv,O.D9]})}}return h})()}}]);