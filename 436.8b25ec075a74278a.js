"use strict";(self.webpackChunkvelzon=self.webpackChunkvelzon||[]).push([[436],{75922:(L,j,c)=>{c.d(j,{X:()=>T});var n=c(67569),C=c(45312),f=c(21413),e=c(54438),y=c(21626);let T=(()=>{class M extends n.d{constructor(_){super(_,C.c.apiUrl+"Agent/"),this.clientNumber=new f.B,this.clientNumber$=this.clientNumber.asObservable()}GetAgentLookUps(){return this.http.get(this.baseUrl+"AgentLookUps")}getOrders(_){return this.http.post(this.baseUrl+"ClientOrders",_)}getInvoices(_){return this.http.post(this.baseUrl+"ClientInvoices",_)}GetByMobile(_){return this.http.get(this.baseUrl+"GetByMobile/"+_)}AddLocation(_){return this.http.post(this.baseUrl+"AddLocation",_)}EditLocation(_){return this.http.put(this.baseUrl+"EditLocation",_)}DeleteLocation(_){return this.http.delete(this.baseUrl+"DeleteLocation/"+_,this.httpOptions)}static{this.\u0275fac=function(O){return new(O||M)(e.KVO(y.Qq))}}static{this.\u0275prov=e.jDH({token:M,factory:M.\u0275fac,providedIn:"root"})}}return M})()},33826:(L,j,c)=>{c.d(j,{Q:()=>y});var n=c(67569),C=c(45312),f=c(54438),e=c(21626);let y=(()=>{class T extends n.d{constructor(d){super(d,C.c.apiUrl+"Order/")}GetOrderLookUp(){return this.http.get(this.baseUrl+"OrderLookUp")}districtsByCity(d){return this.http.get(this.baseUrl+"districtsByCity/"+d)}registerNewOrder(d){return this.http.post(this.baseUrl+"RegisterNewOrder",d)}EditOrder(d){return this.http.post(this.baseUrl+"EditOrder",d)}getServicesByCategory(d){return this.http.post(this.baseUrl+"servicesByCategory",d)}getPendingOrders(d){return this.http.post(this.baseUrl+"GetAllPendingOrder",d)}getRecallOrders(d){return this.http.post(this.baseUrl+"GetAllRecallOrder",d)}getAfterSale(d){return this.http.post(this.baseUrl+"GetAfterSale",d)}UpdateCallCounter(d){return this.http.put(this.baseUrl+"UpdateCallCounter/"+d,{})}SubmitOrder(d){return this.http.put(this.baseUrl+"SureOrder/"+d,{})}assignOrder(d){return this.http.put(this.baseUrl+"AssignOrder/"+d,{})}SureOrderRollBack(d){return this.http.put(this.baseUrl+"SureOrderRollBack/"+d,{})}GetChartData(d){return this.http.post(this.baseUrl+"GetDailySummary",d)}GetTotalOrderSummaryChart(d){return this.http.post(this.baseUrl+"GetTotalOrderSummaryChart",d)}GetTotalOrderTableSummaryChart(d){return this.http.post(this.baseUrl+"GetTotalOrderTableSummaryChart",d)}GetChartLookup(){return this.http.get(this.baseUrl+"GetChartLookup")}GetTimeAvailableLookup(){return this.http.get(this.baseUrl+"GetTimeAvailableLookup")}GetAvailableTime(d){return this.http.post(this.baseUrl+"GetAvailableTime",d)}ReopenOrder(d){return this.http.put(this.baseUrl+"ReopenOrder",d)}CancelOrder(d){return this.http.put(this.baseUrl+"CancelOrder",d)}ChangeTeamStatus(d){return this.http.put(this.baseUrl+"ChangeTeamStatus",d)}GetById(d){return this.http.get(this.baseUrl+"GetById/"+d)}GoLead(d){return this.http.get(this.baseUrl+"GoLead/"+d)}GetOrderTimeLine(d){return this.http.get(this.baseUrl+"GetOrderTimeLine/"+d)}SaveNoAnswer(d){return this.http.get(this.baseUrl+"SaveNoAnswer/"+d)}RemoveAssign(d){return this.http.put(this.baseUrl+"RemoveAssign/"+d,{})}static{this.\u0275fac=function(_){return new(_||T)(f.KVO(e.Qq))}}static{this.\u0275prov=f.jDH({token:T,factory:T.\u0275fac,providedIn:"root"})}}return T})()},39436:(L,j,c)=>{c.d(j,{L:()=>De});var n=c(21413),C=c(56977),f=c(36158),e=c(54438),y=c(8147),T=c(33826),M=c(3888),d=c(1530),_=c(60177),O=c(69005),b=c(89417),k=c(29935),G=c(80388),E=c(45312),x=c(51188),D=c(99902),F=c(5779),N=c(35263),R=c(72510);function A(s,u){if(1&s){const t=e.RV6();e.j41(0,"button",23),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.addPayment())}),e.nrm(1,"i",24),e.k0s()}}function B(s,u){if(1&s){const t=e.RV6();e.j41(0,"button",25),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.editPaymentNew())}),e.nrm(1,"i",26),e.k0s()}}function P(s,u){1&s&&(e.j41(0,"tr",27)(1,"th",28),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",29),e.EFF(4," orderManagement.order.paymentMethods "),e.k0s(),e.j41(5,"th",29),e.EFF(6," orderManagement.order.paid "),e.k0s(),e.j41(7,"th",29),e.EFF(8," orderManagement.order.attchment "),e.k0s(),e.j41(9,"th",30),e.EFF(10," orderManagement.order.actions "),e.k0s()())}function U(s,u){if(1&s&&e.nrm(0,"img",37),2&s){const t=e.XpG().$implicit,r=e.XpG();e.Y8G("src",r.serverUrl+t.url,e.B4B)("alt",t.name)}}function $(s,u){if(1&s){const t=e.RV6();e.j41(0,"tr",31)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.DNE(8,U,1,2,"img",32),e.k0s(),e.j41(9,"td")(10,"button",33),e.bIt("click",function(){const i=e.eBV(t).$implicit,o=e.XpG();return e.Njj(o.editPayment(i))}),e.nrm(11,"i",34),e.k0s(),e.j41(12,"button",35),e.bIt("click",function(){const i=e.eBV(t).rowIndex,o=e.XpG();return e.Njj(o.deletePayment(i))}),e.nrm(13,"i",36),e.k0s()()()}if(2&s){const t=u.$implicit,r=u.rowIndex;e.R7$(2),e.JRh(r+1),e.R7$(2),e.JRh(t.paymentType),e.R7$(2),e.JRh(t.value),e.R7$(2),e.Y8G("ngIf",t.url)}}function w(s,u){1&s&&(e.j41(0,"tr")(1,"td",38),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&s&&(e.R7$(2),e.JRh(e.bMT(3,1,"orderManagement.order.noData")))}function V(s,u){if(1&s){const t=e.RV6();e.j41(0,"button",39),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.orderFinished())}),e.nrm(1,"i",40)(2,"span",41),e.k0s()}}function X(s,u){if(1&s){const t=e.RV6();e.j41(0,"button",43),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.orderEdit())}),e.nrm(1,"i",44)(2,"span",45),e.k0s()}}function Y(s,u){if(1&s&&(e.qex(0),e.DNE(1,X,3,0,"button",42),e.bVm()),2&s){const t=e.XpG();e.R7$(),e.Y8G("ngIf",t.form.orderCode>0)}}let p=(()=>{class s{constructor(t,r,i,o,g,m){this.routerActive=t,this.translateService=r,this.baseService=i,this.alertService=o,this.formDataService=g,this.ngxLoader=m,this.editOrders="orderManagement.order.editOrders",this.addOrders="orderManagement.order.addOrders",this.titleOperation="orderManagement.order.titleOperation",this.form={},this.keySelected="",this.assignUsers=[],this.times=[],this.active=0,this.shifts=[],this.searchForm="",this.jobTypes=[],this.weekDays=[],this.breadCrumbItems=[],this.todayDate="",this.idForm=0,this.totalPaid=0,this.priceModel=0,this.priceModelIndex=0,this.subtotal=0,this.total=0,this.isResolveList=!0,this.extraDiscountCalc=!1,this.employeeGroups=[],this.notifier=new n.B,this.mainDelay=100,this.loaderSearchShap=f.cX,this.loaderOperationShap=f.$$,this.operationLoader=f.ZW,this.isEditForm=!1,this.showEdit=!1,this.channels=[],this.districts=[],this.cities=[],this.orderTypes=[],this.paymentTypes=[],this.fileName="",this.base64String=null,this.formPayment={},this.isEdit=!1,this.finishedOrder=new e.bkB,this.finishedUpdateOrder=new e.bkB,this.CalcTotal=new e.bkB,this.isOrderEdit=!0,this.serverUrl=E.c.mediaUrl}OpenChangInput(t,r){this.showEdit=!0,this.priceModel=r.price,this.priceModelIndex=t}ChangInput(){this.form.tbOrderServices[`${this.priceModelIndex}`].price=this.priceModel,this.showEdit=!1}ngOnDestroy(){this.notifier.next(),this.notifier.complete()}ngOnInit(){}onFileSelected(t){const r=t.target;if(r.files&&r.files.length>0){const i=r.files[0];this.fileSelected=i,this.fileName=i.name;const o=new FileReader;o.onload=()=>{this.base64String=o.result},o.onerror=g=>{console.error("Error reading file:",g)},o.readAsDataURL(i),r.value=""}}addPayment(){let t=this.formPayment;if(t.value>this.form.total)return void this.alertService.error("orderManagement.order.addCostLargeTotal");let r=this.paymentTypes.filter(g=>g.id==t.paymentTypeCode)[0];this.form.orderPayments.push({orderPaymentCode:this.form.orderPaymentCode||0,orderCode:this.form.orderCode||0,paymentType:r.name,paymentTypeCode:t.paymentTypeCode,value:t.value,fileName:this.fileName,url:this.base64String,index:this.form.orderPayments.length+1,file:this.fileSelected});let o=0;this.form.orderPayments.forEach(g=>{o+=+g.value}),this.totalPaid=o,this.resetPaymentForm(),this.CalcTotal.next(!0)}checkTotal(){this.total=this.subtotal-+this.form.DiscountAmount}deleteService(t){this.form.tbOrderServices.splice(t,1)}deletePayment(t){this.form.orderPayments.splice(t,1),this.CalcTotal.next(!0)}resetServiceForm(){let t=this.form.formServices;t.serviceCode=void 0,t.price=null,t.notes=null}resetPaymentForm(){this.formPayment={},this.base64String="",this.fileName=""}configRoute(){this.routerActive.data.pipe((0,C.Q)(this.notifier)).subscribe(t=>{let r=t.data.data;r&&(this.isEditForm=!0,this.form=r,"Proposed"==r.leadsTypes?this.form.leadsTypes=1:"Inquiry"==r.leadsTypes&&(this.form.leadsTypes=2))},()=>{this.alertService.error()})}getTranslationText(t){let r="";return this.translateService.get(t).pipe((0,C.Q)(this.notifier)).subscribe(i=>{r=i}),r}editPayment(t){this.isEdit=!0,this.formPayment={},this.formPayment={...t}}editPaymentNew(){let t=this.formPayment;if(0==t.orderPaymentCode){let r=this.paymentTypes.filter(o=>o.id==t.paymentTypeCode)[0],i=this.form.orderPayments.find(o=>o.index==t.index);i.paymentType=r.name,i.value=t.value,i.fileName=""==this.fileName?i.fileName:this.fileName,i.url=""==this.base64String?i.base64String:this.base64String}this.isEdit=!1,this.formPayment={},this.CalcTotal.next(!0)}onTimeSelected(t){this.form.orderTeams=t,console.log(t)}orderFinished(){let t=this.mapForm();this.ngxLoader.startLoader("order"),this.baseService.registerNewOrder(t).subscribe(r=>{r.success?(this.ngxLoader.stopLoader("order"),this.finishedOrder.next(r.data.orderCode),this.alertService.success()):(this.alertService.error(),this.ngxLoader.stopLoader("order"))},()=>{this.alertService.error(),this.ngxLoader.stopLoader("order")})}mapForm(){let t=this.form;delete t.locations,delete t.formServices,delete t.formPayment,delete t.serviceCategoryCode,delete t.total;let r=[...this.form.orderPayments];return this.form.orderPayments=[],r.forEach(i=>{this.form.orderPayments.push({orderPaymentCode:i.orderPaymentCode,paymentType:i.paymentType,orderCode:i.orderCode,paymentTypeCode:i.paymentTypeCode,value:i.value,file:i.file})}),console.log(t),this.formDataService.formatFormData(t)}orderEdit(){let t=this.mapForm();this.ngxLoader.startLoader("order"),this.baseService.EditOrder(t).subscribe(r=>{r.success?(this.finishedUpdateOrder.next(r.data.orderCode),this.alertService.success(),this.ngxLoader.stopLoader("order")):(this.alertService.error(),this.ngxLoader.stopLoader("order"))},()=>{this.alertService.error(),this.ngxLoader.stopLoader("order")})}static{this.\u0275fac=function(r){return new(r||s)(e.rXU(x.nX),e.rXU(y.c$),e.rXU(T.Q),e.rXU(M.u),e.rXU(D.Q),e.rXU(d.eD))}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["app-order-payment"]],inputs:{form:"form",paymentTypes:"paymentTypes",isOrderEdit:"isOrderEdit"},outputs:{finishedOrder:"finishedOrder",finishedUpdateOrder:"finishedUpdateOrder",CalcTotal:"CalcTotal"},decls:28,vars:10,consts:[["value","ngModel"],["fileInput",""],["tableMaster",""],[1,"row","mt-3"],[1,"col-6","col-md-4","mb-2"],["translate","",1,"required","fw-bold","form-label","w-100"],["name","paymentTypeCode","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","ngModel"],["for","value","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","name","value","type","number","id","value",1,"form-control","fs-6",3,"ngModelChange","ngModel"],[1,"col-6","col-md-3","mb-2"],["type","file","placeholder","dfd",1,"form-control","fs-6",3,"change"],[1,"col-6","col-md-1","mb-2","d-flex","justify-content-center","align-items-end"],["type","button","class","btn btn-success btn-icon waves-effect waves-light",3,"click",4,"ngIf"],["type","button","class","btn btn-info btn-icon waves-effect waves-light",3,"click",4,"ngIf"],[1,"col-12","mt-3"],[1,"table-responsive"],["dataKey","id",3,"value","lazy"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"d-flex","align-items-start","gap-3","mt-4"],["type","button","class","btn btn-primary   right ms-auto nexttab","data-nexttab","pills-finish-tab",3,"click",4,"ngIf"],[4,"ngIf"],["type","button",1,"btn","btn-success","btn-icon","waves-effect","waves-light",3,"click"],[1,"ri-add-fill"],["type","button",1,"btn","btn-info","btn-icon","waves-effect","waves-light",3,"click"],[1,"ri-edit-2-line"],[1,""],["translate","",2,"width",".5%"],["translate","",2,"width","10%"],["translate","",2,"width","8%"],[1,"fs-5"],["class","img-thumbnail","width","50","height","50",3,"src","alt",4,"ngIf"],[1,"btn","btn-sm","btn-soft-info","edit-list","mx-2",3,"click"],[1,"ri-pencil-fill","align-bottom","mx-1"],[1,"btn","btn-sm","btn-soft-danger","remove-list",3,"click"],[1,"ri-delete-bin-5-fill","align-bottom"],["width","50","height","50",1,"img-thumbnail",3,"src","alt"],["colspan","5"],["type","button","data-nexttab","pills-finish-tab",1,"btn","btn-primary","right","ms-auto","nexttab",3,"click"],[1,"ri-checkbox-circle-fill","label-icon","align-middle","fs-16","ms-2"],["translate","orderManagement.order.orderComplete"],["type","button","class","btn btn-info   right ms-auto nexttab","data-nexttab","pills-finish-tab",3,"click",4,"ngIf"],["type","button","data-nexttab","pills-finish-tab",1,"btn","btn-info","right","ms-auto","nexttab",3,"click"],[1,"ri-edit-2-fill","label-icon","align-middle","fs-16","ms-2"],["translate","orderManagement.order.orderEdit"]],template:function(r,i){if(1&r){const o=e.RV6();e.j41(0,"div",3)(1,"div",4)(2,"label",5),e.EFF(3," orderManagement.order.paymentMethods"),e.k0s(),e.j41(4,"ng-select",6),e.mxI("ngModelChange",function(m){return e.eBV(o),e.DH7(i.formPayment.paymentTypeCode,m)||(i.formPayment.paymentTypeCode=m),e.Njj(m)}),e.k0s()(),e.j41(5,"div",4)(6,"label",7),e.EFF(7,"orderManagement.order.paid"),e.k0s(),e.j41(8,"input",8,0),e.mxI("ngModelChange",function(m){return e.eBV(o),e.DH7(i.formPayment.value,m)||(i.formPayment.value=m),e.Njj(m)}),e.k0s()(),e.j41(10,"div",9)(11,"label",7),e.EFF(12,"orderManagement.order.paid"),e.k0s(),e.j41(13,"input",10,1),e.bIt("change",function(m){return e.eBV(o),e.Njj(i.onFileSelected(m))}),e.k0s()(),e.j41(15,"div",11),e.DNE(16,A,2,0,"button",12)(17,B,2,0,"button",13),e.k0s(),e.j41(18,"div",14)(19,"div",15)(20,"p-table",16,2),e.DNE(22,P,11,0,"ng-template",17)(23,$,14,4,"ng-template",18)(24,w,4,3,"ng-template",19),e.k0s()()()(),e.j41(25,"div",20),e.DNE(26,V,3,0,"button",21)(27,Y,2,1,"ng-container",22),e.k0s()}2&r&&(e.R7$(4),e.Y8G("items",i.paymentTypes)("multiple",!1),e.R50("ngModel",i.formPayment.paymentTypeCode),e.R7$(4),e.R50("ngModel",i.formPayment.value),e.R7$(8),e.Y8G("ngIf",!i.isEdit),e.R7$(),e.Y8G("ngIf",i.isEdit),e.R7$(3),e.Y8G("value",i.form.orderPayments)("lazy",!0),e.R7$(6),e.Y8G("ngIf",i.form.orderCode<=0),e.R7$(),e.Y8G("ngIf",i.isOrderEdit))},dependencies:[_.bT,y.Mm,b.me,b.Q0,b.BC,b.vS,k.m,F.Ei,N.XI,R.vr,y.D9],encapsulation:2})}}return s})();var v=c(37021),a=c(35335),h=c(45236),l=c(70980),S=c(99437),I=c(18810);let H=(()=>{class s{constructor(t,r,i,o,g,m,Ne,Ae){this.routerActive=t,this.translateService=r,this.baseService=i,this.alertService=o,this.datePipe=g,this.modalService=m,this.ngxLoader=Ne,this.router=Ae,this.editOrders="orderManagement.order.editOrders",this.addOrders="orderManagement.order.addOrders",this.titleOperation="orderManagement.order.titleOperation",this.form={},this.keySelected="",this.assignUsers=[],this.times=[],this.active=0,this.shifts=[],this.searchForm="",this.jobTypes=[],this.weekDays=[],this.breadCrumbItems=[],this.todayDate="",this.idForm=0,this.totalPaid=0,this.priceModel=0,this.priceModelIndex=0,this.subtotal=0,this.total=0,this.isResolveList=!0,this.extraDiscountCalc=!1,this.employeeGroups=[],this.notifier=new n.B,this.mainDelay=100,this.loaderSearchShap=f.cX,this.loaderOperationShap=f.$$,this.operationLoader=f.ZW,this.isEditForm=!1,this.showEdit=!1,this.channels=[],this.districts=[],this.cities=[],this.orderTypes=[],this.serviceCategories=[],this.services=[],this.paymentTypes=[],this.fileName="",this.base64String=null,this.orderCode=[],this.newOrder=new e.bkB;const W=new Date;this.todayDate=`${W.getFullYear()}-${(W.getMonth()+1).toString().padStart(2,"0")}-${W.getDate().toString().padStart(2,"0")}`,console.log(this.todayDate)}nextDate(){let t=this.todayDate.split("-");this.todayDate=`${t[0]}-${t[1]}-${+t[2]+1}`,console.log(this.todayDate)}OpenChangInput(t,r){this.showEdit=!0,console.log(r),this.priceModel=r.price,this.priceModelIndex=t}ChangInput(){this.form.tbOrderServices[`${this.priceModelIndex}`].price=this.priceModel,this.showEdit=!1}previousDate(){let t=this.todayDate.split("-");this.todayDate=`${t[0]}-${t[1]}-${+t[2]-1}`,console.log(this.todayDate)}ngOnDestroy(){this.notifier.next(),this.notifier.complete()}ngOnInit(){this.configRoute(),this.breadCrumbItems=[{label:"layout.sidebar.orders"},{label:"orderManagement.order.title",active:!0,url:"order/list"},{label:this.isEditForm?"general.action.edit":"general.action.register",active:!0}],this.GetOrderLookUp()}onFileSelected(t){const r=t.target;if(r.files&&r.files.length>0){const i=r.files[0];this.fileName=i.name,console.log(i);const o=new FileReader;o.onload=()=>{this.base64String=o.result,console.log("Base64 String:",this.base64String)},o.onerror=g=>{console.error("Error reading file:",g)},o.readAsDataURL(i)}}addService(){let t=this.form.formServices,r=this.services.filter(o=>o.serviceCode==t.serviceCode)[0];this.form.tbOrderServices.push({service:r.name,serviceCode:r.code,price:t.price,notes:t.notes});let i=0;this.form.tbOrderServices.forEach(o=>{i+=+o.price}),this.subtotal=i,console.log(this.subtotal),this.checkTotal(),this.resetServiceForm()}addPayment(){let t=this.form.formPayment,r=this.paymentTypes.filter(o=>o.id==t.paymentTypeCode)[0];this.form.orderPayments.push({paymentType:r.name,paymentTypeCode:t.paymentTypeCode,value:t.value,fileName:this.fileName});let i=0;this.form.orderPayments.forEach(o=>{i+=+o.value}),this.totalPaid=i,this.resetPaymentForm()}checkTotal(){this.total=this.subtotal-+this.form.DiscountAmount}deleteService(t){this.form.tbOrderServices.splice(t,1)}deletePayment(t){this.form.orderPayments.splice(t,1)}resetServiceForm(){let t=this.form.formServices;t.serviceCode=void 0,t.price=null,t.notes=null}resetPaymentForm(){let t=this.form.formPayment;t.paymentTypeCode=null,t.value=null,t.attachRecietPath=null,t.fileName=null}configRoute(){this.routerActive.data.pipe((0,C.Q)(this.notifier)).subscribe(t=>{let r=t.data.data;r&&(this.isEditForm=!0,this.form=r,"Proposed"==r.leadsTypes?this.form.leadsTypes=1:"Inquiry"==r.leadsTypes&&(this.form.leadsTypes=2))},()=>{this.alertService.error()})}GetOrderLookUp(){this.baseService.GetOrderLookUp().subscribe(t=>{this.channels=t.data.channels,this.cities=t.data.cityNames,this.orderTypes=t.data.orderStatus,this.serviceCategories=t.data.serviceCategories,this.paymentTypes=t.data.paymentTypes},t=>{console.log(t)})}getDistricts(t){this.ngxLoader.startLoader(f.ZW),this.baseService.districtsByCity(t).subscribe(r=>{this.districts=r.data,this.ngxLoader.stopLoader(f.ZW)},r=>{console.log(r)})}getServicesByCategory(t){console.log(t),this.ngxLoader.startLoader(f.ZW),this.baseService.getServicesByCategory(t).subscribe(r=>{this.ngxLoader.stopLoader(f.ZW),this.services=r.data},r=>{console.log(r)})}OnSubmit(){this.ngxLoader.startLoader(this.operationLoader),!0===this.isEditForm?this.editEntity():this.registerEntity()}mapRegisterForm(t){let r={...t};return r.id=0,r}registerEntity(){this.ngxLoader.startLoader(f.ZW);let t=this.mapRegisterForm(this.form);this.baseService.registerNewOrder(t).pipe((0,v.O)(),(0,a.c)(this.mainDelay),(0,h.Z)(),(0,C.Q)(this.notifier),(0,l.j)(()=>this.ngxLoader.stopLoader(f.ZW)),(0,S.W)(r=>(0,I.$)(r))).subscribe(r=>{r.success?(this.alertService.success(),this.router.navigateByUrl("/order/list")):this.alertService.error("general.message."+r.message)},r=>{this.alertService.error("general.message."+r)})}editEntity(){this.baseService.editPut(this.form.id,this.form).pipe((0,v.O)(),(0,a.c)(this.mainDelay),(0,h.Z)(),(0,C.Q)(this.notifier),(0,l.j)(()=>this.ngxLoader.stopLoader(f.ZW))).subscribe(t=>{t.success?this.alertService.success():this.alertService.error("general.message."+t.message)},t=>{this.alertService.error("general.message."+t)})}getTranslationText(t){let r="";return this.translateService.get(t).pipe((0,C.Q)(this.notifier)).subscribe(i=>{r=i}),r}onTimeSelected(t){this.form.orderTeams=t}newOrderAgain(){this.newOrder.next(!0)}static{this.\u0275fac=function(r){return new(r||s)(e.rXU(x.nX),e.rXU(y.c$),e.rXU(T.Q),e.rXU(M.u),e.rXU(_.vh),e.rXU(O.Bq),e.rXU(d.eD),e.rXU(x.Ix))}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["app-finish-order"]],inputs:{form:"form",orderCode:"orderCode"},outputs:{newOrder:"newOrder"},decls:12,vars:1,consts:[[1,"text-center","py-5"],[1,"mb-4"],["src","https://cdn.lordicon.com/lupuorrc.json","trigger","loop","colors","primary:#0ab39c,secondary:#405189",2,"width","120px","height","120px"],["translate","orderManagement.order.orderSaveSuccess"],[1,"fw-semibold"],["translate","orderManagement.order.orderCode"],["routerLink","/ecommerce/order-details",1,"text-decoration-underline"],[1,"d-flex","align-items-start","gap-3","mt-4"],["type","button","data-nexttab","pills-finish-tab",1,"btn","btn-primary","btn-label","right","ms-auto","nexttab",3,"click"],[1,"ri-chat-new-line","label-icon","align-middle","fs-16","ms-2"],["translate","orderManagement.order.newOrderAgain"]],template:function(r,i){1&r&&(e.j41(0,"div",0)(1,"div",1),e.nrm(2,"lord-icon",2),e.k0s(),e.nrm(3,"h5",3),e.j41(4,"h3",4),e.nrm(5,"span",5),e.j41(6,"a",6),e.EFF(7),e.k0s()()(),e.j41(8,"div",7)(9,"button",8),e.bIt("click",function(){return i.newOrderAgain()}),e.nrm(10,"i",9)(11,"span",10),e.k0s()()),2&r&&(e.R7$(7),e.SpI("#SO#",i.orderCode,""))},dependencies:[y.Mm,x.Wk],encapsulation:2})}}return s})();var Q=c(75922),K=c(41631);function Z(s,u){if(1&s){const t=e.RV6();e.j41(0,"button",20),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.checkByMobile())}),e.EFF(1),e.nI1(2,"translate"),e.k0s()}2&s&&(e.R7$(),e.JRh(e.bMT(2,1,"general.search")))}function z(s,u){if(1&s){const t=e.RV6();e.j41(0,"button",20),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.checkByOrderCode())}),e.EFF(1),e.nI1(2,"translate"),e.k0s()}2&s&&(e.R7$(),e.JRh(e.bMT(2,1,"general.search")))}function J(s,u){1&s&&(e.j41(0,"div",21),e.EFF(1," general.message.filedIdRequired "),e.k0s())}let q=(()=>{class s{constructor(t,r,i,o,g){this.translateService=t,this.baseService=r,this.clientService=i,this.alertService=o,this.ngxLoader=g,this.form={},this.keySelected="",this.notifier=new n.B,this.mainDelay=100,this.loaderSearchShap=f.cX,this.loaderOperationShap=f.$$,this.operationLoader=f.ZW,this.isEditForm=!1,this.showEdit=!1,this.channels=[],this.districts=[],this.cities=[],this.orderTypes=[],this.isInner=!1,this.paymentTypes=[],this.isClientFound=!0,this.errorMessage="",this.setFormByOrderCode=new e.bkB,this.calacTotal=new e.bkB,this.isOrderEdit=!0}ngOnDestroy(){this.notifier.next(),this.notifier.complete()}ngOnInit(){this.form.orderCode>0?this.checkByOrderCode():this.form.agent.mobile>0&&this.checkByMobile(),this.clientService.clientNumber$.subscribe(()=>{this.checkByMobile(!1)})}getDistricts(t){this.ngxLoader.startLoader(f.ZW),this.baseService.districtsByCity(t).pipe((0,C.Q)(this.notifier)).subscribe(r=>{this.districts=r.data,this.ngxLoader.stopLoader(f.ZW)},r=>{console.log(r)})}mapRegisterForm(t){let r={...t};return r.id=0,r}getTranslationText(t){let r="";return this.translateService.get(t).pipe((0,C.Q)(this.notifier)).subscribe(i=>{r=i}),r}checkByOrderCode(){this.ngxLoader.startLoader("order"),this.baseService.GetById(this.form.orderCode).pipe((0,C.Q)(this.notifier)).subscribe(t=>{t.success?(this.ngxLoader.stopLoader("order"),this.setFormByOrderCode.next(t.data)):(this.ngxLoader.stopLoader("order"),this.alertService.error())},()=>{this.ngxLoader.stopLoader("order"),this.alertService.error()})}checkByMobile(t=!0){this.validatePhoneNumber(this.form.agent.mobile)?this.clientService.GetByMobile(this.form.agent.mobile).pipe((0,C.Q)(this.notifier)).subscribe(r=>{r.success?(this.form.agent.agentName=r.data.agentName,this.form.agent.agentCode=r.data.agentCode,this.form.agent.cityCode=r.data.cityCode,this.form.agent.agentAddStatusCode=2,this.form.locations=r.data.locations,this.getDistricts(r.data.cityCode),t&&this.alertService.success("orderManagement.order.clientFound"),this.isClientFound=!0):(this.isClientFound=!1,t&&this.alertService.error("orderManagement.order.clientNotFound"))}):this.alertService.error(this.errorMessage)}validatePhoneNumber(t){return this.errorMessage="",10!==t.length?(this.errorMessage="orderManagement.order.phoneMust10Digit",!1):t.startsWith("05")?/^\d+$/.test(t)?(this.errorMessage="",!0):(this.errorMessage="orderManagement.order.phoneMustContainOnlyDigit",!1):(this.errorMessage="orderManagement.order.phoneMustStart05.",!1)}static{this.\u0275fac=function(r){return new(r||s)(e.rXU(y.c$),e.rXU(T.Q),e.rXU(Q.X),e.rXU(M.u),e.rXU(d.eD))}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["app-client-info"]],inputs:{form:"form",channels:"channels",districts:"districts",cities:"cities",orderTypes:"orderTypes",isInner:"isInner",isOrderEdit:"isOrderEdit"},outputs:{setFormByOrderCode:"setFormByOrderCode",calacTotal:"calacTotal"},decls:37,vars:23,consts:[["mobile","ngModel"],["orderCode","ngModel"],["agentName","ngModel"],[1,"row","mt-4"],[1,"col-12","col-md-6","mb-3"],["for","mobile","translate","",1,"required","fw-bold","form-label"],[1,"input-group"],["InputTirmFilter","","name","mobile","type","search","maxlength","10","minlength","10","id","mobile","required","",1,"form-control","fs-6",3,"keydown.enter","ngModelChange","disabled","ngModel"],["class","btn btn-primary","type","button","id","button-addon2",3,"click",4,"ngIf"],["for","mobile","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","name","orderCode","type","search","id","orderCode",1,"form-control","fs-6",3,"ngModelChange","disabled","ngModel"],["for","name","translate","",1,"required","fw-bold","form-label"],["InputTirmFilter","","name","agentName","type","text","id","agentName","required","",1,"form-control","fs-6",3,"ngModelChange","disabled","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["translate","",1,"required","fw-bold","form-label","w-100"],["name","cityCode","bindValue","id","bindLabel","name","required","",3,"ngModelChange","disabled","items","multiple","ngModel"],["translate","",1,"fw-bold","form-label","w-100"],["name","cityCode","bindValue","id","bindLabel","name",3,"ngModelChange","disabled","items","multiple","ngModel"],["name","channelCode","bindValue","id","bindLabel","name",3,"ngModelChange","disabled","filter","items","multiple","ngModel"],["name","isUrgent","inputId","isUrgent",3,"ngModelChange","ngModel"],["type","button","id","button-addon2",1,"btn","btn-primary",3,"click"],["translate","",1,"text-danger","text-center"]],template:function(r,i){if(1&r){const o=e.RV6();e.j41(0,"div",3)(1,"div",4)(2,"label",5),e.EFF(3,"orderManagement.order.mobile"),e.k0s(),e.j41(4,"div",6)(5,"input",7,0),e.bIt("keydown.enter",function(){return e.eBV(o),e.Njj(i.checkByMobile())}),e.mxI("ngModelChange",function(m){return e.eBV(o),e.DH7(i.form.agent.mobile,m)||(i.form.agent.mobile=m),e.Njj(m)}),e.k0s(),e.DNE(7,Z,3,3,"button",8),e.k0s()(),e.j41(8,"div",4)(9,"label",9),e.EFF(10,"orderManagement.order.orderCode"),e.k0s(),e.j41(11,"div",6)(12,"input",10,1),e.mxI("ngModelChange",function(m){return e.eBV(o),e.DH7(i.form.orderCode,m)||(i.form.orderCode=m),e.Njj(m)}),e.k0s(),e.DNE(14,z,3,3,"button",8),e.k0s()(),e.j41(15,"div",4)(16,"label",11),e.EFF(17,"orderManagement.order.name"),e.k0s(),e.j41(18,"input",12,2),e.mxI("ngModelChange",function(m){return e.eBV(o),e.DH7(i.form.agent.agentName,m)||(i.form.agent.agentName=m),e.Njj(m)}),e.k0s(),e.DNE(20,J,2,0,"div",13),e.k0s(),e.j41(21,"div",4)(22,"label",14),e.EFF(23,"orderManagement.order.cityName"),e.k0s(),e.j41(24,"ng-select",15),e.mxI("ngModelChange",function(m){return e.eBV(o),e.DH7(i.form.agent.cityCode,m)||(i.form.agent.cityCode=m),e.Njj(m)}),e.k0s()(),e.j41(25,"div",4)(26,"label",16),e.EFF(27,"orderManagement.order.districtName"),e.k0s(),e.j41(28,"ng-select",17),e.mxI("ngModelChange",function(m){return e.eBV(o),e.DH7(i.form.districtCode,m)||(i.form.districtCode=m),e.Njj(m)}),e.k0s()(),e.j41(29,"div",4)(30,"label",16),e.EFF(31,"orderManagement.order.channelName"),e.k0s(),e.j41(32,"ng-select",18),e.mxI("ngModelChange",function(m){return e.eBV(o),e.DH7(i.form.channelCode,m)||(i.form.channelCode=m),e.Njj(m)}),e.k0s()(),e.j41(33,"div",4)(34,"label",16),e.EFF(35,"orderManagement.order.isUrgent"),e.k0s(),e.j41(36,"p-inputSwitch",19),e.mxI("ngModelChange",function(m){return e.eBV(o),e.DH7(i.form.isUrgent,m)||(i.form.isUrgent=m),e.Njj(m)}),e.k0s()()()}if(2&r){const o=e.sdS(19);e.R7$(5),e.Y8G("disabled",i.isInner),e.R50("ngModel",i.form.agent.mobile),e.R7$(2),e.Y8G("ngIf",!i.isInner),e.R7$(5),e.Y8G("disabled",i.isInner),e.R50("ngModel",i.form.orderCode),e.R7$(2),e.Y8G("ngIf",!i.isInner),e.R7$(4),e.Y8G("disabled",!i.isOrderEdit),e.R50("ngModel",i.form.agent.agentName),e.R7$(2),e.Y8G("ngIf",o.invalid&&o.touched),e.R7$(4),e.Y8G("disabled",!i.isOrderEdit)("items",i.cities)("multiple",!1),e.R50("ngModel",i.form.agent.cityCode),e.R7$(4),e.Y8G("disabled",!i.isOrderEdit)("items",i.districts)("multiple",!1),e.R50("ngModel",i.form.districtCode),e.R7$(4),e.Y8G("disabled",!i.isOrderEdit)("filter",!0)("items",i.channels)("multiple",!1),e.R50("ngModel",i.form.channelCode),e.R7$(4),e.R50("ngModel",i.form.isUrgent)}},dependencies:[_.bT,y.Mm,b.me,b.BC,b.YS,b.xh,b.tU,b.vS,k.m,R.vr,K.HW,y.D9],encapsulation:2})}}return s})();var ee=c(16743);const te=s=>({"active-category":s}),re=s=>({" border-service ":s});function ie(s,u){if(1&s){const t=e.RV6();e.j41(0,"div",15)(1,"div",16),e.bIt("click",function(){const i=e.eBV(t).$implicit,o=e.XpG();return e.Njj(o.chooseCategory(i))}),e.j41(2,"div",17),e.nrm(3,"img",18),e.j41(4,"span",19),e.EFF(5),e.k0s()()()()}if(2&s){const t=u.$implicit,r=e.XpG();e.R7$(),e.Mz_("id","category",t.id,""),e.Y8G("ngClass",e.eq3(6,te,t.isSelected)),e.R7$(2),e.Y8G("width",100)("src",r.serverImage+t.imageUrl,e.B4B),e.R7$(2),e.JRh(t.name)}}function ne(s,u){if(1&s&&(e.j41(0,"span",20),e.EFF(1),e.k0s()),2&s){const t=e.XpG();e.R7$(),e.JRh(t.seviceCount)}}function se(s,u){1&s&&(e.j41(0,"div",21),e.nrm(1,"button",22),e.k0s())}function oe(s,u){if(1&s){const t=e.RV6();e.qex(0),e.j41(1,"div",23)(2,"div",24)(3,"input",25),e.bIt("change",function(i){const o=e.eBV(t).$implicit,g=e.XpG();return e.Njj(g.onServiceChange(o.code,i))}),e.k0s(),e.j41(4,"label",26)(5,"div",27)(6,"div",28),e.qSk(),e.j41(7,"svg",29)(8,"style"),e.EFF(9," .s0 { opacity: .06; fill: var(--vz-primary) } "),e.k0s(),e.nrm(10,"path",30),e.k0s()(),e.joV(),e.j41(11,"div",31),e.nrm(12,"img",32),e.k0s(),e.j41(13,"div",33)(14,"h5",34),e.EFF(15),e.k0s()(),e.j41(16,"h6",35),e.EFF(17),e.nI1(18,"translate"),e.k0s(),e.j41(19,"div",36)(20,"button",37),e.bIt("click",function(i){const o=e.eBV(t).$implicit,g=e.XpG();return e.Njj(g.btnMinus(o.code,i))}),e.EFF(21,"\u2013"),e.k0s(),e.nrm(22,"input",38),e.j41(23,"button",39),e.bIt("click",function(i){const o=e.eBV(t).$implicit,g=e.XpG();return e.Njj(g.btnPlus(o.code,i))}),e.EFF(24,"+"),e.k0s()()()()()(),e.bVm()}if(2&s){const t=u.$implicit,r=e.XpG();e.R7$(3),e.Mz_("id","S",t.code,""),e.Y8G("value",t.isSelected)("checked",t.isSelected),e.R7$(),e.Mz_("for","S",t.code,""),e.R7$(),e.Y8G("ngClass",e.eq3(20,re,t.isSelected)),e.R7$(7),e.Y8G("width",150)("src",r.serverImage+t.imageUrl,e.B4B),e.R7$(3),e.JRh(t.name),e.R7$(2),e.Lme("",e.bMT(18,18,"orderManagement.order.currancy")," ",t.price," "),e.R7$(3),e.Y8G("disabled",!t.isSelected),e.R7$(2),e.Mz_("id","cart-",t.code,""),e.FS9("value",t.quantity),e.Y8G("disabled",!t.isSelected),e.R7$(),e.Y8G("disabled",!t.isSelected)}}let ae=(()=>{class s{constructor(t,r,i,o,g){this.routerActive=t,this.translateService=r,this.baseService=i,this.alertService=o,this.ngxLoader=g,this.form={},this.selectedServices=[],this.notifier=new n.B,this.mainDelay=100,this.loaderSearchShap=f.cX,this.loaderOperationShap=f.$$,this.operationLoader=f.ZW,this.isEditForm=!1,this.showEdit=!1,this.serviceCategories=[],this.services=[],this.currentLang=this.translateService.currentLang,this.subtotal=0,this.total=0,this.serverImage=E.c.mediaUrl,this.filteredServices=[],this.seviceCount=0,this.serviceSelected=[],this.CalcTotal=new e.bkB,this.isOrderEdit=!0,this.responsiveOptions=[{breakpoint:"1400px",numVisible:4,numScroll:3},{breakpoint:"1220px",numVisible:4,numScroll:2},{breakpoint:"1100px",numVisible:4,numScroll:1}]}ngOnDestroy(){this.notifier.next(),this.notifier.complete()}ngOnInit(){this.getServicesByCategory(),this.checkCategorySelected()}checkCategorySelected(){this.serviceCategories.forEach(t=>{t.isSelected=this.form.serviceCategoryCode.includes(t.id)})}addService(t){const r=this.form.orderServices.findIndex(i=>i.serviceCode===t.code);r>-1?this.form.orderServices.splice(r,1):this.form.orderServices.push({serviceName:t.name,serviceCode:t.code,quantity:t.quantity,price:t.price*t.quantity,notes:t.notes}),this.checkTotal(),this.resetServiceForm()}updatePrice(t){this.form.orderServices.find(i=>i.serviceCode===t.code).price=t.price*t.quantity}checkTotal(){this.CalcTotal.next(!0)}deleteService(t){this.form.orderServices.splice(t,1)}deletePayment(t){this.form.orderPayments.splice(t,1)}resetServiceForm(){let t=this.form.formServices;t.serviceCode=void 0,t.price=null,t.notes=null}resetPaymentForm(){let t=this.form.formPayment;t.paymentTypeCode=null,t.value=null,t.attachRecietPath=null,t.fileName=null}configRoute(){this.routerActive.data.pipe((0,C.Q)(this.notifier)).subscribe(t=>{let r=t.data.data;r&&(this.isEditForm=!0,this.form=r,"Proposed"==r.leadsTypes?this.form.leadsTypes=1:"Inquiry"==r.leadsTypes&&(this.form.leadsTypes=2))},()=>{this.alertService.error()})}getServicesByCategory(){let t=this.form.serviceCategoryCode;return t.length<=0?(this.services=[],this.filteredServices=[],0):(this.ngxLoader.startLoader("order"),this.baseService.getServicesByCategory(t).subscribe(r=>{this.ngxLoader.stopLoader("order"),this.services=r.data,this.filteredServices=this.services,this.checkSelected()},r=>{this.ngxLoader.stopLoader("order"),console.log(r)}),1)}checkSelected(){this.form.orderServices.forEach(t=>{let r=this.filteredServices.find(i=>i.code===t.serviceCode);r&&(r.isSelected=!0)})}getTranslationText(t){let r="";return this.translateService.get(t).pipe((0,C.Q)(this.notifier)).subscribe(i=>{r=i}),r}onTimeSelected(t){this.form.orderTeams=t,console.log(t)}chooseCategory(t){if(!this.isOrderEdit)return;let r=this.serviceCategories.find(i=>i.id===t.id);if(r.isSelected=!r.isSelected,r.isSelected)this.form.serviceCategoryCode.push(t.id);else{let i=this.serviceCategories.findIndex(o=>o.id===t.id);-1!==i&&this.form.serviceCategoryCode.splice(i,1)}this.getServicesByCategory()}onServiceChange(t,r){if(!this.isOrderEdit)return;r.stopPropagation();const i=this.filteredServices.find(o=>o.code===t);i&&(i.isSelected=!i.isSelected),this.seviceCount=this.filteredServices.filter(o=>o.isSelected).length,this.addService(i)}btnPlus(t,r){r.stopPropagation();const i=this.filteredServices.find(o=>o.code===t);i&&(i.quantity++,this.updatePrice(i),this.checkTotal())}btnMinus(t,r){r.stopPropagation();const i=this.filteredServices.find(o=>o.code===t);i&&i.quantity>1?i.quantity-=1:i.quantity=1,this.updatePrice(i),this.checkTotal()}searchChange(t){const r=t.target.value.toLowerCase();this.filteredServices=""===r?[...this.services]:this.services.filter(i=>i.name.toLowerCase().includes(r))}static{this.\u0275fac=function(r){return new(r||s)(e.rXU(x.nX),e.rXU(y.c$),e.rXU(T.Q),e.rXU(M.u),e.rXU(d.eD))}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["app-order-services"]],inputs:{form:"form",serviceCategories:"serviceCategories",isOrderEdit:"isOrderEdit"},outputs:{CalcTotal:"CalcTotal"},decls:23,vars:18,consts:[[1,"mt-2"],[1,"mb-0"],[3,"circular","value","numVisible","numScroll","rtl","responsiveOptions"],["pTemplate","item"],[1,"row","justify-content-between","align-items-center"],[1,"col-12","col-md-5"],[1,"mb-0","d-inline-block","position-relative"],["class","badge bg-primary mx-1",4,"ngIf"],[1,"col-12","col-md-5","mx-5"],[1,"search-box"],["type","search","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"change","placeholder"],[1,"ri-search-line","search-icon"],["class","d-flex justify-content-center",4,"ngIf"],[1,"mt-3","service-container","row","row-cols-3"],[4,"ngFor","ngForOf"],[1,"border-1","surface-border","border-round","m-2","p-3"],[1,"card",2,"max-width","194px!important","border-radius","15px !important","cursor","pointer","box-shadow","0px 0px 15px 0px #00000026 !important",3,"click","ngClass","id"],[1,"card-body","text-center"],["height","50","onerror","this.onerror=null;this.src='assets/images/custom/no-img.jpg';",1,"rounded",3,"width","src"],[1,"d-block","mt-2",2,"font-size",".9rem !important","min-height","55px","font-weight","500 !important","line-height","27.2px !important"],[1,"badge","bg-primary","mx-1"],[1,"d-flex","justify-content-center"],["type","button","translate","orderManagement.order.noCategoryMessage",1,"btn","btn-sm","my-2","btn-danger","fs-4","mb-3"],[1,"col-12","col-md-3","text-center"],[1,"btn-group","w-100"],["type","checkbox",1,"btn-check",3,"change","value","id","checked"],[1,"w-100",3,"for"],[1,"card","card-service","card-body",3,"ngClass"],[1,"position-absolute","start-0",2,"z-index","0"],["version","1.2","xmlns","http://www.w3.org/2000/svg","viewBox","0 0 200 120","width","90","height","120"],["id","Shape 8","d","m189.5-25.8c0 0 20.1 46.2-26.7 71.4 0 0-60 15.4-62.3 65.3-2.2 49.8-50.6 59.3-57.8 61.5-7.2 2.3-60.8 0-60.8 0l-11.9-199.4z",1,"s0"],[1,"w-100"],["height","80","onerror","this.onerror=null;this.src='assets/images/custom/no-img.jpg';",1,"avatar-sm","rounded-circle",3,"width","src"],[1,"ms-2","my-2"],[1,"card-title","mb-1"],[1,"mb-1"],[1,"input-step","my-2"],["type","button",1,"minus",3,"click","disabled"],["type","number","min","0","max","100",1,"product-quantity",3,"disabled","id","value"],["type","button",1,"plus",3,"click","disabled"]],template:function(r,i){1&r&&(e.qex(0),e.j41(1,"div",0)(2,"h4",1),e.EFF(3),e.nI1(4,"translate"),e.k0s(),e.j41(5,"bdi")(6,"p-carousel",2),e.DNE(7,ie,6,8,"ng-template",3),e.k0s()()(),e.j41(8,"div")(9,"div",4)(10,"div",5)(11,"h4",6),e.EFF(12),e.nI1(13,"translate"),e.k0s(),e.DNE(14,ne,2,1,"span",7),e.k0s(),e.j41(15,"div",8)(16,"div",9)(17,"input",10),e.nI1(18,"translate"),e.bIt("change",function(g){return i.searchChange(g)}),e.k0s(),e.nrm(19,"i",11),e.k0s()()(),e.DNE(20,se,2,0,"div",12),e.j41(21,"div",13),e.DNE(22,oe,25,22,"ng-container",14),e.k0s()(),e.bVm()),2&r&&(e.R7$(3),e.JRh(e.bMT(4,12,"orderManagement.order.serviceCategory")),e.R7$(3),e.Y8G("circular",!0)("value",i.serviceCategories)("numVisible",4)("numScroll",1)("rtl",!1)("responsiveOptions",i.responsiveOptions),e.R7$(6),e.JRh(e.bMT(13,14,"orderManagement.order.selectedServices")),e.R7$(2),e.Y8G("ngIf",i.seviceCount>0),e.R7$(3),e.FS9("placeholder",e.bMT(18,16,"orderManagement.order.searchService")),e.R7$(3),e.Y8G("ngIf",0==i.filteredServices.length),e.R7$(2),e.Y8G("ngForOf",i.filteredServices))},dependencies:[_.YU,_.Sq,_.bT,ee.F,F.Ei,y.Mm,y.D9],encapsulation:2})}}return s})();var le=c(25947),de=c(67569),ce=c(21626);let me=(()=>{class s extends de.d{constructor(t){super(t,E.c.apiUrl+"WhatsAppMessages/")}SendCallCounterMessage(t){return this.http.post(this.baseUrl+"SendCallCounterMessage/"+t,{})}SendNewOrderMessage(t){return this.http.post(this.baseUrl+"SendNewOrderMessage/"+t,{})}SendInvoiceMessage(t){return this.http.post(this.baseUrl+"SendInvoiceMessage/"+t,{})}static{this.\u0275fac=function(r){return new(r||s)(e.KVO(ce.Qq))}}static{this.\u0275prov=e.jDH({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})(),pe=(()=>{class s{constructor(){this.titleOperation="",this.loaderOperationShap=f.$$,this.deleteLoader=f.Fq,this.deleteConfirm=new e.bkB,this.dismiss=new e.bkB}deleteConfirmFn(){this.deleteConfirm.emit(!0)}dismissFn(){this.dismiss.emit(!0)}static{this.\u0275fac=function(r){return new(r||s)}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["delete-modal"]],inputs:{titleOperation:"titleOperation"},outputs:{deleteConfirm:"deleteConfirm",dismiss:"dismiss"},decls:15,vars:3,consts:[["formEntity","ngForm"],[3,"ngSubmit"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gsqxdxog.json","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","100px","height","100px"],[1,"mt-4","pt-2","fs-15","mx-4","mx-sm-5"],["translate","general.message.areyouSureDelete"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],["type","submit","id","delete","translate","general.action.delete",1,"btn","w-sm","btn-danger"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"]],template:function(r,i){if(1&r){const o=e.RV6();e.j41(0,"form",1,0),e.bIt("ngSubmit",function(){return e.eBV(o),e.Njj(i.deleteConfirmFn())}),e.nrm(2,"ngx-ui-loader",2),e.j41(3,"div",3)(4,"div",4)(5,"button",5),e.bIt("click",function(){return e.eBV(o),e.Njj(i.dismissFn())}),e.k0s()(),e.j41(6,"div",6)(7,"div",7),e.nrm(8,"lord-icon",8),e.j41(9,"div",9),e.nrm(10,"h4",10)(11,"p",11),e.k0s()(),e.j41(12,"div",12),e.nrm(13,"button",13),e.j41(14,"button",14),e.bIt("click",function(){return e.eBV(o),e.Njj(i.dismissFn())}),e.k0s()()()()()}2&r&&(e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",i.loaderOperationShap)("loaderId",i.deleteLoader))},dependencies:[y.Mm,b.qT,b.cb,b.cV,d.Cv],encapsulation:2})}}return s})();function he(s,u){if(1&s){const t=e.RV6();e.qex(0),e.j41(1,"div",16)(2,"div",17)(3,"input",18),e.bIt("change",function(){const i=e.eBV(t).$implicit,o=e.XpG();return e.Njj(o.locationChange(i))}),e.k0s(),e.j41(4,"label",19)(5,"span",20),e.EFF(6),e.k0s(),e.j41(7,"span",21),e.EFF(8),e.k0s()()(),e.j41(9,"div",22)(10,"div")(11,"a",23),e.bIt("click",function(){const i=e.eBV(t).$implicit,o=e.XpG(),g=e.sdS(10);return e.Njj(o.openEditModal(i,g))}),e.nrm(12,"i",24)(13,"span",25),e.k0s()(),e.j41(14,"div")(15,"a",26),e.bIt("click",function(){const i=e.eBV(t).$implicit,o=e.XpG(),g=e.sdS(12);return e.Njj(o.confirm(i.id,g))}),e.nrm(16,"i",27)(17,"span",28),e.k0s()()()(),e.bVm()}if(2&s){const t=u.$implicit;e.R7$(3),e.Mz_("id","S",t.id,""),e.Y8G("checked",t.isSelected),e.R7$(),e.Mz_("for","S",t.id,""),e.R7$(2),e.SpI(" ",t.name,""),e.R7$(2),e.SpI(" ",t.address,"")}}function ge(s,u){1&s&&(e.j41(0,"span",51),e.EFF(1,"general.action.register "),e.k0s())}function ue(s,u){1&s&&(e.j41(0,"span",51),e.EFF(1,"general.action.edit "),e.k0s())}function fe(s,u){1&s&&(e.j41(0,"div",52),e.EFF(1," general.message.filedIdRequired"),e.k0s())}function _e(s,u){1&s&&(e.j41(0,"div",52),e.EFF(1," general.message.filedIdRequired"),e.k0s())}function be(s,u){if(1&s){const t=e.RV6();e.j41(0,"div",29)(1,"div",30)(2,"h4",31),e.DNE(3,ge,2,0,"span",32)(4,ue,2,0,"span",32),e.k0s(),e.j41(5,"button",33),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss("Cross click"))}),e.k0s()(),e.j41(6,"div",34),e.nrm(7,"ngx-ui-loader",35),e.j41(8,"form",36,2),e.bIt("submit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.OnSubmit())}),e.j41(10,"div",37),e.nrm(11,"label",38),e.j41(12,"input",39,3),e.mxI("ngModelChange",function(i){e.eBV(t);const o=e.XpG();return e.DH7(o.formEdit.name,i)||(o.formEdit.name=i),e.Njj(i)}),e.k0s(),e.DNE(14,fe,2,0,"div",40),e.k0s(),e.j41(15,"div",37),e.nrm(16,"label",41),e.j41(17,"textarea",42,4),e.mxI("ngModelChange",function(i){e.eBV(t);const o=e.XpG();return e.DH7(o.formEdit.address,i)||(o.formEdit.address=i),e.Njj(i)}),e.k0s(),e.DNE(19,_e,2,0,"div",40),e.k0s(),e.j41(20,"div",37),e.nrm(21,"label",43),e.j41(22,"input",44,5),e.mxI("ngModelChange",function(i){e.eBV(t);const o=e.XpG();return e.DH7(o.formEdit.lat,i)||(o.formEdit.lat=i),e.Njj(i)}),e.k0s()(),e.j41(24,"div",37),e.nrm(25,"label",45),e.j41(26,"input",46,6),e.mxI("ngModelChange",function(i){e.eBV(t);const o=e.XpG();return e.DH7(o.formEdit.lng,i)||(o.formEdit.lng=i),e.Njj(i)}),e.k0s()(),e.j41(28,"div",47)(29,"button",48),e.nrm(30,"i",49)(31,"span",50),e.k0s()()()()()}if(2&s){const t=e.sdS(9),r=e.sdS(13),i=e.sdS(18),o=e.XpG();e.R7$(3),e.Y8G("ngIf",!o.isEditForm),e.R7$(),e.Y8G("ngIf",o.isEditForm),e.R7$(3),e.Y8G("hasProgressBar",!1)("fgsType",o.loaderOperationShap)("loaderId",o.operationLoader),e.R7$(5),e.R50("ngModel",o.formEdit.name),e.R7$(2),e.Y8G("ngIf",r.invalid&&r.touched),e.R7$(3),e.R50("ngModel",o.formEdit.address),e.R7$(2),e.Y8G("ngIf",i.invalid&&i.touched),e.R7$(3),e.R50("ngModel",o.formEdit.lat),e.R7$(4),e.R50("ngModel",o.formEdit.lng),e.R7$(3),e.Y8G("disabled",!t.valid)}}function ve(s,u){if(1&s){const t=e.RV6();e.j41(0,"delete-modal",53),e.bIt("deleteConfirm",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.DeleteConfirm())})("dismiss",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.k0s()}}let ye=(()=>{class s{constructor(t,r,i,o,g,m){this.modalService=t,this.baseService=r,this.alertService=i,this.ngxLoader=o,this.whatsupService=g,this.whatsAppMessagesService=m,this.submitted=!1,this.form={},this.mainDelay=20,this.notifier=new n.B,this.operationLoader=f.ZW,this.isEditForm=!1,this.loaderOperationShap=f.$$,this.isLoad=!1,this.formEdit={},this.idSelected=0,this.isOrderEdit=!0}ngOnInit(){this.checkLocation()}confirm(t,r){this.idSelected=t,this.modalService.open(r,{centered:!0})}openModal(t){this.ngxLoader.stopLoader(this.operationLoader),this.submitted=!1,this.modalService.open(t,{size:"md",centered:!0})}openEditModal(t,r){this.submitted=!1,this.formEdit=t,this.isEditForm=!0,this.modalService.open(r,{size:"md",centered:!0})}changeActiveTab(t){this.nav.select(t)}registerEntity(){this.ngxLoader.startLoader(this.operationLoader);let t=this.mapRegisterForm(this.formEdit);this.baseService.AddLocation(t).pipe((0,v.O)(),(0,a.c)(this.mainDelay),(0,h.Z)(),(0,C.Q)(this.notifier),(0,l.j)(()=>this.ngxLoader.stopLoader(this.operationLoader)),(0,S.W)(r=>(0,I.$)(r))).subscribe(r=>{r.success?(this.submitFunished(),this.refresh()):this.alertService.error("general.message."+r.message)},r=>{this.alertService.error("general.message."+r)})}editEntity(){let t=this.mapForm(this.formEdit);this.baseService.EditLocation(t).pipe((0,v.O)(),(0,a.c)(this.mainDelay),(0,h.Z)(),(0,C.Q)(this.notifier),(0,l.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(r=>{r.success?(this.submitFunished(),this.refresh()):this.alertService.error("general.message."+r.message)},r=>{this.alertService.error("general.message."+r)})}mapForm(t){return t.agentCode=this.form.agent.agentCode,t.cityCode=this.form.agent.cityCode,t.agentName=this.form.agent.agentName,t.mobile=this.form.agent.mobile,t}mapRegisterForm(t){return t.id=0,t.agentCode=this.form.agent.agentCode,t.cityCode=this.form.agent.cityCode,t.agentName=this.form.agent.agentName,t.mobile=this.form.agent.mobile,t}submitFunished(){this.alertService.success(),this.modalService?.dismissAll()}OnSubmit(){this.ngxLoader.startLoader(this.operationLoader),!0===this.isEditForm?this.editEntity():this.registerEntity()}getFromClient(){this.form.agent.mobile||this.alertService.error("orderManagement.order.mustEnterNumber"),this.isLoad=!0,this.whatsupService.GetLocationFromClient(this.form.agent.mobile).pipe((0,C.Q)(this.notifier),(0,l.j)(()=>this.isLoad=!1)).subscribe(t=>{t.success?this.alertService.success("orderManagement.order.successSendLocation"):this.alertService.error("orderManagement.order.failSendLocation")},()=>{this.alertService.error("orderManagement.order.failSendLocation")})}DeleteConfirm(){this.baseService.DeleteLocation(this.idSelected).pipe((0,v.O)(),(0,a.c)(this.mainDelay),(0,h.Z)(),(0,C.Q)(this.notifier),(0,l.j)(()=>this.ngxLoader.stopLoader("deleteLoader"))).subscribe(t=>{if(t.success){const r=this.form.locations.findIndex(i=>i.id===this.idSelected);-1!==r&&this.form.locations.splice(r,1),this.alertService.success(),this.modalService.dismissAll()}else this.alertService.error("general.message."+t)},()=>{this.alertService.error()})}refresh(){this.baseService.clientNumber.next(!0)}locationChange(t){this.form.orderLocations=[{lat:t.lat,lng:t.lng,agentLocationId:t.id,orderLocationCode:0,orderCode:0}];let r=this.form.locations.find(i=>i.id==t.id);r.isSelected=!r.isSelected}checkLocation(){}ngOnDestroy(){this.notifier.next(),this.notifier.complete()}static{this.\u0275fac=function(r){return new(r||s)(e.rXU(O.Bq),e.rXU(Q.X),e.rXU(M.u),e.rXU(d.eD),e.rXU(le.A),e.rXU(me))}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["client-location"]],viewQuery:function(r,i){if(1&r&&e.GBs(O.X9,5),2&r){let o;e.mGM(o=e.lsd())&&(i.nav=o.first)}},inputs:{form:"form",isOrderEdit:"isOrderEdit"},features:[e.Jv_([O.X9])],decls:13,vars:2,consts:[["content",""],["deleteModal",""],["formEntity","ngForm"],["name","ngModel"],["address","ngModel"],["lat","ngModel"],["lng","ngModel"],[1,"mt-4"],[1,"d-flex","align-items-center","mb-2"],[1,"flex-grow-1"],["translate","orderManagement.order.savedAddress",1,"fs-15","mb-0"],[1,"ri-refresh-fill","text-primary","align-bottom","mx-2","fs-4","cursor-pointer",3,"click"],[1,"flex-shrink-0"],["type","button","translate","orderManagement.order.sendToClient",1,"btn","btn-sm","btn-success","mb-3",3,"click","disabled"],[1,"row","gy-3"],[4,"ngFor","ngForOf"],[1,"col-lg-4","col-sm-6"],[1,"form-check","card-radio"],["name","location","type","radio",1,"form-check-input",3,"change","id","checked"],[1,"form-check-label",3,"for"],[1,"mb-4","fw-bold","d-block","text-muted","text-uppercase"],[1,"text-muted","fw-normal","text-wrap","mb-1","d-block"],[1,"d-flex","flex-wrap","p-2","py-1","bg-light","rounded-bottom","border","mt-n1"],["href","javascript:void(0);","data-bs-toggle","modal","data-bs-target","#addAddressModal",1,"d-block","text-body","p-1","px-2",3,"click"],[1,"ri-pencil-fill","text-muted","align-bottom","me-1"],["translate","general.action.edit"],["href","javascript:void(0);","data-bs-toggle","modal","data-bs-target","#removeItemModal",1,"d-block","text-body","p-1","px-2",3,"click"],[1,"ri-delete-bin-fill","text-muted","align-bottom","me-1"],["translate","general.action.delete"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["class","fw-bold fs-4","translate","",4,"ngIf"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"submit"],[1,"mb-3"],["for","name","translate","orderManagement.order.name",1,"required","fw-bold","form-label"],["InputTirmFilter","","name","name","type","text","id","name","required","",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["for","address","translate","orderManagement.order.address",1,"fw-bold","form-label"],["rows","2","InputTirmFilter","","name","address","type","text","id","address",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["for","lat","translate","orderManagement.order.lat",1,"fw-bold","form-label"],["disabled","","InputTirmFilter","","name","lat","type","text","id","lat",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["for","lng","translate","orderManagement.order.lng",1,"fw-bold","form-label"],["disabled","","InputTirmFilter","","name","lng","type","text","id","lng",1,"form-control","fs-6",3,"ngModelChange","ngModel"],[1,"text-center"],["type","submit","type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["translate","",1,"fw-bold","fs-4"],["translate","",1,"text-danger","text-center"],[3,"deleteConfirm","dismiss"]],template:function(r,i){if(1&r){const o=e.RV6();e.j41(0,"div",7)(1,"div",8)(2,"div",9)(3,"h5",10)(4,"i",11),e.bIt("click",function(){return e.eBV(o),e.Njj(i.refresh())}),e.k0s()()(),e.j41(5,"div",12)(6,"button",13),e.bIt("click",function(){e.eBV(o);const m=e.sdS(10);return e.Njj(i.openModal(m))}),e.k0s()()(),e.j41(7,"div",14),e.DNE(8,he,18,7,"ng-container",15),e.k0s()(),e.DNE(9,be,32,12,"ng-template",null,0,e.C5r)(11,ve,1,0,"ng-template",null,1,e.C5r)}2&r&&(e.R7$(6),e.Y8G("disabled",i.isLoad),e.R7$(2),e.Y8G("ngForOf",i.form.locations))},dependencies:[_.Sq,_.bT,y.Mm,b.qT,b.me,b.BC,b.cb,b.YS,b.vS,b.cV,d.Cv,k.m,pe],encapsulation:2})}}return s})();const Se=(s,u)=>({"border-right: solid #E5E5E6 2px":s,"border-left: solid #E5E5E6 2px":u}),Te=s=>({"border-bottom:1px solid #E5E5E6;":s});function Me(s,u){if(1&s){const t=e.RV6();e.j41(0,"app-client-info",42),e.bIt("calacTotal",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.checkTotal())})("setFormByOrderCode",function(i){e.eBV(t);const o=e.XpG();return e.Njj(o.setFormByOrderCode(i))}),e.k0s()}if(2&s){const t=e.XpG();e.Y8G("isOrderEdit",t.isOrderEdit)("isInner",t.isInner)("orderTypes",t.orderTypes)("channels",t.channels)("cities",t.cities)("form",t.form)}}function Oe(s,u){if(1&s&&e.nrm(0,"client-location",43),2&s){const t=e.XpG();e.Y8G("isOrderEdit",t.isOrderEdit)("form",t.form)}}function Ie(s,u){if(1&s){const t=e.RV6();e.j41(0,"app-order-services",44),e.bIt("CalcTotal",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.checkTotal())}),e.k0s()}if(2&s){const t=e.XpG();e.Y8G("isOrderEdit",t.isOrderEdit)("serviceCategories",t.serviceCategories)("form",t.form)}}function je(s,u){if(1&s){const t=e.RV6();e.j41(0,"time-available",45),e.bIt("onTimeSelected",function(i){e.eBV(t);const o=e.XpG();return e.Njj(o.onTimeSelected(i))}),e.k0s()}if(2&s){const t=e.XpG();e.Y8G("isReopen",t.isReopen)("dataVisit",t.form.visitDate)("isOrderEdit",t.isOrderEdit)("categoryId",t.form.serviceCategoryCode)("orderSelected",t.form.orderTeams)("cityId",t.form.agent.cityCode)("isShowFilter",!1)}}function xe(s,u){if(1&s){const t=e.RV6();e.j41(0,"app-order-payment",46),e.bIt("CalcTotal",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.checkTotal())})("finishedUpdateOrder",function(i){e.eBV(t);const o=e.XpG();return e.Njj(o.finishedUpdateOrder(i))})("finishedOrder",function(i){e.eBV(t);const o=e.XpG();return e.Njj(o.finishedOrder(i))}),e.k0s()}if(2&s){const t=e.XpG();e.Y8G("isOrderEdit",t.isOrderEdit)("paymentTypes",t.paymentTypes)("form",t.form)}}function ke(s,u){if(1&s){const t=e.RV6();e.j41(0,"app-finish-order",48),e.bIt("newOrder",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.newOrder())}),e.k0s()}if(2&s){const t=e.XpG(2);e.Y8G("orderCode",t.orderCode)("form",t.form)}}function Ee(s,u){1&s&&(e.j41(0,"li",12)(1,"a",13),e.nrm(2,"i",47),e.j41(3,"span",15),e.EFF(4),e.nI1(5,"translate"),e.k0s()(),e.DNE(6,ke,1,2,"ng-template",16),e.k0s()),2&s&&(e.Y8G("ngbNavItem",6),e.R7$(4),e.SpI(" ",e.bMT(5,2,"orderManagement.order.finish")," "))}function Fe(s,u){if(1&s&&(e.qex(0),e.j41(1,"tr",51)(2,"td",52)(3,"div",53)(4,"div",54)(5,"span",55),e.EFF(6),e.k0s(),e.EFF(7),e.k0s(),e.j41(8,"div",56),e.EFF(9),e.nI1(10,"translate"),e.k0s()()()(),e.bVm()),2&s){const t=u.$implicit,r=u.index,i=e.XpG(2);e.R7$(),e.Y8G("ngStyle",e.eq3(7,Te,r===i.form.orderServices.length-1)),e.R7$(5),e.JRh(r+1),e.R7$(),e.SpI(" ",t.serviceName," "),e.R7$(2),e.Lme(" ",t.price," ",e.bMT(10,5,"orderManagement.order.currancy")," ")}}function Re(s,u){if(1&s&&(e.qex(0),e.j41(1,"h5",49),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.DNE(4,Fe,11,9,"ng-container",50),e.bVm()),2&s){const t=e.XpG();e.R7$(2),e.SpI(" ",e.bMT(3,2,"orderManagement.order.clientServices")," "),e.R7$(2),e.Y8G("ngForOf",t.form.orderServices)}}function Le(s,u){1&s&&(e.j41(0,"tr")(1,"td",57),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&s&&(e.R7$(2),e.SpI(" ",e.bMT(3,1,"orderManagement.order.noServices")," "))}function Ge(s,u){1&s&&(e.j41(0,"tr")(1,"td",58),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"td",59),e.EFF(5," 0 "),e.k0s()()),2&s&&(e.R7$(2),e.SpI(" ",e.bMT(3,1,"orderManagement.order.ServicePrice")," "))}let De=(()=>{class s{constructor(t,r,i,o){this.translateService=t,this.baseService=r,this.alertService=i,this.ngxLoader=o,this.editOrders="orderManagement.order.editOrders",this.addOrders="orderManagement.order.addOrders",this.titleOperation="orderManagement.order.titleOperation",this.keySelected="",this.active=1,this.language=this.translateService.currentLang,this.searchForm="",this.breadCrumbItems=[],this.form={orderCode:null,isUrgent:!1,discountAmount:0,total:0,serviceCategoryCode:[],formServices:{serviceCode:null,price:null,notes:null},formPayment:{paymentTypeCode:null,value:null,attachRecietPath:"",fileName:""},agent:{},orderTeams:[],orderPayments:[],orderLocations:{},orderServices:[]},this.orderCode=0,this.mobile=0,this.cityCode=0,this.agentName="",this.pendingCode=0,this.isInner=!1,this.isOrderEdit=!0,this.idForm=0,this.totalPaid=0,this.priceModel=0,this.priceModelIndex=0,this.subtotal=0,this.paidTotal=0,this.total=0,this.isResolveList=!0,this.extraDiscountCalc=!1,this.employeeGroups=[],this.notifier=new n.B,this.mainDelay=100,this.loaderSearchShap=f.cX,this.loaderOperationShap=f.$$,this.operationLoader=f.ZW,this.isEditForm=!1,this.showEdit=!1,this.channels=[],this.districts=[],this.cities=[],this.orderTypes=[],this.serviceCategories=[],this.services=[],this.paymentTypes=[],this.isFinished=!1,this.isUpdate=!1,this.isReopen=!1}OpenChangInput(t,r){this.showEdit=!0,this.priceModel=r.price,this.priceModelIndex=t}ChangInput(){this.form.orderServices[`${this.priceModelIndex}`].price=this.priceModel,this.showEdit=!1}ngOnDestroy(){this.notifier.next(),this.notifier.complete()}ngOnInit(){this.resetForm(),this.breadCrumbItems=[{label:"layout.sidebar.orders"},{label:"orderManagement.order.title",active:!0,url:"order/list"},{label:this.isEditForm?"general.action.edit":"general.action.register",active:!0}],this.GetOrderLookUp(),this.checkTotal()}GetOrderLookUp(){this.baseService.GetOrderLookUp().subscribe(t=>{this.channels=t.data.channels,this.cities=t.data.cityNames,this.orderTypes=t.data.orderStatus,this.serviceCategories=t.data.serviceCategories,this.paymentTypes=t.data.paymentTypes},t=>{console.log(t)})}getDistricts(t){this.ngxLoader.startLoader(f.ZW),this.baseService.districtsByCity(t).subscribe(r=>{this.districts=r.data,this.ngxLoader.stopLoader(f.ZW)},r=>{console.log(r)})}getTranslationText(t){let r="";return this.translateService.get(t).pipe((0,C.Q)(this.notifier)).subscribe(i=>{r=i}),r}checkTotal(){this.subtotal=this.form.orderServices.reduce((t,r)=>t+(r.price||0),0),this.paidTotal=this.form.orderPayments.reduce((t,r)=>t+(r.value||0),0),this.total=this.subtotal-(+this.form.discountAmount||0),this.form.total=this.total}setFormByOrderCode(t){this.form=t,this.checkTotal()}onTimeSelected(t){this.form.orderTeams=t,console.log(t)}onNavChange(t){2===t.nextId?!this.form.agent.mobile&&!this.form.agent.agentName&&!this.form.agent.cityCode&&(this.alertService.error("orderManagement.order.mustSelectClientInfo"),t.preventDefault()):4===t.nextId?this.form.orderServices.length<=0?(this.alertService.error("orderManagement.order.mustSelectServices"),t.preventDefault()):this.form.agent.cityCode||(this.alertService.error("orderManagement.order.mustSelectClientInfo"),t.preventDefault()):5===t.nextId?this.form.orderTeams.length<=0&&(this.alertService.error("orderManagement.order.mustSelectTimes"),t.preventDefault()):6===t.nextId&&(this.isFinished||t.preventDefault())}changeTab(){}finishedOrder(t){this.isFinished=!0,this.orderCode=t,this.active=6,this.resetForm()}finishedUpdateOrder(t){this.isFinished=!0,this.orderCode=t,this.active=6}newOrder(){this.resetForm(),this.orderCode=0,this.active=1,this.total=0,this.subtotal=0}resetForm(){this.form={orderCode:this.orderCode,pendingCode:this.pendingCode,discountAmount:0,total:0,serviceCategoryCode:[],formServices:{serviceCode:null,price:null,notes:null},formPayment:{paymentTypeCode:null,value:null,attachRecietPath:"",fileName:""},agent:{mobile:this.mobile,agentName:this.agentName,cityCode:this.cityCode},orderTeams:[],orderPayments:[],orderLocations:[],orderServices:[]}}static{this.\u0275fac=function(r){return new(r||s)(e.rXU(y.c$),e.rXU(T.Q),e.rXU(M.u),e.rXU(d.eD))}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["order-operation"]],inputs:{form:"form",orderCode:"orderCode",mobile:"mobile",cityCode:"cityCode",agentName:"agentName",pendingCode:"pendingCode",isInner:"isInner",isOrderEdit:"isOrderEdit",isReopen:"isReopen"},decls:101,vars:66,consts:[["formEntity","ngForm"],["customNav","ngbNav"],["discountAmount","ngModel"],[1,"row"],[1,"col-xl-12"],[1,"card","card-summary","card-order-operation","m-0",2,"border-radius","20px"],["fgsColor","rgba(255,255,255,0)",3,"loaderId"],[1,"card-body","checkout-tab"],[1,"row","p-2","px-4"],[1,"col-12","col-md-8","pe-5",3,"ngStyle"],[1,"step-arrow-nav","mt-n3","mx-n3","mb-3"],["ngbNav","","role","tablist",1,"nav","nav-pills","custom-nav","nav-justified",3,"navChange","activeId"],[3,"ngbNavItem"],["ngbNavLink","","data-bs-toggle","tab","role","tab",1,"nav-link","fs-15","p-3"],[1,"ri-user-3-fill","fs-16","p-2","bg-primary-subtle","text-primary","rounded-circle","align-middle","mx-2"],[1,"d-block","mt-2"],["ngbNavContent",""],[1,"ri-user-location-fill","fs-16","p-2","bg-primary-subtle","text-primary","rounded-circle","align-middle","mx-2"],[1,"ri-shopping-cart-fill","fs-16","p-2","bg-primary-subtle","text-primary","rounded-circle","align-middle","mx-2"],[1,"ri-alarm-line","fs-16","p-2","bg-primary-subtle","text-primary","rounded-circle","align-middle","mx-2"],[1,"ri-money-dollar-box-fill","fs-16","p-2","bg-primary-subtle","text-primary","rounded-circle","align-middle","mx-2"],[3,"ngbNavItem",4,"ngIf"],[1,"tab-content"],[3,"ngbNavOutlet"],[1,"col-12","col-md-4","ps-5","summary"],[1,"text-center"],[1,"mb-4"],["width","200","height","100","src","assets/images/order-summary.png"],[1,"table-responsive","table-card","mt-3","overflow-hidden"],[1,"w-100","bg-success",2,"border-radius","10px"],[1,"text-white","p-2","text-center"],[1,"table","table-borderless","align-middle","mb-0"],[4,"ngIf"],[2,"border-top","hsl(226, 36%, 80%) solid 1px!important"],["colspan","2",1,"fw-semibold"],[1,"fw-semibold","text-end"],["colspan","2"],["InputTirmFilter","","name","discountAmount","type","text","id","discountAmount","required","",1,"100","form-control","text-right",3,"change","ngModelChange","ngModel"],[1,"table-active","py-1"],[1,"text-end"],[1,"fw-semibold"],[1,"table-active","text-danger","py-1"],[3,"calacTotal","setFormByOrderCode","isOrderEdit","isInner","orderTypes","channels","cities","form"],[3,"isOrderEdit","form"],[3,"CalcTotal","isOrderEdit","serviceCategories","form"],[3,"onTimeSelected","isReopen","dataVisit","isOrderEdit","categoryId","orderSelected","cityId","isShowFilter"],[3,"CalcTotal","finishedUpdateOrder","finishedOrder","isOrderEdit","paymentTypes","form"],[1,"ri-check-double-fill","fs-16","p-2","bg-primary-subtle","text-primary","rounded-circle","align-middle","mx-2"],[3,"newOrder","orderCode","form"],[1,"text-start","text-muted","fw-semibold","mt-3"],[4,"ngFor","ngForOf"],[3,"ngStyle"],["colspan","3",1,"p-1","m-1"],[1,"row","justify-content-between","align-items-center"],[1,"col-12","col-md-6","h6"],[1,"badge","bg-success-subtle","text-success"],[1,"col-12","col-md-4","text-mute","text-right"],["colspan","3",1,"text-center","text-danger"],[1,"text-start","text-muted","fw-semibold"],["colspan","2",1,"text-end"]],template:function(r,i){if(1&r){const o=e.RV6();e.j41(0,"div",3)(1,"div",4)(2,"div",5),e.nrm(3,"ngx-ui-loader",6),e.j41(4,"div",7)(5,"div",8)(6,"div",9)(7,"div",10)(8,"form",null,0)(10,"ul",11,1),e.bIt("navChange",function(m){return e.eBV(o),e.Njj(i.onNavChange(m))}),e.j41(12,"li",12)(13,"a",13),e.nrm(14,"i",14),e.j41(15,"span",15),e.EFF(16),e.nI1(17,"translate"),e.k0s()(),e.DNE(18,Me,1,6,"ng-template",16),e.k0s(),e.j41(19,"li",12)(20,"a",13),e.nrm(21,"i",17),e.j41(22,"span",15),e.EFF(23),e.nI1(24,"translate"),e.k0s()(),e.DNE(25,Oe,1,2,"ng-template",16),e.k0s(),e.j41(26,"li",12)(27,"a",13),e.nrm(28,"i",18),e.j41(29,"span",15),e.EFF(30),e.nI1(31,"translate"),e.k0s()(),e.DNE(32,Ie,1,3,"ng-template",16),e.k0s(),e.j41(33,"li",12)(34,"a",13),e.nrm(35,"i",19),e.j41(36,"span",15),e.EFF(37),e.nI1(38,"translate"),e.k0s()(),e.DNE(39,je,1,7,"ng-template",16),e.k0s(),e.j41(40,"li",12)(41,"a",13),e.nrm(42,"i",20),e.j41(43,"span",15),e.EFF(44),e.nI1(45,"translate"),e.k0s()(),e.DNE(46,xe,1,3,"ng-template",16),e.k0s(),e.DNE(47,Ee,7,4,"li",21),e.k0s(),e.j41(48,"div",22),e.nrm(49,"div",23),e.k0s()()()(),e.j41(50,"div",24)(51,"div",25)(52,"div",26),e.nrm(53,"img",27),e.k0s()(),e.j41(54,"div",28)(55,"div",29)(56,"h3",30),e.EFF(57),e.nI1(58,"translate"),e.k0s()(),e.j41(59,"table",31)(60,"tbody"),e.DNE(61,Re,5,4,"ng-container",32)(62,Le,4,3,"tr",32)(63,Ge,6,3,"tr",32),e.j41(64,"tr",33)(65,"td",34),e.EFF(66),e.nI1(67,"translate"),e.k0s(),e.j41(68,"td",35),e.EFF(69),e.nI1(70,"translate"),e.k0s()(),e.j41(71,"tr",33)(72,"td",34),e.EFF(73),e.nI1(74,"translate"),e.k0s(),e.j41(75,"td",35),e.EFF(76),e.nI1(77,"translate"),e.k0s()(),e.j41(78,"tr")(79,"td",36),e.EFF(80),e.nI1(81,"translate"),e.k0s(),e.j41(82,"td")(83,"input",37,2),e.bIt("change",function(){return e.eBV(o),e.Njj(i.checkTotal())}),e.mxI("ngModelChange",function(m){return e.eBV(o),e.DH7(i.form.discountAmount,m)||(i.form.discountAmount=m),e.Njj(m)}),e.k0s()()(),e.j41(85,"tr",38)(86,"th",36),e.EFF(87),e.nI1(88,"translate"),e.k0s(),e.j41(89,"td",39)(90,"span",40),e.EFF(91),e.nI1(92,"translate"),e.k0s()()(),e.j41(93,"tr",41)(94,"th",36),e.EFF(95),e.nI1(96,"translate"),e.k0s(),e.j41(97,"td",39)(98,"span",40),e.EFF(99),e.nI1(100,"translate"),e.k0s()()()()()()()()()()()()}if(2&r){const o=e.sdS(11);e.R7$(3),e.Y8G("loaderId","order"),e.R7$(3),e.Y8G("ngStyle",e.l_i(63,Se,"en"==i.language,"en"==i.language)),e.R7$(4),e.Y8G("activeId",i.active),e.R7$(2),e.Y8G("ngbNavItem",1),e.R7$(4),e.SpI(" ",e.bMT(17,33,"orderManagement.order.clientInfo")," "),e.R7$(3),e.Y8G("ngbNavItem",2),e.R7$(4),e.SpI(" ",e.bMT(24,35,"orderManagement.order.locations")," "),e.R7$(3),e.Y8G("ngbNavItem",3),e.R7$(4),e.SpI(" ",e.bMT(31,37,"orderManagement.order.services")," "),e.R7$(3),e.Y8G("ngbNavItem",4),e.R7$(4),e.SpI(" ",e.bMT(38,39,"orderManagement.order.timesNav")," "),e.R7$(3),e.Y8G("ngbNavItem",5),e.R7$(4),e.SpI(" ",e.bMT(45,41,"orderManagement.order.paid")," "),e.R7$(3),e.Y8G("ngIf",i.isOrderEdit),e.R7$(2),e.Y8G("ngbNavOutlet",o),e.R7$(8),e.SpI(" ",e.bMT(58,43,"orderManagement.order.orderSummary")," "),e.R7$(4),e.Y8G("ngIf",i.form.orderServices.length>0),e.R7$(),e.Y8G("ngIf",0==i.form.orderServices.length),e.R7$(),e.Y8G("ngIf",0==i.form.orderServices.length),e.R7$(3),e.SpI("",e.bMT(67,45,"orderManagement.order.SubTotal"),": "),e.R7$(3),e.Lme("",i.subtotal," ",e.bMT(70,47,"orderManagement.order.currancy"),""),e.R7$(4),e.SpI("",e.bMT(74,49,"orderManagement.order.paidTotal"),": "),e.R7$(3),e.Lme("",i.paidTotal," ",e.bMT(77,51,"orderManagement.order.currancy"),""),e.R7$(4),e.SpI("",e.bMT(81,53,"orderManagement.order.Discount"),":"),e.R7$(3),e.R50("ngModel",i.form.discountAmount),e.R7$(4),e.SpI("",e.bMT(88,55,"orderManagement.order.Total")," :"),e.R7$(4),e.Lme(" ",i.total," ",e.bMT(92,57,"orderManagement.order.currancy")," "),e.R7$(4),e.SpI("",e.bMT(96,59,"orderManagement.order.reminder")," :"),e.R7$(4),e.Lme(" ",i.total-i.paidTotal," ",e.bMT(100,61,"orderManagement.order.currancy")," ")}},dependencies:[_.Sq,_.bT,_.B3,O.Um,O.X9,O.sy,O.Gx,O.Ri,O.WA,O.m_,b.qT,b.me,b.BC,b.cb,b.YS,b.vS,b.cV,d.Cv,k.m,G.h,p,H,q,ae,ye,y.D9],encapsulation:2})}}return s})()},80388:(L,j,c)=>{c.d(j,{h:()=>Y});var n=c(54438),C=c(21413),f=c(56977),e=c(3888),y=c(33826),T=c(60177),M=c(8147),d=c(1530),_=c(89417),O=c(72510),b=c(91022);const k=(p,v)=>({"btn-outline-success":p,"btn-outline-danger":v});function G(p,v){if(1&p){const a=n.RV6();n.j41(0,"div",15)(1,"div",16),n.nrm(2,"label",17),n.j41(3,"div",18)(4,"ng-select",19),n.bIt("change",function(){n.eBV(a);const l=n.XpG();return n.Njj(l.getChange())}),n.mxI("ngModelChange",function(l){n.eBV(a);const S=n.XpG();return n.DH7(S.cityId,l)||(S.cityId=l),n.Njj(l)}),n.k0s()()(),n.j41(5,"div",20),n.nrm(6,"label",21),n.j41(7,"div",18)(8,"ng-select",22),n.bIt("change",function(){n.eBV(a);const l=n.XpG();return n.Njj(l.getChange())}),n.mxI("ngModelChange",function(l){n.eBV(a);const S=n.XpG();return n.DH7(S.categoryId,l)||(S.categoryId=l),n.Njj(l)}),n.k0s()()()()}if(2&p){const a=n.XpG();n.R7$(4),n.R50("ngModel",a.cityId),n.Y8G("items",a.cities)("multiple",!1),n.R7$(4),n.R50("ngModel",a.categoryId),n.Y8G("items",a.categories)("multiple",!0)}}function E(p,v){if(1&p){const a=n.RV6();n.j41(0,"button",23),n.bIt("click",function(){n.eBV(a);const l=n.XpG();return n.Njj(l.goNext())}),n.nrm(1,"i",24)(2,"span",25),n.k0s()}if(2&p){const a=n.XpG();n.Y8G("disabled",!a.isOrderEdit)}}function x(p,v){if(1&p){const a=n.RV6();n.j41(0,"button",23),n.bIt("click",function(){n.eBV(a);const l=n.XpG();return n.Njj(l.goBack())}),n.nrm(1,"i",26)(2,"span",27),n.k0s()}if(2&p){const a=n.XpG();n.Y8G("disabled",!a.isOrderEdit)}}function D(p,v){if(1&p){const a=n.RV6();n.j41(0,"button",23),n.bIt("click",function(){n.eBV(a);const l=n.XpG();return n.Njj(l.goBack())}),n.nrm(1,"span",27)(2,"i",26),n.k0s()}if(2&p){const a=n.XpG();n.Y8G("disabled",!a.isOrderEdit)}}function F(p,v){if(1&p){const a=n.RV6();n.j41(0,"button",23),n.bIt("click",function(){n.eBV(a);const l=n.XpG();return n.Njj(l.goNext())}),n.nrm(1,"span",25)(2,"i",24),n.k0s()}if(2&p){const a=n.XpG();n.Y8G("disabled",!a.isOrderEdit)}}function N(p,v){if(1&p&&(n.qex(0),n.j41(1,"th",38),n.EFF(2),n.k0s(),n.bVm()),2&p){const a=v.$implicit;n.R7$(2),n.SpI(" ",a.teamName," ")}}function R(p,v){if(1&p&&(n.qex(0),n.j41(1,"span",40),n.EFF(2),n.k0s(),n.nrm(3,"br"),n.j41(4,"span",41),n.EFF(5),n.k0s(),n.bVm()),2&p){const a=n.XpG(2).$implicit;n.R7$(2),n.JRh(a.serviceName),n.R7$(3),n.JRh(a.orderId)}}function A(p,v){1&p&&(n.qex(0),n.nrm(1,"span",42)(2,"br"),n.bVm())}function B(p,v){if(1&p&&(n.qex(0),n.j41(1,"td"),n.DNE(2,R,6,2,"ng-container",39)(3,A,3,0,"ng-container",39),n.k0s(),n.bVm()),2&p){const a=n.XpG().$implicit;n.R7$(2),n.Y8G("ngIf",!a.isHoliday),n.R7$(),n.Y8G("ngIf",a.isHoliday)}}function P(p,v){1&p&&n.nrm(0,"span",48)}function U(p,v){1&p&&n.nrm(0,"span",49)}function $(p,v){if(1&p){const a=n.RV6();n.qex(0),n.j41(1,"td")(2,"div",43)(3,"input",44),n.bIt("change",function(){n.eBV(a);const l=n.XpG(4);return n.Njj(l.onTimeAvaliables())}),n.mxI("ngModelChange",function(l){n.eBV(a);const S=n.XpG().$implicit;return n.DH7(S.isSelected,l)||(S.isSelected=l),n.Njj(l)}),n.k0s(),n.j41(4,"label",45),n.DNE(5,P,1,0,"span",46)(6,U,1,0,"span",47),n.k0s()()(),n.bVm()}if(2&p){const a=n.XpG().$implicit,h=n.XpG(3);n.R7$(3),n.Y8G("disabled",!h.isOrderEdit),n.R50("ngModel",a.isSelected),n.Y8G("id",a.id),n.R7$(),n.FS9("for",a.id),n.Y8G("ngClass",n.l_i(7,k,a.isSelected,!a.isSelected)),n.R7$(),n.Y8G("ngIf",a.isSelected),n.R7$(),n.Y8G("ngIf",!a.isSelected)}}function w(p,v){if(1&p&&(n.qex(0),n.DNE(1,B,4,2,"ng-container",39)(2,$,7,10,"ng-container",39),n.bVm()),2&p){const a=v.$implicit;n.R7$(),n.Y8G("ngIf",!a.isAvaliable),n.R7$(),n.Y8G("ngIf",a.isAvaliable)}}function V(p,v){if(1&p&&(n.qex(0),n.j41(1,"tr")(2,"td"),n.EFF(3),n.k0s(),n.DNE(4,w,3,2,"ng-container",37),n.k0s(),n.bVm()),2&p){const a=v.$implicit;n.R7$(3),n.JRh(a.diaplayName),n.R7$(),n.Y8G("ngForOf",a.availableTimes)}}function X(p,v){if(1&p&&(n.j41(0,"div",28)(1,"div",29)(2,"div",30),n.nrm(3,"ngx-ui-loader",31),n.j41(4,"div",32)(5,"div",33)(6,"table",34)(7,"thead",35)(8,"tr"),n.nrm(9,"th",36),n.DNE(10,N,3,1,"ng-container",37),n.k0s()(),n.j41(11,"tbody"),n.DNE(12,V,5,2,"ng-container",37),n.k0s()()()()()()()),2&p){const a=n.XpG();n.R7$(3),n.Y8G("loaderId","timeAvailable"),n.R7$(7),n.Y8G("ngForOf",a.teams),n.R7$(2),n.Y8G("ngForOf",a.timesList)}}let Y=(()=>{class p{constructor(a,h,l,S,I){this.alertService=a,this.orderService=h,this.datePipe=l,this.translateService=S,this.loader=I,this.title="orderManagement.timeAvailable.title",this.searchForm={date:new Date},this.cities=[],this.categories=[],this.dateCurrent=new Date,this.timesList=[],this.teams=[],this.onTimeSelected=new n.bkB,this.notifier=new C.B,this.isShowFilter=!0,this.dataVisit="",this.orderSelected=[],this.isFirst=!0,this.isOrderEdit=[],this.isReopen=!1}ngOnInit(){this.searchForm.date=null!=this.dataVisit&&""!=this.dataVisit?new Date(this.dataVisit):new Date,this.lang=this.translateService.currentLang,this.GetTimeAvailableLookup(),this.getTimeAvailables()}GetTimeAvailableLookup(){this.orderService.GetTimeAvailableLookup().pipe((0,f.Q)(this.notifier)).subscribe(a=>{this.cities=a.data.cities,this.categories=a.data.categories})}getChange(){setTimeout(()=>{this.getTimeAvailables()},50)}getTimeAvailables(){if(!this.validateForm())return;let h={};h.serviceCategoryId=this.categoryId,h.cityId=this.cityId,(""==this.dataVisit&&this.searchForm.date||null==this.dataVisit&&this.searchForm.date)&&(h.date=this.datePipe.transform(this.searchForm.date,"yyyy-MM-ddT00:00:00.000")),null!=this.dataVisit&&""!=this.dataVisit&&(h.date=this.dataVisit),this.loader.startLoader("timeAvailable"),this.orderService.GetAvailableTime(h).subscribe(l=>{this.loader.stopLoader("timeAvailable"),this.isFirst=!1,this.timesList=l.data.timesList,this.getOrderSelected(),this.teams=l.data.teams})}getOrderSelected(){this.orderSelected.length>0&&this.timesList.forEach(a=>{a.availableTimes.forEach(h=>{let l=this.orderSelected.find(S=>S.orderCode===h.orderId&&S.teamCode===h.teamId&&S.workTimeCode===h.timeId);null!=l&&(this.isReopen?(h.isAvaliable=!0,h.isSelected=!1):h.isSelected=!0,h.orderTeamCode=l.orderTeamCode,h.orderCode=l.orderCode),h.isSelected&&(h.orderTeamCode=l.orderTeamCode,h.orderCode=l.orderCode,h.isAvaliable=h.isSelected),h.isOrderSelected=h.isSelected})}),this.isReopen&&(this.orderSelected=[])}validateForm(){return this.cityId?this.categoryId?!!this.searchForm.date||(this.isFirst||this.alertService.error("orderManagement.timeAvailable.selectDate"),!1):(this.isFirst||this.alertService.error("orderManagement.timeAvailable.selectServiceCategory"),!1):(this.isFirst||this.alertService.error("orderManagement.timeAvailable.selectCity"),!1)}goBack(){this.searchForm.date=new Date(this.searchForm.date),this.searchForm.date.setDate(this.searchForm.date.getDate()-1),this.getTimeAvailables()}goNext(){this.searchForm.date=new Date(this.searchForm.date),this.searchForm.date.setDate(this.searchForm.date.getDate()+1),this.getTimeAvailables()}onTimeAvaliables(){const a=this.timesList.flatMap(h=>h.availableTimes.filter(l=>l.isSelected).map(l=>({orderTeamCode:l.orderTeamCode||0,orderCode:l.orderCode||0,teamCode:l.teamId,workTimeCode:l.timeId})));this.onTimeSelected.emit(a)}ngOnDestroy(){this.notifier.next(),this.notifier.complete()}static{this.\u0275fac=function(h){return new(h||p)(n.rXU(e.u),n.rXU(y.Q),n.rXU(T.vh),n.rXU(M.c$),n.rXU(d.eD))}}static{this.\u0275cmp=n.VBU({type:p,selectors:[["time-available"]],inputs:{isShowFilter:"isShowFilter",cityId:"cityId",categoryId:"categoryId",dataVisit:"dataVisit",orderSelected:"orderSelected",isOrderEdit:"isOrderEdit",isReopen:"isReopen"},outputs:{onTimeSelected:"onTimeSelected"},decls:17,vars:13,consts:[[1,"card","d-print-none"],[1,"card-body"],["class","row  justify-content-around  mb-2",4,"ngIf"],[1,"row","justify-content-center"],[1,"col-12","col-md-3"],["class","btn w-auto btn-sm btn-success fs-5",3,"disabled","click",4,"ngIf"],["class","btn  w-auto btn-sm btn-success fs-5",3,"disabled","click",4,"ngIf"],[1,"col-12","col-sm-6","col-md-4"],[1,"input-group"],["id","basic-addon1",1,"input-group-text","border","btn","btn-success",3,"click"],[1,"ri-calendar-line","align-bottom","me-1"],["type","text","mwlFlatpickr","","id","date","name","date",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"change","ngModelChange","disabled","altInput","convertModelValue","placeholder","ngModel"],[1,"col-12","col-md-3","text-right"],["class","btn   w-auto  btn-sm btn-success fs-5",3,"disabled","click",4,"ngIf"],["class","row",4,"ngIf"],[1,"row","justify-content-around","mb-2"],[1,"col-12","col-md-4"],["translate","orderManagement.timeAvailable.city",1,"required"],[1,"search-box"],["id","cityId","name","cityId","bindValue","id","bindLabel","name",3,"change","ngModelChange","ngModel","items","multiple"],[1,"col-12","col-md-6"],["translate","orderManagement.timeAvailable.categories",1,"required"],["id","categoryId","name","categoryId","bindValue","id","bindLabel","name",3,"change","ngModelChange","ngModel","items","multiple"],[1,"btn","w-auto","btn-sm","btn-success","fs-5",3,"click","disabled"],[1,"ri-arrow-left-circle-line","mx-2"],["translate","orderManagement.timeAvailable.next"],[1,"ri-arrow-right-circle-line","mx-2"],["translate","orderManagement.timeAvailable.back"],[1,"row"],[1,"col-12"],[1,"card"],["fgsColor","rgba(255,255,255,0)",3,"loaderId"],["id","printTable",1,"card-body"],[1,"table-responsive","table-card"],[1,"table","table-border","text-center","table-hover","table-centered","align-middle","table-nowrap","mb-0"],[1,"text-muted","border","table-light"],["translate","orderManagement.timeAvailable.time"],[4,"ngFor","ngForOf"],["scope","col",1,"border-1","text-center"],[4,"ngIf"],[1,"badge","d-inline-block","bg-primary-subtle","text-primary"],[1,"badge","d-inline-block","bg-success-subtle","text-success"],["translate","orderManagement.timeAvailable.holidayTeam",1,"badge","d-inline-block","bg-warning-subtle","text-warning"],[1,"p-0","flex-wrap","text-center"],["type","checkbox",1,"btn-check",3,"change","ngModelChange","disabled","ngModel","id"],[1,"btn","btn-outline-primary",3,"ngClass","for"],["translate","orderManagement.timeAvailable.block",4,"ngIf"],["translate","orderManagement.timeAvailable.unBlock",4,"ngIf"],["translate","orderManagement.timeAvailable.block"],["translate","orderManagement.timeAvailable.unBlock"]],template:function(h,l){1&h&&(n.j41(0,"div",0)(1,"div",1),n.DNE(2,G,9,6,"div",2),n.j41(3,"div",3)(4,"div",4),n.DNE(5,E,3,1,"button",5)(6,x,3,1,"button",6),n.k0s(),n.j41(7,"div",7)(8,"div",8)(9,"span",9),n.bIt("click",function(){return l.getTimeAvailables()}),n.nrm(10,"i",10),n.k0s(),n.j41(11,"input",11),n.nI1(12,"translate"),n.bIt("change",function(){return l.getChange()}),n.mxI("ngModelChange",function(I){return n.DH7(l.searchForm.date,I)||(l.searchForm.date=I),I}),n.k0s()()(),n.j41(13,"div",12),n.DNE(14,D,3,1,"button",5)(15,F,3,1,"button",13),n.k0s()()()(),n.DNE(16,X,13,3,"div",14)),2&h&&(n.R7$(2),n.Y8G("ngIf",l.isShowFilter),n.R7$(3),n.Y8G("ngIf","ar"!=l.lang),n.R7$(),n.Y8G("ngIf","ar"==l.lang),n.R7$(5),n.FS9("placeholder",n.bMT(12,11,"orderManagement.timeAvailable.date")),n.Y8G("disabled",!l.isOrderEdit)("altInput",!0)("convertModelValue",!0),n.R50("ngModel",l.searchForm.date),n.R7$(3),n.Y8G("ngIf","ar"!=l.lang),n.R7$(),n.Y8G("ngIf","ar"==l.lang),n.R7$(),n.Y8G("ngIf",l.timesList.length>0))},dependencies:[T.YU,T.Sq,T.bT,_.me,_.Zm,_.BC,_.vS,M.Mm,O.vr,b.kL,M.D9]})}}return p})()}}]);