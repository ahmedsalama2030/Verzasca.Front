"use strict";(self.webpackChunkvelzon=self.webpackChunkvelzon||[]).push([[371],{56701:(ge,W,p)=>{p.d(W,{g:()=>E});var c=p(54438),d=p(62984),m=p(51188),R=p(3888);let E=(()=>{class M{constructor(k,S,g){this.authservice=k,this.router=S,this.alertService=g}canActivate(k){return!!this.authservice.permissionMatch(k.data.permission)||(this.alertService.error("general.notAllow.notAllowPageMessage"),this.router.navigate(["/"]),!1)}static{this.\u0275fac=function(S){return new(S||M)(c.KVO(d.J),c.KVO(m.Ix),c.KVO(R.u))}}static{this.\u0275prov=c.jDH({token:M,factory:M.\u0275fac,providedIn:"root"})}}return M})()},12260:(ge,W,p)=>{p.d(W,{h:()=>E});var c=p(67569),d=p(45312),m=p(54438),R=p(21626);let E=(()=>{class M extends c.d{constructor(k){super(k,d.c.apiUrl+"City/")}static{this.\u0275fac=function(S){return new(S||M)(m.KVO(R.Qq))}}static{this.\u0275prov=m.jDH({token:M,factory:M.\u0275fac,providedIn:"root"})}}return M})()},25947:(ge,W,p)=>{p.d(W,{A:()=>E});var c=p(67569),d=p(45312),m=p(54438),R=p(21626);let E=(()=>{class M extends c.d{constructor(k){super(k,d.c.apiUrl+"WhatsApp/")}GetWhatsAppSetting(){return this.http.get(this.baseUrl+"GetWhatsAppSetting")}GetLocationFromClient(k){return this.http.get(this.baseUrl+"GetLocationFromClient/"+k)}static{this.\u0275fac=function(S){return new(S||M)(m.KVO(R.Qq))}}static{this.\u0275prov=m.jDH({token:M,factory:M.\u0275fac,providedIn:"root"})}}return M})()},7065:(ge,W,p)=>{p.r(W),p.d(W,{OrderModule:()=>ao});var c=p(60177),d=p(89417),m=p(69005),R=p(91022),E=p(70255),M=p(63789),Q=p(98982),k=p.n(Q),S=p(93887),g=p(8147),C=p(35263),le=p(65430),Me=p(41631),v=p(1530),V=p(72510),f=p(51188),e=p(54438);let Ee=(()=>{class r{constructor(){}ngOnInit(){}static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-order-map"]],decls:0,vars:0,template:function(i,n){},encapsulation:2})}}return r})();var G=p(75622),q=p(33826),y=p(3888),A=p(62984),ne=p(94575),h=p(56977),_=p(36158),L=p(91426),z=p(12260),H=p(16229),J=p(12822),$=p(40724),Z=p(75392),ae=p(15084),U=p(88148),Y=p(91580),P=p(5779),B=p(29935);function Ne(r,l){if(1&r){const t=e.RV6();e.j41(0,"button",24),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.dismissFn())}),e.k0s()}}function De(r,l){}function Oe(r,l){if(1&r&&(e.qex(0),e.j41(1,"h2",9)(2,"button",10)(3,"div",11)(4,"div",12)(5,"div",13),e.nrm(6,"i",14),e.k0s()(),e.j41(7,"div",15)(8,"span",16),e.nrm(9,"span",25),e.k0s(),e.j41(10,"bdi")(11,"span",16),e.nrm(12,"span",18),e.j41(13,"span",19),e.EFF(14),e.nI1(15,"date"),e.k0s()()()(),e.j41(16,"div",15)(17,"h6",16)(18,"span",19)(19,"span",26),e.EFF(20),e.k0s()()()()()()(),e.bVm()),2&r){const t=e.XpG();e.R7$(14),e.JRh(e.i5U(15,2,t.orderSelected.assignDate,"yyyy-MM-dd HH:mm:sss")),e.R7$(6),e.SpI("",t.orderSelected.assignUser," ")}}function we(r,l){if(1&r&&(e.qex(0),e.j41(1,"h2",9)(2,"button",10)(3,"div",11)(4,"div",12)(5,"div",13),e.nrm(6,"i",14),e.k0s()(),e.j41(7,"div",15)(8,"span",16),e.nrm(9,"span",27),e.k0s(),e.j41(10,"bdi")(11,"span",16),e.nrm(12,"span",18),e.j41(13,"span",19),e.EFF(14),e.nI1(15,"date"),e.k0s()()()(),e.j41(16,"div",15)(17,"h6",16)(18,"span",19)(19,"span",26),e.EFF(20),e.k0s()()()()()()(),e.bVm()),2&r){const t=e.XpG();e.R7$(14),e.JRh(e.i5U(15,2,t.orderSelected.confirmedDate,"yyyy-MM-dd HH:mm:sss")),e.R7$(6),e.SpI("",t.orderSelected.confirmedUser," ")}}function Ve(r,l){if(1&r&&(e.qex(0),e.j41(1,"h2",9)(2,"button",10)(3,"div",11)(4,"div",12)(5,"div",13),e.nrm(6,"i",14),e.k0s()(),e.j41(7,"div",15)(8,"span",16),e.nrm(9,"span",28),e.k0s(),e.j41(10,"bdi")(11,"span",16),e.nrm(12,"span",18),e.j41(13,"span",19),e.EFF(14),e.nI1(15,"date"),e.k0s()()()(),e.j41(16,"div",15)(17,"h6",16)(18,"span",19)(19,"span",26),e.EFF(20),e.k0s()()()()()()(),e.bVm()),2&r){const t=e.XpG();e.R7$(14),e.JRh(e.i5U(15,2,t.orderSelected.finishDate,"yyyy-MM-dd HH:mm:sss")),e.R7$(6),e.SpI("",t.orderSelected.finishUser," ")}}let ee=(()=>{class r{constructor(){this.orderSelected={},this.hideCloseIcon=!1,this.dismiss=new e.bkB}ngOnInit(){}dismissFn(){this.dismiss.emit(!0)}getTeam(t){return""!=t||null!=t||null!=t?[]:t.split(",")}static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["order-timeline"]],inputs:{orderSelected:"orderSelected",hideCloseIcon:"hideCloseIcon"},outputs:{dismiss:"dismiss"},decls:36,vars:10,consts:[["accordion","ngbAccordion"],[1,"modal-header","p-1","bg-success-subtle"],["id","createTaskLabel","translate","orderManagement.order.trackOrder",1,"modal-title"],["type","button","class","btn-close","data-bs-dismiss","modal","id","createTaskBtn-close","aria-label","Close",3,"click",4,"ngIf"],[1,"modal-body"],[1,"card-body"],[1,"profile-timeline","order-status"],["ngbAccordion",""],["ngbAccordionItem","",3,"collapsed"],["ngbAccordionHeader",""],["ngbAccordionButton","","aria-expanded","true",1,"accordion-button","p-2","shadow-none"],[1,"d-flex","align-items-center"],[1,"flex-shrink-0","avatar-xs"],[1,"avatar-title","rounded-circle"],[1,"ri-arrow-down-fill"],[1,"flex-grow-1","ms-3"],[1,"fs-14","mb-0"],["translate","orderManagement.order.creation"],[1,"fw-normal","mx-4"],[1,"mx-2"],[1,"badge","bg-success-subtle","text-success"],["ngbAccordionCollapse",""],["ngbAccordionBody","",1,"ms-2","ps-5","pt-0"],[4,"ngIf"],["type","button","data-bs-dismiss","modal","id","createTaskBtn-close","aria-label","Close",1,"btn-close",3,"click"],["translate","orderManagement.order.assignDate"],[1,"badge","bg-warning-subtle","text-warning"],["translate","orderManagement.order.sureDate"],["translate","orderManagement.order.finishDate"]],template:function(i,n){1&i&&(e.j41(0,"div",1),e.nrm(1,"h5",2),e.DNE(2,Ne,1,0,"button",3),e.k0s(),e.j41(3,"div",4)(4,"div",5)(5,"div",6)(6,"div",7,0)(8,"div",8),e.qex(9),e.j41(10,"h2",9)(11,"button",10)(12,"div",11)(13,"div",12)(14,"div",13),e.nrm(15,"i",14),e.k0s()(),e.j41(16,"div",15)(17,"span",16),e.nrm(18,"span",17),e.k0s(),e.j41(19,"bdi")(20,"span",16),e.nrm(21,"span",18),e.j41(22,"span",19),e.EFF(23),e.nI1(24,"date"),e.k0s()()()(),e.j41(25,"div",15)(26,"h6",16)(27,"span",19)(28,"span",20),e.EFF(29),e.k0s()()()()()()(),e.j41(30,"div",21)(31,"div",22),e.DNE(32,De,0,0,"ng-template"),e.k0s()(),e.bVm(),e.DNE(33,Oe,21,5,"ng-container",23)(34,we,21,5,"ng-container",23)(35,Ve,21,5,"ng-container",23),e.k0s()()()()()),2&i&&(e.R7$(2),e.Y8G("ngIf",!n.hideCloseIcon),e.R7$(6),e.Y8G("collapsed",!1),e.R7$(15),e.JRh(e.i5U(24,7,n.orderSelected.createdDate,"yyyy-MM-dd HH:mm:sss")),e.R7$(6),e.SpI("",n.orderSelected.creationUser," "),e.R7$(4),e.Y8G("ngIf",null!=n.orderSelected.assignDate),e.R7$(),e.Y8G("ngIf",null!=n.orderSelected.confirmedDate),e.R7$(),e.Y8G("ngIf",null!=n.orderSelected.finishDate))},dependencies:[c.bT,g.Mm,m.WP,m.r6,m.tW,m.x7,m.UA,m.$R,c.vh],encapsulation:2})}}return r})();function Ge(r,l){if(1&r&&(e.j41(0,"div",41)(1,"div",42)(2,"div",6)(3,"div",17)(4,"div",43),e.nrm(5,"img",44),e.k0s(),e.j41(6,"div",21)(7,"h5",45)(8,"a",46),e.EFF(9),e.k0s()()()()()()()),2&r){const t=l.$implicit;e.R7$(9),e.JRh(t)}}function Le(r,l){1&r&&e.nrm(0,"span",47)}function $e(r,l){if(1&r&&(e.j41(0,"span",48),e.EFF(1),e.k0s()),2&r){const t=e.XpG();e.R7$(),e.SpI("",t.orderDetails.districtName," ")}}function Be(r,l){1&r&&e.nrm(0,"span",49)}function Xe(r,l){if(1&r&&(e.j41(0,"a",50),e.nrm(1,"i",51),e.k0s()),2&r){const t=e.XpG();e.Y8G("href",t.mapUrl(null==t.orderDetails?null:t.orderDetails.map),e.B4B)}}function Ae(r,l){if(1&r&&(e.j41(0,"li",31)(1,"span",52),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.k0s()),2&r){const t=l.$implicit;e.R7$(2),e.JRh(t)}}function Ue(r,l){if(1&r&&(e.j41(0,"li",31)(1,"span",52),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.k0s()),2&r){const t=l.$implicit;e.R7$(2),e.JRh(t)}}let Ye=(()=>{class r{constructor(t){this.alertService=t,this.dismiss=new e.bkB}ngOnChanges(t){console.log(this.orderDetails)}getServices(t){return t.split("#")}copyText(t){navigator.clipboard.writeText(t),this.alertService.info(t)}mapUrl(t){if(!t)return"";const[i,n]=t.split(",").map(Number);return`https://www.google.com/maps/dir//${i},${n}/@${i},${n},17z?hl=en-US`}getTimes(t){return t.split(",")}dismissFn(){this.dismiss.emit(!0)}getNet(t){return console.log(t),null==t||""==t?0:t.split("#")[0]}getTax(t){return console.log(t),null==t||""==t?0:t.split("#")[1]}getTotal(t){return console.log(t),null==t||""==t?0:t.split("#")[2]}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(y.u))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-all-orders-details"]],inputs:{orderDetails:"orderDetails"},outputs:{dismiss:"dismiss"},features:[e.OA$],decls:99,vars:59,consts:[[1,"row"],[1,"col-xl-8"],[1,"card","mb-3"],[1,"card-header"],[1,"d-flex","align-items-center"],[1,"card-title","flex-grow-1","mb-0"],[1,"card-body"],[1,"row","mb-1"],["class","col-12 col-md-6",4,"ngFor","ngForOf"],[1,"table-responsive","table-card","d-flex","justify-content-end","border-top","border-top-dashed"],[1,"table","table-borderless","mb-0",2,"max-width","20rem"],[1,"text-end"],[1,"border-top","border-top-dashed"],["scope","row"],[3,"orderSelected","hideCloseIcon"],[1,"col-xl-4"],[1,"card"],[1,"d-flex"],[1,"list-unstyled","mb-0","vstack","gap-3"],[1,"flex-shrink-0"],["src","assets/images/users/user-dummy-img.jpg","alt","",1,"avatar-sm","rounded"],[1,"flex-grow-1","ms-3"],[1,"fs-14","mb-1"],[1,"text-muted","mb-0"],[1,"ri-phone-line","me-2","align-middle","text-info","fs-16"],[1,"cursor-pointer","badge","bg-info-subtle","text-info","fs-6",3,"click"],[1,"ri-clipboard-line"],[1,"card-title","mb-0"],[1,"ri-map-pin-line","align-middle","me-1","text-muted"],[1,"list-unstyled","vstack","gap-2","fs-13","mb-0"],[1,"fw-medium","fs-14","text-muted"],[1,"text-muted"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.order.nothing",4,"ngIf"],["class","badge bg-success-subtle text-success",4,"ngIf"],["class","badge bg-danger-subtle text-danger mx-1","translate","orderManagement.order.noMap",4,"ngIf"],["target","_blank","class","badge bg-success-subtle text-success mx-1","translate","orderManagement.order.viewMap",3,"href",4,"ngIf"],[1,"ri-history-fill","align-middle","me-1","text-muted"],[1,"card-body","d-flex","card-scroll-xl"],["class","text-muted",4,"ngFor","ngForOf"],[1,"col-xl-12","d-flex","gap-2","justify-content-end"],["type","button","data-bs-dismiss","modal",1,"btn","w-sm","btn-danger","m-3",3,"click"],[1,"col-12","col-md-6"],[1,"card",2,"box-shadow","0 0 6px rgb(56 65 74 / 64%)"],[1,"flex-shrink-0","avatar-md","bg-light","rounded","p-1"],["src","assets/images/products/img-8.png","alt","",1,"img-fluid","d-block"],[1,"fs-15",2,"min-height","38px"],["routerLink","/ecommerce/product-detail/",1,"link-primary"],["translate","orderManagement.order.nothing",1,"badge","bg-danger-subtle","text-danger"],[1,"badge","bg-success-subtle","text-success"],["translate","orderManagement.order.noMap",1,"badge","bg-danger-subtle","text-danger","mx-1"],["target","_blank","translate","orderManagement.order.viewMap",1,"badge","bg-success-subtle","text-success","mx-1",3,"href"],[1,"ri-map-pin-line"],[1,"badge","bg-primary-subtle","text-primary","mx-1"]],template:function(i,n){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h5",5),e.EFF(6),e.k0s()()(),e.j41(7,"div",6)(8,"div",7),e.DNE(9,Ge,10,1,"div",8),e.k0s(),e.j41(10,"div",9)(11,"table",10)(12,"tbody")(13,"tr")(14,"td"),e.EFF(15),e.nI1(16,"translate"),e.k0s(),e.j41(17,"td",11),e.EFF(18),e.k0s()(),e.j41(19,"tr")(20,"td"),e.EFF(21),e.nI1(22,"translate"),e.k0s(),e.j41(23,"td",11),e.EFF(24),e.k0s()(),e.j41(25,"tr",12)(26,"th",13),e.EFF(27),e.nI1(28,"translate"),e.k0s(),e.j41(29,"th",11),e.EFF(30),e.k0s()()()()()()(),e.nrm(31,"order-timeline",14),e.k0s(),e.j41(32,"div",15)(33,"div",16)(34,"div",3)(35,"div",17)(36,"h5",5),e.EFF(37),e.nI1(38,"translate"),e.k0s()()(),e.j41(39,"div",6)(40,"ul",18)(41,"li")(42,"div",4)(43,"div",19),e.nrm(44,"img",20),e.k0s(),e.j41(45,"div",21)(46,"h6",22),e.EFF(47),e.k0s(),e.j41(48,"p",23),e.EFF(49),e.nI1(50,"translate"),e.nI1(51,"date"),e.k0s()()()(),e.j41(52,"li"),e.nrm(53,"i",24),e.j41(54,"span",25),e.bIt("click",function(){return n.copyText(n.orderDetails.mobile)}),e.EFF(55),e.nrm(56,"i",26),e.k0s()()()()(),e.j41(57,"div",16)(58,"div",3)(59,"h5",27),e.nrm(60,"i",28),e.EFF(61),e.nI1(62,"translate"),e.k0s()(),e.j41(63,"div",6)(64,"ul",29)(65,"li",30),e.EFF(66),e.nI1(67,"translate"),e.k0s(),e.j41(68,"li",31),e.EFF(69),e.nI1(70,"translate"),e.DNE(71,Le,1,0,"span",32)(72,$e,2,1,"span",33),e.k0s(),e.j41(73,"li",31),e.EFF(74),e.nI1(75,"translate"),e.DNE(76,Be,1,0,"span",34)(77,Xe,2,1,"a",35),e.k0s()()()(),e.j41(78,"div",16)(79,"div",3)(80,"h5",27),e.nrm(81,"i",36),e.EFF(82),e.nI1(83,"translate"),e.k0s()(),e.j41(84,"div",37)(85,"ul",29)(86,"li",30),e.EFF(87),e.nI1(88,"translate"),e.k0s(),e.DNE(89,Ae,4,1,"li",38),e.k0s(),e.j41(90,"ul",29)(91,"li",30),e.EFF(92),e.nI1(93,"translate"),e.k0s(),e.DNE(94,Ue,4,1,"li",38),e.k0s()()()(),e.j41(95,"div",39)(96,"button",40),e.bIt("click",function(){return n.dismissFn()}),e.EFF(97),e.nI1(98,"translate"),e.k0s()()()),2&i&&(e.R7$(6),e.SpI("#SO#",n.orderDetails.orderCode,""),e.R7$(3),e.Y8G("ngForOf",n.getServices(n.orderDetails.services)),e.R7$(6),e.SpI("",e.bMT(16,30,"orderManagement.order.net")," :"),e.R7$(3),e.JRh(n.getNet(n.orderDetails.totalTaxNet)),e.R7$(3),e.SpI("",e.bMT(22,32,"orderManagement.order.tax")," :"),e.R7$(3),e.JRh(n.getTax(n.orderDetails.totalTaxNet)),e.R7$(3),e.SpI("",e.bMT(28,34,"orderManagement.order.total")," :"),e.R7$(3),e.JRh(n.getTotal(n.orderDetails.totalTaxNet)),e.R7$(),e.Y8G("orderSelected",n.orderDetails)("hideCloseIcon",!0),e.R7$(6),e.JRh(e.bMT(38,36,"orderManagement.order.customerDetails")),e.R7$(10),e.JRh(n.orderDetails.agentName),e.R7$(2),e.Lme(" ",e.bMT(50,38,"orderManagement.order.visitDate")," : ",e.i5U(51,40,n.orderDetails.visitDate,"yyyy-MM-dd")," "),e.R7$(6),e.SpI("",n.orderDetails.mobile," "),e.R7$(6),e.SpI(" ",e.bMT(62,43,"orderManagement.order.customerAddress")," "),e.R7$(5),e.Lme(" ",e.bMT(67,45,"orderManagement.order.cityName"),": ",n.orderDetails.cityName," "),e.R7$(3),e.SpI(" ",e.bMT(70,47,"orderManagement.order.districtName"),": "),e.R7$(2),e.Y8G("ngIf",null==n.orderDetails.districtName),e.R7$(),e.Y8G("ngIf",null!==n.orderDetails.districtName),e.R7$(2),e.SpI(" ",e.bMT(75,49,"orderManagement.order.location"),": "),e.R7$(2),e.Y8G("ngIf",""==n.orderDetails.map),e.R7$(),e.Y8G("ngIf",null==n.orderDetails?null:n.orderDetails.map),e.R7$(5),e.SpI(" ",e.bMT(83,51,"orderManagement.order.workTimes")," "),e.R7$(5),e.SpI(" ",e.bMT(88,53,"orderManagement.order.assignTo"),": "),e.R7$(2),e.Y8G("ngForOf",n.getTimes(n.orderDetails.teamNames)),e.R7$(3),e.SpI(" ",e.bMT(93,55,"orderManagement.order.workTimes"),": "),e.R7$(2),e.Y8G("ngForOf",n.getTimes(n.orderDetails.workTimes)),e.R7$(3),e.SpI(" ",e.bMT(98,57,"general.action.close")," "))},dependencies:[c.Sq,c.bT,f.Wk,g.Mm,ee,c.vh,g.D9],styles:["td[_ngcontent-%COMP%]{padding:3px 4px!important}"]})}}return r})();function Pe(r,l){1&r&&(e.j41(0,"tr",28)(1,"th",29),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",30),e.nrm(4,"i",31),e.EFF(5," orderManagement.order.orderCode "),e.k0s(),e.j41(6,"th",32),e.nrm(7,"i",31),e.EFF(8," orderManagement.order.creation "),e.k0s(),e.j41(9,"th",33),e.nrm(10,"i",31),e.EFF(11," orderManagement.order.cityName "),e.k0s(),e.j41(12,"th",34),e.nrm(13,"i",31),e.EFF(14," orderManagement.order.status "),e.k0s(),e.j41(15,"th",35),e.nrm(16,"i",31),e.EFF(17," orderManagement.order.agentName "),e.k0s(),e.j41(18,"th",36),e.nrm(19,"i",31),e.EFF(20," orderManagement.order.channelName "),e.k0s(),e.j41(21,"th",37),e.EFF(22," orderManagement.order.assignTo "),e.k0s(),e.j41(23,"th",38),e.EFF(24," orderManagement.order.workTimes "),e.k0s(),e.j41(25,"th",39),e.nrm(26,"i",31),e.EFF(27," orderManagement.order.visitDate "),e.k0s(),e.j41(28,"th",40),e.EFF(29," orderManagement.order.services "),e.k0s(),e.nrm(30,"th",41),e.k0s())}function ze(r,l){1&r&&e.nrm(0,"span",54)}function He(r,l){if(1&r&&(e.j41(0,"span",44),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI("",t.districtName," ")}}function Je(r,l){if(1&r&&(e.qex(0),e.j41(1,"span",55),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=l.$implicit;e.R7$(2),e.JRh(t)}}function qe(r,l){if(1&r&&(e.qex(0),e.j41(1,"span",55),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=l.$implicit;e.R7$(2),e.JRh(t)}}function Qe(r,l){if(1&r&&(e.qex(0),e.j41(1,"span",55),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=l.$implicit;e.R7$(2),e.JRh(t)}}function We(r,l){if(1&r){const t=e.RV6();e.j41(0,"button",56),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(),o=e.sdS(53);return e.Njj(a.openEditOrderModal(n.orderCode,o,"xxl"))}),e.nrm(1,"i",57)(2,"span",58),e.k0s()}}function Ke(r,l){if(1&r){const t=e.RV6();e.j41(0,"tr",42)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td",43),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),o=e.sdS(51);return e.Njj(a.openModalClient(n,o,"lg"))}),e.j41(4,"bdi"),e.EFF(5),e.k0s()(),e.j41(6,"td"),e.EFF(7),e.nI1(8,"date"),e.j41(9,"span",44),e.EFF(10),e.k0s()(),e.j41(11,"td"),e.EFF(12),e.DNE(13,ze,1,0,"span",45)(14,He,2,1,"span",46),e.k0s(),e.j41(15,"td")(16,"span"),e.nrm(17,"span",47),e.k0s()(),e.j41(18,"td",43),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),o=e.sdS(49);return e.Njj(a.openModalClient(n,o))}),e.j41(19,"span",48),e.EFF(20),e.k0s(),e.nrm(21,"br"),e.j41(22,"span",49),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.copytext(n.mobile))}),e.EFF(23),e.nrm(24,"i",50),e.k0s()(),e.j41(25,"td"),e.EFF(26),e.k0s(),e.j41(27,"td"),e.DNE(28,Je,4,1,"ng-container",51),e.k0s(),e.j41(29,"td"),e.DNE(30,qe,4,1,"ng-container",51),e.k0s(),e.j41(31,"td"),e.EFF(32),e.nI1(33,"date"),e.k0s(),e.j41(34,"td"),e.DNE(35,Qe,4,1,"ng-container",51),e.k0s(),e.j41(36,"td")(37,"i",52),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),o=e.sdS(55);return e.Njj(a.OpenOrderTimeLineModel(n,o,"lg"))}),e.k0s(),e.DNE(38,We,3,0,"button",53),e.k0s()()}if(2&r){const t=l.$implicit,i=l.rowIndex,n=e.XpG();e.R7$(2),e.JRh(i+1),e.R7$(3),e.SpI("#SO#",t.orderCode,""),e.R7$(2),e.SpI("",e.i5U(8,19,t.createdDate,"yyyy-MM-dd")," "),e.R7$(3),e.SpI("",t.creationUser," "),e.R7$(2),e.SpI("",t.cityName," "),e.R7$(),e.Y8G("ngIf",null==t.districtName),e.R7$(),e.Y8G("ngIf",null!==t.districtName),e.R7$(2),e.ZvI("badge ",n.getStatus(t),""),e.R7$(),e.FS9("translate",n.getTrnslate(t)),e.R7$(3),e.SpI("",t.agentName," "),e.R7$(3),e.SpI("",t.mobile," "),e.R7$(3),e.SpI(" ",t.channelName,""),e.R7$(2),e.Y8G("ngForOf",n.getTimes(t.teamNames)),e.R7$(2),e.Y8G("ngForOf",n.getTimes(t.workTimes)),e.R7$(2),e.SpI(" ",e.i5U(33,22,t.visitDate,"yyyy-MM-dd"),""),e.R7$(3),e.Y8G("ngForOf",n.getServices(t.services)),e.R7$(3),e.Y8G("ngIf",n.checkEdit(t))}}function Ze(r,l){1&r&&(e.j41(0,"div",59),e.EFF(1," general.table.noData "),e.k0s())}function et(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",60)(1,"div",61),e.nrm(2,"ngb-pagination-info",62),e.j41(3,"table-length",63),e.bIt("lengthChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",64)(5,"ngb-pagination",65),e.bIt("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,n)||(a.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function tt(r,l){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",66),e.bIt("deleteConfirm",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.DeleteConfirm())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}}function nt(r,l){1&r&&e.nrm(0,"client-profile-main",67)}function it(r,l){if(1&r){const t=e.RV6();e.j41(0,"app-all-orders-details",68),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderDetails",t.orderSelected)}}function rt(r,l){if(1&r&&e.nrm(0,"order-operation",69),2&r){const t=e.XpG();e.Y8G("isOrderEdit",t.isOrderEdit)("isInner",!0)("orderCode",t.clientSelected)}}function at(r,l){if(1&r){const t=e.RV6();e.j41(0,"order-timeline",70),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderSelected",t.orderSelected)}}let st=(()=>{class r extends G.w{constructor(t,i,n,a,o,s,b,u,j,F,x,T,I){super(t,i,b,n,a,o,s),this.baseService=n,this.authDaamService=u,this.excelService=j,this.cityService=F,this.districtService=x,this.channelService=T,this.router=I,this.title="orderManagement.order.title",this.titleOperation="orderManagement.order.titleOperation",this.keySelected="",this.assignUsers=[],this.times=[],this.employees=[],this.searchForm={},this.isResolveList=!0,this.employeeTypes=[{id:1,name:"employeeTeam"},{id:2,name:"managment"},{id:3,name:"customerService"}],this.employeeGroups=[],this.activeindex="2",this.active=2,this.formPassword={},this.roles=[],this.userTypes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.clientSelected=0,this.cities=[],this.districts=[],this.channels=[],this.countLoad=2,this.isOrderEdit=!1,this.orderSelected={},this.configRoute(),this.GetCities(),this.GetChannels()}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetDistricts(t){this.districtService.getByCityId(t).subscribe(i=>{this.districts=i.data},i=>{console.log(i)})}GetChannels(){this.channelService.getDropDown().subscribe(t=>{this.channels=t.data},t=>{console.log(t)})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,h.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){var t;if(this.ngxLoader.startLoader(_.a7),console.log(this.searchForm),null!=(t=this.searchForm.dates)&&"to"in t){const i=[t.from,t.to].map(n=>n);this.pagination.visitDateFrom=this.datePipe.transform(i[0],"yyyy-MM-ddT00:00:00"),this.pagination.visitDateTo=this.datePipe.transform(i[1],"yyyy-MM-ddT23:59:59.999")}else this.pagination.visitDateFrom=null,this.pagination.visitDateTo=null;if(null!=(t=this.searchForm.creationDates)&&"to"in t){const i=[t.from,t.to].map(n=>n);this.pagination.creationDateFrom=this.datePipe.transform(i[0],"yyyy-MM-ddT00:00:00"),this.pagination.creationDateTo=this.datePipe.transform(i[1],"yyyy-MM-ddT23:59:59.999")}else this.pagination.creationDateFrom=null,this.pagination.creationDateTo=null;this.pagination.subject=this.searchForm.name,null!=this.searchForm.status&&(this.pagination.status=Number.parseInt(this.searchForm.status)),null!=this.searchForm.priority&&(this.pagination.priority=Number.parseInt(this.searchForm.priority)),this.loadentities()}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}configRoute(){this.routerActive.data.pipe((0,h.Q)(this.notifier)).subscribe(t=>{this.entities=t.data,this.pagination.totalItems=t.data?.totalItems},()=>{this.alertService.error()})}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({"Order Code":i.orderCode,"Created Date":i.createdDate,"City Name":i.cityName,"District Name":i.districtName?i.districtName:"--",Status:this.translateService.instant(this.getTrnslate(i)),"Agent Name":i.agentName,Mobile:i.mobile,"Channel Name":i.channelName,"Assigned To":i.teamNames,Times:i.workTimes,"Visit Date":i.visitDate,Services:i.services})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}goRegister(){this.router.navigateByUrl("/managment/order/new")}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return t.isCancel?"bg-warning-subtle text-warning":t.isFinish?"bg-success-subtle text-success":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen||t.isFree?"bg-warning-subtle text-warning":"bg-success-subtle text-success"}checkEdit(t){return!t.isCancel&&!t.isFinish}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isFree?"orderManagement.order.free":"orderManagement.order.new"}openModalClient(t,i,n="xl"){this.clientSelected=t.orderCode,this.orderSelected=t,this.isOrderEdit=!1,this.modalService.open(i,{centered:!0,size:n})}oncityChange(t){this.GetDistricts(t.code)}getTimes(t){return t?.split(",")}getServices(t){return t.split("#")}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}openEditOrderModal(t,i,n="md"){this.form={},this.isOrderEdit=!0,this.clientSelected=t,this.modalService.open(i,{centered:!0,size:n})}OpenOrderTimeLineModel(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(f.nX),e.rXU(g.c$),e.rXU(q.Q),e.rXU(y.u),e.rXU(c.vh),e.rXU(v.eD),e.rXU(m.Bq),e.rXU(A.J),e.rXU(L.V),e.rXU(z.h),e.rXU(H.m),e.rXU(J.l),e.rXU(f.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-all-order"]],features:[e.Vt3],decls:56,vars:51,consts:[["tableMaster",""],["deleteModal",""],["clientProfile",""],["orderViewModel",""],["orderModel",""],["OrderTimeLineModel",""],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],[3,"reset","search","exportXlsx","addNew","showAdd","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","agentName","name","agentName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","code","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","name","bindValue","code","bindLabel","name",3,"change","ngModelChange","placeholder","items","multiple","ngModel"],["name","employeeCode","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],[1,"col-12","col-md-4","mb-2"],["type","text","mwlFlatpickr","","id","isDate","mode","range",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["translate","",2,"width",".5%"],["pSortableColumn","orderCode","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","creationDate","translate","",2,"width","13%"],["pSortableColumn","cityId","translate","",2,"width","10%"],["pSortableColumn","status","translate","",2,"width","6%"],["pSortableColumn","agentName","translate","",2,"width","12%"],["pSortableColumn","channelName","translate","",2,"width","7%"],["pSortableColumn","assignTo","translate","",2,"width","8%"],["pSortableColumn","workTimes","translate","",2,"width","8%"],["pSortableColumn","visitDate","translate","",2,"width","8%"],["translate","",2,"width","10%"],["translate","",2,"width","25%"],[1,"fs-5"],[3,"click"],[1,"badge","bg-success-subtle","text-success"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.order.nothing",4,"ngIf"],["class","badge bg-success-subtle text-success",4,"ngIf"],[3,"translate"],[1,"badge","bg-primary-subtle","text-primary","my-1"],[1,"cursor-pointer","badge","bg-danger-subtle","text-danger","fs-6",3,"click"],[1,"ri-clipboard-line"],[4,"ngFor","ngForOf"],[1,"ri-history-fill","d-inline","text-primary","fs-16","align-middle","me-1",3,"click"],["type","button","class","btn px-4 w-auto btn-sm btn-primary btn-label  waves-effect waves-light rounded-pill",3,"click",4,"ngIf"],["translate","orderManagement.order.nothing",1,"badge","bg-danger-subtle","text-danger"],[1,"badge","bg-primary-subtle","text-primary","mx-1"],["type","button",1,"btn","px-4","w-auto","btn-sm","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"click"],[1,"ri-edit-2-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.edit"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"deleteConfirm","dismiss"],["","clientSelected"],[3,"dismiss","orderDetails"],[3,"isOrderEdit","isInner","orderCode"],[3,"dismiss","orderSelected"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",6)(1,"div",7)(2,"div",8)(3,"base-filter",9),e.bIt("reset",function(){return e.eBV(a),e.Njj(n.onReset())})("search",function(){return e.eBV(a),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(n.onExportXlsx())})("addNew",function(){return e.eBV(a),e.Njj(n.goRegister())}),e.qex(4,10),e.j41(5,"div",11)(6,"div",12)(7,"input",13),e.nI1(8,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.orderCode,s)||(n.pagination.orderCode=s),e.Njj(s)}),e.k0s(),e.nrm(9,"i",14),e.k0s()(),e.j41(10,"div",11)(11,"div",12)(12,"input",15),e.nI1(13,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.agentName,s)||(n.pagination.agentName=s),e.Njj(s)}),e.k0s(),e.nrm(14,"i",14),e.k0s()(),e.j41(15,"div",11)(16,"div",12)(17,"input",13),e.nI1(18,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.mobile,s)||(n.pagination.mobile=s),e.Njj(s)}),e.k0s(),e.nrm(19,"i",14),e.k0s()(),e.j41(20,"div",11)(21,"div",12)(22,"ng-select",16),e.nI1(23,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.channelCode,s)||(n.pagination.channelCode=s),e.Njj(s)}),e.k0s()()(),e.j41(24,"div",11)(25,"div",12)(26,"ng-select",17),e.nI1(27,"translate"),e.bIt("change",function(s){return e.eBV(a),e.Njj(n.oncityChange(s))}),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.cityCode,s)||(n.pagination.cityCode=s),e.Njj(s)}),e.k0s()()(),e.j41(28,"div",11)(29,"div",12)(30,"ng-select",18),e.nI1(31,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.districtName,s)||(n.pagination.districtName=s),e.Njj(s)}),e.k0s()()(),e.j41(32,"div",19)(33,"input",20),e.nI1(34,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.dates,s)||(n.searchForm.dates=s),e.Njj(s)}),e.k0s()(),e.j41(35,"div",19)(36,"input",20),e.nI1(37,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.creationDates,s)||(n.searchForm.creationDates=s),e.Njj(s)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(38,"div",21)(39,"div",22)(40,"p-table",23,0),e.bIt("onLazyLoad",function(s){return e.eBV(a),e.Njj(n.tableChange(s))})("selectionChange",function(s){return e.eBV(a),e.Njj(n.onSelectionChange(s))}),e.DNE(42,Pe,31,0,"ng-template",24)(43,Ke,39,25,"ng-template",25),e.k0s()(),e.DNE(44,Ze,2,0,"div",26)(45,et,6,8,"div",27),e.k0s()()()(),e.DNE(46,tt,1,0,"ng-template",null,1,e.C5r)(48,nt,1,0,"ng-template",null,2,e.C5r)(50,it,1,1,"ng-template",null,3,e.C5r)(52,rt,1,3,"ng-template",null,4,e.C5r)(54,at,1,1,"ng-template",null,5,e.C5r)}2&i&&(e.R7$(3),e.Y8G("showAdd",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(8,35,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.orderCode),e.R7$(5),e.FS9("placeholder",e.bMT(13,37,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.agentName),e.R7$(5),e.FS9("placeholder",e.bMT(18,39,"orderManagement.order.mobile")),e.R50("ngModel",n.pagination.mobile),e.R7$(5),e.FS9("placeholder",e.bMT(23,41,"orderManagement.order.channelName")),e.Y8G("items",n.channels)("multiple",!1),e.R50("ngModel",n.pagination.channelCode),e.R7$(4),e.FS9("placeholder",e.bMT(27,43,"orderManagement.order.cityName")),e.Y8G("items",n.cities)("multiple",!1),e.R50("ngModel",n.pagination.cityCode),e.R7$(4),e.FS9("placeholder",e.bMT(31,45,"orderManagement.order.districtName")),e.Y8G("items",n.districts)("multiple",!1),e.R50("ngModel",n.pagination.districtName),e.R7$(3),e.FS9("placeholder",e.bMT(34,47,"orderManagement.order.visitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.dates),e.R7$(3),e.FS9("placeholder",e.bMT(37,49,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[c.Sq,c.bT,d.me,d.Q0,d.BC,d.vS,m.s5,R.kL,$.b,Z.L,ae.w,U.p,Y.g,g.Mm,C.XI,P.Ei,C.Tg,V.vr,B.m,ee,Ye,c.vh,g.D9],encapsulation:2})}}return r})();var N=p(70980),D=p(37021),O=p(35335),w=p(45236),te=function(r){return r[r.None=0]="None",r[r.Reviewed=1]="Reviewed",r[r.Confirmed=2]="Confirmed",r[r.Free=3]="Free",r[r.Reopened=4]="Reopened",r[r.Finished=5]="Finished",r[r.Canceled=6]="Canceled",r[r.Assigned=7]="Assigned",r[r.Urgent=8]="Urgent",r[r.New=9]="New",r}(te||{}),se=p(91020),K=p(38542),xe=p(21413);let _e=(()=>{class r{constructor(t,i,n,a){this.cancelReasonService=t,this.orderService=i,this.ngxLoader=n,this.alertService=a,this.cancelReasons=[],this.form={},this.orderId=0,this.loaderOperationShap=_.$$,this.operationLoader=_.ZW,this.notifier=new xe.B,this.success=new e.bkB,this.dismiss=new e.bkB}ngOnInit(){this.GetReturnReasons()}GetReturnReasons(){this.cancelReasonService.getDropDown().subscribe(t=>{this.cancelReasons=t.data},t=>{console.log(t)})}onCancelOrder(){let t={cancelReasonCode:this.form.cancelReasonCode,orderId:this.orderId};this.ngxLoader.startLoader(this.operationLoader),this.orderService.CancelOrder(t).pipe((0,h.Q)(this.notifier)).subscribe(i=>{this.ngxLoader.stopLoader(this.operationLoader),i.success?(this.alertService.success(),this.success.emit(!0),this.dismiss.emit(!0)):this.alertService.error()},()=>{this.alertService.error(),this.ngxLoader.stopLoader(this.operationLoader)})}dismissFn(){this.dismiss.emit(!0)}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(se.e),e.rXU(q.Q),e.rXU(v.eD),e.rXU(y.u))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["cancel-order-model"]],inputs:{orderId:"orderId"},outputs:{success:"success",dismiss:"dismiss"},decls:19,vars:10,consts:[["formEntity","ngForm"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["translate","orderManagement.order.cancelReasonName",1,"fw-bold","fs-4"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"ngSubmit"],[1,"row"],[1,"mb-3"],["for","actionMismatch","translate","",1,"required","fw-bold","form-label"],["name","name","bindValue","code","bindLabel","name","required","",3,"ngModelChange","placeholder","items","multiple","ngModel"],[1,"text-center"],["type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"h4",3),e.nrm(3,"span",4),e.k0s(),e.j41(4,"button",5),e.bIt("click",function(){return e.eBV(a),e.Njj(n.dismissFn())}),e.k0s()(),e.j41(5,"div",6),e.nrm(6,"ngx-ui-loader",7),e.j41(7,"form",8,0),e.bIt("ngSubmit",function(){return e.eBV(a),e.Njj(n.onCancelOrder())}),e.j41(9,"div",9)(10,"div",10)(11,"label",11),e.EFF(12,"orderManagement.order.cancelReasonName"),e.k0s(),e.j41(13,"ng-select",12),e.nI1(14,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.form.cancelReasonCode,s)||(n.form.cancelReasonCode=s),e.Njj(s)}),e.k0s()()(),e.j41(15,"div",13)(16,"button",14),e.nrm(17,"i",15)(18,"span",16),e.k0s()()()()()}if(2&i){const a=e.sdS(8);e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",n.loaderOperationShap)("loaderId",n.operationLoader),e.R7$(7),e.FS9("placeholder",e.bMT(14,8,"orderManagement.order.cancelReasonName")),e.Y8G("items",n.cancelReasons)("multiple",!1),e.R50("ngModel",n.form.cancelReasonCode),e.R7$(3),e.Y8G("disabled",!a.valid)}},dependencies:[d.qT,d.BC,d.cb,d.YS,d.vS,d.cV,g.Mm,v.Cv,V.vr,g.D9],encapsulation:2})}}return r})();const ot=()=>["newOrder.edit"],lt=()=>["newOrder.confirmed"],dt=()=>["newOrder.cancel"];function mt(r,l){1&r&&(e.j41(0,"tr",29)(1,"th",30),e.nrm(2,"i",31),e.EFF(3," orderManagement.order.orderCode "),e.k0s(),e.j41(4,"th",32),e.nrm(5,"i",31),e.EFF(6," orderManagement.order.createdDate "),e.k0s(),e.j41(7,"th",33),e.nrm(8,"i",31),e.EFF(9," orderManagement.order.creationUser "),e.k0s(),e.j41(10,"th",34),e.nrm(11,"i",31),e.EFF(12," orderManagement.order.cityName "),e.k0s(),e.j41(13,"th",35),e.nrm(14,"i",31),e.EFF(15," orderManagement.order.agentName "),e.k0s(),e.j41(16,"th",36),e.EFF(17," orderManagement.order.assignTo "),e.k0s(),e.j41(18,"th",37),e.EFF(19," orderManagement.order.workTimes "),e.k0s(),e.j41(20,"th",38),e.nrm(21,"i",31),e.EFF(22," orderManagement.order.visitDate "),e.k0s(),e.j41(23,"th",39),e.EFF(24," orderManagement.order.services "),e.k0s(),e.nrm(25,"th",40),e.k0s())}function ct(r,l){1&r&&e.nrm(0,"span",53)}function pt(r,l){if(1&r&&(e.j41(0,"span",54),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI("",t.districtName," ")}}function gt(r,l){if(1&r&&(e.qex(0),e.j41(1,"span",55),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=l.$implicit;e.R7$(2),e.JRh(t)}}function _t(r,l){if(1&r&&(e.qex(0),e.j41(1,"span",55),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=l.$implicit;e.R7$(2),e.JRh(t)}}function ht(r,l){if(1&r&&(e.qex(0),e.j41(1,"span",55),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=l.$implicit;e.R7$(2),e.JRh(t)}}function ut(r,l){if(1&r){const t=e.RV6();e.j41(0,"button",56),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(),o=e.sdS(52);return e.Njj(a.openEditOrderModal(n.orderCode,o,"xxl"))}),e.nrm(2,"i",57),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"orderManagement.order.editOrders"))}function bt(r,l){if(1&r){const t=e.RV6();e.j41(0,"button",58),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(),o=e.sdS(48);return e.Njj(a.openModal(n.orderCode,o))}),e.nrm(2,"i",59),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"orderManagement.order.confirmOrder"))}function ft(r,l){if(1&r){const t=e.RV6();e.j41(0,"button",60),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(),o=e.sdS(50);return e.Njj(a.openModal(n.orderCode,o))}),e.nrm(2,"i",61),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"orderManagement.order.cancelOrder"))}function vt(r,l){if(1&r){const t=e.RV6();e.j41(0,"tr",41)(1,"td",42),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),o=e.sdS(52);return e.Njj(a.openModal(n.orderCode,o,"xxl"))}),e.j41(2,"bdi"),e.EFF(3),e.k0s()(),e.j41(4,"td"),e.EFF(5),e.nI1(6,"date"),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td"),e.EFF(10),e.DNE(11,ct,1,0,"span",43)(12,pt,2,1,"span",44),e.k0s(),e.j41(13,"td")(14,"span",45),e.EFF(15),e.k0s(),e.nrm(16,"br"),e.j41(17,"span",46),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.copytext(n.mobile))}),e.EFF(18),e.nrm(19,"i",47),e.k0s()(),e.j41(20,"td"),e.DNE(21,gt,4,1,"ng-container",48),e.k0s(),e.j41(22,"td"),e.DNE(23,_t,4,1,"ng-container",48),e.k0s(),e.j41(24,"td"),e.EFF(25),e.nI1(26,"date"),e.k0s(),e.j41(27,"td"),e.DNE(28,ht,4,1,"ng-container",48),e.k0s(),e.j41(29,"td")(30,"div",49),e.DNE(31,ut,3,3,"button",50)(32,bt,3,3,"button",51)(33,ft,3,3,"button",52),e.k0s()()()}if(2&r){const t=l.$implicit,i=e.XpG();e.R7$(3),e.SpI("#SO#",t.orderCode,""),e.R7$(2),e.JRh(e.i5U(6,15,t.createdDate,"yyyy-MM-dd")),e.R7$(3),e.JRh(t.creationUser),e.R7$(2),e.SpI("",t.cityName," "),e.R7$(),e.Y8G("ngIf",null==t.districtName),e.R7$(),e.Y8G("ngIf",null!==t.districtName),e.R7$(3),e.SpI("",t.agentName," "),e.R7$(3),e.SpI("",t.mobile," "),e.R7$(3),e.Y8G("ngForOf",i.getTimes(t.teamNames)),e.R7$(2),e.Y8G("ngForOf",i.getTimes(t.workTimes)),e.R7$(2),e.SpI(" ",e.i5U(26,18,t.visitDate,"yyyy-MM-dd"),""),e.R7$(3),e.Y8G("ngForOf",i.getServices(t.services)),e.R7$(3),e.Y8G("hasPermission",e.lJ4(21,ot)),e.R7$(),e.Y8G("hasPermission",e.lJ4(22,lt)),e.R7$(),e.Y8G("hasPermission",e.lJ4(23,dt))}}function Ct(r,l){1&r&&(e.j41(0,"div",62),e.EFF(1," general.table.noData "),e.k0s())}function jt(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",63)(1,"div",64),e.nrm(2,"ngb-pagination-info",65),e.j41(3,"table-length",66),e.bIt("lengthChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",67)(5,"ngb-pagination",68),e.bIt("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,n)||(a.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function Ft(r,l){if(1&r){const t=e.RV6();e.j41(0,"form",69,5),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.SubmitOrder())}),e.nrm(2,"ngx-ui-loader",70),e.j41(3,"div",71)(4,"div",72)(5,"button",73),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",74)(7,"div",75),e.nrm(8,"lord-icon",76),e.j41(9,"div",77),e.nrm(10,"h3",78)(11,"p",79),e.k0s()(),e.j41(12,"div",80),e.nrm(13,"button",81),e.j41(14,"button",82),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}function Mt(r,l){if(1&r){const t=e.RV6();e.j41(0,"cancel-order-model",83),e.bIt("success",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.loadentities())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderId",t.orderSelected)}}function xt(r,l){if(1&r&&e.nrm(0,"order-operation",84),2&r){const t=e.XpG();e.Y8G("isOrderEdit",t.isOrderEdit)("isInner",!0)("orderCode",t.orderSelected)}}function Tt(r,l){if(1&r){const t=e.RV6();e.j41(0,"order-timeline",85),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderSelected",t.orderSelected)}}let St=(()=>{class r extends G.w{constructor(t,i,n,a,o,s,b,u,j,F,x,T,I,X){super(t,i,b,n,a,o,s),this.baseService=n,this.authDaamService=u,this.excelService=j,this.cityService=F,this.districtService=x,this.channelService=T,this.router=I,this.cancelReasonService=X,this.title="orderManagement.order.newOrders.title",this.titleOperation="orderManagement.order.newOrders.titleOperation",this.language=localStorage.getItem("language"),this.keySelected="",this.assignUsers=[],this.times=[],this.employees=[],this.searchForm={},this.isResolveList=!0,this.employeeTypes=[{id:1,name:"employeeTeam"},{id:2,name:"managment"},{id:3,name:"customerService"}],this.employeeGroups=[],this.activeindex="1",this.active=1,this.formPassword={},this.roles=[],this.userTypes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.OrderStatusEnum=te,this.countLoad=2,this.orderSelected=0,this.cities=[],this.districts=[],this.channels=[],this.cancelReasons=[],this.isOrderEdit=!1,this.GetCities(),this.GetChannels()}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetDistricts(t){this.districtService.getByCityId(t).subscribe(i=>{this.districts=i.data},i=>{console.log(i)})}GetChannels(){this.channelService.getDropDown().subscribe(t=>{this.channels=t.data},t=>{console.log(t)})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,h.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){var t;if(this.ngxLoader.startLoader(_.a7),console.log(this.searchForm),null!=(t=this.searchForm.dates)&&"to"in t){const i=[t.from,t.to].map(n=>n);this.pagination.visitDateFrom=this.datePipe.transform(i[0],"yyyy-MM-ddT00:00:00"),this.pagination.visitDateTo=this.datePipe.transform(i[1],"yyyy-MM-ddT23:59:59.999")}else this.pagination.visitDateFrom=null,this.pagination.visitDateTo=null;if(null!=(t=this.searchForm.creationDates)&&"to"in t){const i=[t.from,t.to].map(n=>n);this.pagination.creationDateFrom=this.datePipe.transform(i[0],"yyyy-MM-ddT00:00:00"),this.pagination.creationDateTo=this.datePipe.transform(i[1],"yyyy-MM-ddT23:59:59.999")}else this.pagination.creationDateFrom=null,this.pagination.creationDateTo=null;this.pagination.subject=this.searchForm.name,null!=this.searchForm.status&&(this.pagination.status=Number.parseInt(this.searchForm.status)),null!=this.searchForm.priority&&(this.pagination.priority=Number.parseInt(this.searchForm.priority)),this.loadentities()}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}loadentities(){this.countLoad=this.countLoad+1,this.pagination.statusFilter=this.OrderStatusEnum.New,(!this.isResolveList||1!==this.countLoad)&&(this.ngxLoader.startLoader("newOrder"),this.baseService.get(this.pagination).pipe((0,h.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader("newOrder"),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader("newOrder"),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({"Order Code":i.orderCode,"Created Date":i.createdDate,"City Name":i.cityName,"District Name":i.districtName?i.districtName:"--","Agent Name":i.agentName,Mobile:i.mobile,"Assigned To":i.teamNames,Times:i.workTimes,"Visit Date":i.visitDate,Services:i.services})}),t}SubmitOrder(){this.ngxLoader.startLoader(_.Fq),this.baseService.SubmitOrder(this.orderSelected).pipe((0,D.O)(),(0,O.c)(this.mainDelay),(0,w.Z)(),(0,h.Q)(this.notifier),(0,N.j)(()=>this.ngxLoader.stopLoader(_.Fq))).subscribe({next:t=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}goRegister(){this.router.navigateByUrl("/managment/order/new")}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return t.isCancel?"bg-warning-subtle text-warning":t.isFinish?"bg-success-subtle text-success":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen||t.isFree?"bg-warning-subtle text-warning":"bg-success-subtle text-success"}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isFree?"orderManagement.order.free":"orderManagement.order.finished"}openModal(t,i,n="md"){this.isOrderEdit=!1,this.form={},this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}openEditOrderModal(t,i,n="md"){this.form={},this.isOrderEdit=!0,this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}oncityChange(t){this.GetDistricts(t.code)}getTimes(t){return t.split(",")}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}getServices(t){return t.split("#")}OpenOrderTimeLineModel(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(f.nX),e.rXU(g.c$),e.rXU(q.Q),e.rXU(y.u),e.rXU(c.vh),e.rXU(v.eD),e.rXU(m.Bq),e.rXU(A.J),e.rXU(L.V),e.rXU(z.h),e.rXU(H.m),e.rXU(J.l),e.rXU(f.Ix),e.rXU(se.e))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-new-orders"]],features:[e.Vt3],decls:55,vars:52,consts:[["tableMaster",""],["SubmitOrderModal",""],["deleteModal",""],["orderModel",""],["OrderTimeLineModel",""],["formEntity","ngForm"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"reset","search","exportXlsx","addNew","showAdd","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","agentName","name","agentName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","code","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","name","bindValue","code","bindLabel","name",3,"change","ngModelChange","placeholder","items","multiple","ngModel"],["name","employeeCode","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],[1,"col-12","col-md-4","mb-2"],["type","text","mwlFlatpickr","","id","isDate","mode","range",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["pSortableColumn","orderCode","translate","",2,"width","5%"],[1,"ri-expand-up-down-line"],["pSortableColumn","createdDate","translate","",2,"width","8%"],["pSortableColumn","creationUser","translate","",2,"width","10%"],["pSortableColumn","cityId","translate","",2,"width","8%"],["pSortableColumn","agentName","translate","",2,"width","5%"],["translate","",2,"width","8%"],["translate","",2,"width","5%"],["pSortableColumn","visitDate","translate","",2,"width","7%"],["translate","",2,"width","10%"],[2,"width","10%"],[1,"fs-5"],[3,"click"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.order.nothing",4,"ngIf"],["class","badge bg-success-subtle text-success",4,"ngIf"],[1,"badge","bg-primary-subtle","text-primary","my-1"],[1,"cursor-pointer","badge","bg-danger-subtle","text-danger","fs-6",3,"click"],[1,"ri-clipboard-line"],[4,"ngFor","ngForOf"],[1,"d-inline"],["tooltipPosition","top","class","btn btn-sm btn-soft-info edit-list ",3,"pTooltip","click",4,"hasPermission"],["class","btn btn-sm btn-success edit-list mx-1","tooltipPosition","top",3,"pTooltip","click",4,"hasPermission"],["tooltipPosition","top","class","btn btn-sm btn-soft-danger remove-list  ",3,"pTooltip","click",4,"hasPermission"],["translate","orderManagement.order.nothing",1,"badge","bg-danger-subtle","text-danger"],[1,"badge","bg-success-subtle","text-success"],[1,"badge","bg-primary-subtle","text-primary","mx-1"],["tooltipPosition","top",1,"btn","btn-sm","btn-soft-info","edit-list",3,"click","pTooltip"],[1,"ri-pencil-fill","align-bottom"],["tooltipPosition","top",1,"btn","btn-sm","btn-success","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-check-fill","align-bottom"],["tooltipPosition","top",1,"btn","btn-sm","btn-soft-danger","remove-list",3,"click","pTooltip"],[1,"ri-delete-bin-5-fill","align-bottom"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"ngSubmit"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],[3,"success","dismiss","orderId"],[3,"isOrderEdit","isInner","orderCode"],[3,"dismiss","orderSelected"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",6)(1,"div",7)(2,"div",8),e.nrm(3,"ngx-ui-loader",9),e.j41(4,"base-filter",10),e.bIt("reset",function(){return e.eBV(a),e.Njj(n.onReset())})("search",function(){return e.eBV(a),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(n.onExportXlsx())})("addNew",function(){return e.eBV(a),e.Njj(n.goRegister())}),e.qex(5,11),e.j41(6,"div",12)(7,"div",13)(8,"input",14),e.nI1(9,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.orderCode,s)||(n.pagination.orderCode=s),e.Njj(s)}),e.k0s(),e.nrm(10,"i",15),e.k0s()(),e.j41(11,"div",12)(12,"div",13)(13,"input",16),e.nI1(14,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.agentName,s)||(n.pagination.agentName=s),e.Njj(s)}),e.k0s(),e.nrm(15,"i",15),e.k0s()(),e.j41(16,"div",12)(17,"div",13)(18,"input",14),e.nI1(19,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.mobile,s)||(n.pagination.mobile=s),e.Njj(s)}),e.k0s(),e.nrm(20,"i",15),e.k0s()(),e.j41(21,"div",12)(22,"div",13)(23,"ng-select",17),e.nI1(24,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.channelCode,s)||(n.pagination.channelCode=s),e.Njj(s)}),e.k0s()()(),e.j41(25,"div",12)(26,"div",13)(27,"ng-select",18),e.nI1(28,"translate"),e.bIt("change",function(s){return e.eBV(a),e.Njj(n.oncityChange(s))}),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.cityCode,s)||(n.pagination.cityCode=s),e.Njj(s)}),e.k0s()()(),e.j41(29,"div",12)(30,"div",13)(31,"ng-select",19),e.nI1(32,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.districtName,s)||(n.pagination.districtName=s),e.Njj(s)}),e.k0s()()(),e.j41(33,"div",20)(34,"input",21),e.nI1(35,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.creationDates,s)||(n.searchForm.creationDates=s),e.Njj(s)}),e.k0s()(),e.j41(36,"div",20)(37,"input",21),e.nI1(38,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.dates,s)||(n.searchForm.dates=s),e.Njj(s)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(39,"div",22)(40,"div",23)(41,"p-table",24,0),e.bIt("onLazyLoad",function(s){return e.eBV(a),e.Njj(n.tableChange(s))})("selectionChange",function(s){return e.eBV(a),e.Njj(n.onSelectionChange(s))}),e.DNE(43,mt,26,0,"ng-template",25)(44,vt,34,24,"ng-template",26),e.k0s()(),e.DNE(45,Ct,2,0,"div",27)(46,jt,6,8,"div",28),e.k0s()()()(),e.DNE(47,Ft,15,3,"ng-template",null,1,e.C5r)(49,Mt,1,1,"ng-template",null,2,e.C5r)(51,xt,1,3,"ng-template",null,3,e.C5r)(53,Tt,1,1,"ng-template",null,4,e.C5r)}2&i&&(e.R7$(3),e.Y8G("loaderId","newOrder"),e.R7$(),e.Y8G("showAdd",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,36,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.orderCode),e.R7$(5),e.FS9("placeholder",e.bMT(14,38,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.agentName),e.R7$(5),e.FS9("placeholder",e.bMT(19,40,"orderManagement.order.mobile")),e.R50("ngModel",n.pagination.mobile),e.R7$(5),e.FS9("placeholder",e.bMT(24,42,"orderManagement.order.channelName")),e.Y8G("items",n.channels)("multiple",!1),e.R50("ngModel",n.pagination.channelCode),e.R7$(4),e.FS9("placeholder",e.bMT(28,44,"orderManagement.order.cityName")),e.Y8G("items",n.cities)("multiple",!1),e.R50("ngModel",n.pagination.cityCode),e.R7$(4),e.FS9("placeholder",e.bMT(32,46,"orderManagement.order.districtName")),e.Y8G("items",n.districts)("multiple",!1),e.R50("ngModel",n.pagination.districtName),e.R7$(3),e.FS9("placeholder",e.bMT(35,48,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(3),e.FS9("placeholder",e.bMT(38,50,"orderManagement.order.visitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.dates),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[c.Sq,c.bT,d.qT,d.me,d.Q0,d.BC,d.cb,d.vS,d.cV,m.s5,R.kL,$.b,Z.L,U.p,Y.g,g.Mm,C.XI,P.Ei,C.Tg,v.Cv,V.vr,B.m,ne.p,K.m,_e,ee,c.vh,g.D9],encapsulation:2})}}return r})();const It=()=>["urgented.assignTeam"],kt=()=>["urgented.edit"],yt=()=>["urgented.cancel"];function Rt(r,l){1&r&&(e.j41(0,"tr",30)(1,"th",31),e.nrm(2,"i",32),e.EFF(3," orderManagement.order.orderCode "),e.k0s(),e.j41(4,"th",33),e.nrm(5,"i",32),e.EFF(6," orderManagement.order.createdDate "),e.k0s(),e.j41(7,"th",34),e.nrm(8,"i",32),e.EFF(9," orderManagement.order.creationUser "),e.k0s(),e.j41(10,"th",35),e.nrm(11,"i",32),e.EFF(12," orderManagement.order.cityName "),e.k0s(),e.j41(13,"th",36),e.nrm(14,"i",32),e.EFF(15," orderManagement.order.agentName "),e.k0s(),e.j41(16,"th",37),e.EFF(17," orderManagement.order.assignTo "),e.k0s(),e.j41(18,"th",37),e.EFF(19," orderManagement.order.workTimes "),e.k0s(),e.j41(20,"th",37),e.EFF(21," orderManagement.order.visitDate "),e.k0s(),e.j41(22,"th",38),e.EFF(23," orderManagement.order.location "),e.k0s(),e.nrm(24,"th",39),e.k0s())}function Et(r,l){1&r&&e.nrm(0,"span",54)}function Nt(r,l){if(1&r&&(e.j41(0,"span",55),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI("",t.districtName," ")}}function Dt(r,l){if(1&r&&(e.qex(0),e.j41(1,"span",56),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=l.$implicit;e.R7$(2),e.JRh(t)}}function Ot(r,l){if(1&r&&(e.qex(0),e.j41(1,"span",56),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=l.$implicit;e.R7$(2),e.JRh(t)}}function wt(r,l){1&r&&e.nrm(0,"span",57)}function Vt(r,l){if(1&r&&(e.j41(0,"a",58),e.nrm(1,"i",59),e.k0s()),2&r){const t=e.XpG().$implicit,i=e.XpG();e.Y8G("href",i.mapUrl(null==t?null:t.map),e.B4B)}}function Gt(r,l){if(1&r){const t=e.RV6();e.j41(0,"button",60),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(),o=e.sdS(50);return e.Njj(a.openAssignOrderModalModal(n,o,"lg"))}),e.nrm(2,"i",61),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"orderManagement.order.confirmOrder"))}function Lt(r,l){if(1&r){const t=e.RV6();e.j41(0,"button",62),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(),o=e.sdS(54);return e.Njj(a.openEditOrderModal(n.orderCode,o,"xxl"))}),e.nrm(2,"i",63),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"orderManagement.order.orderEdit"))}function $t(r,l){if(1&r){const t=e.RV6();e.j41(0,"button",64),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(),o=e.sdS(48);return e.Njj(a.openModal(n.orderCode,o))}),e.nrm(2,"i",65),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"orderManagement.order.cancelOrder"))}function Bt(r,l){if(1&r){const t=e.RV6();e.j41(0,"tr",40)(1,"td",41),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),o=e.sdS(54);return e.Njj(a.openModal(n.orderCode,o,"xxl"))}),e.j41(2,"bdi"),e.EFF(3),e.k0s()(),e.j41(4,"td"),e.EFF(5),e.nI1(6,"date"),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td"),e.EFF(10),e.DNE(11,Et,1,0,"span",42)(12,Nt,2,1,"span",43),e.k0s(),e.j41(13,"td")(14,"span",44),e.EFF(15),e.k0s(),e.nrm(16,"br"),e.j41(17,"span",45),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.copytext(n.mobile))}),e.EFF(18),e.nrm(19,"i",46),e.k0s()(),e.j41(20,"td"),e.DNE(21,Dt,4,1,"ng-container",47),e.k0s(),e.j41(22,"td"),e.DNE(23,Ot,4,1,"ng-container",47),e.k0s(),e.j41(24,"td"),e.EFF(25),e.nI1(26,"date"),e.k0s(),e.j41(27,"td"),e.DNE(28,wt,1,0,"span",48)(29,Vt,2,1,"a",49),e.k0s(),e.j41(30,"td")(31,"div",50),e.DNE(32,Gt,3,3,"button",51)(33,Lt,3,3,"button",52)(34,$t,3,3,"button",53),e.k0s()()()}if(2&r){const t=l.$implicit,i=e.XpG();e.R7$(3),e.SpI("#SO#",t.orderCode,""),e.R7$(2),e.JRh(e.i5U(6,16,t.createdDate,"yyyy-MM-dd")),e.R7$(3),e.JRh(t.creationUser),e.R7$(2),e.SpI("",t.cityName," "),e.R7$(),e.Y8G("ngIf",null==t.districtName),e.R7$(),e.Y8G("ngIf",null!==t.districtName),e.R7$(3),e.SpI("",t.agentName," "),e.R7$(3),e.SpI("",t.mobile," "),e.R7$(3),e.Y8G("ngForOf",i.getTimes(t.teamNames)),e.R7$(2),e.Y8G("ngForOf",i.getTimes(t.workTimes)),e.R7$(2),e.SpI(" ",e.i5U(26,19,t.visitDate,"yyyy-MM-dd"),""),e.R7$(3),e.Y8G("ngIf",""==t.map),e.R7$(),e.Y8G("ngIf",null==t?null:t.map),e.R7$(3),e.Y8G("hasPermission",e.lJ4(22,It)),e.R7$(),e.Y8G("hasPermission",e.lJ4(23,kt)),e.R7$(),e.Y8G("hasPermission",e.lJ4(24,yt))}}function Xt(r,l){1&r&&(e.j41(0,"div",66),e.EFF(1," general.table.noData "),e.k0s())}function At(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",67)(1,"div",68),e.nrm(2,"ngb-pagination-info",69),e.j41(3,"table-length",70),e.bIt("lengthChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",71)(5,"ngb-pagination",72),e.bIt("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,n)||(a.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function Ut(r,l){if(1&r){const t=e.RV6();e.j41(0,"cancel-order-model",73),e.bIt("success",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.loadentities())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderId",t.orderSelected)}}function Yt(r,l){if(1&r&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s()()),2&r){const t=l.$implicit,i=l.index,n=e.XpG(2);e.R7$(2),e.JRh(t),e.R7$(2),e.JRh(n.orderSelectedData.workTimes[i])}}function Pt(r,l){if(1&r){const t=e.RV6();e.j41(0,"form",74,6),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.assignOrder())}),e.nrm(2,"ngx-ui-loader",75),e.j41(3,"div",76)(4,"div",77)(5,"button",78),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",79)(7,"div",80)(8,"h4",81),e.nrm(9,"i",82),e.EFF(10),e.nI1(11,"translate"),e.k0s(),e.j41(12,"div",83)(13,"div",84)(14,"label",85),e.EFF(15,"orderManagement.order.agentName"),e.k0s(),e.j41(16,"div",86),e.EFF(17),e.k0s()(),e.j41(18,"div",84)(19,"label",85),e.EFF(20,"orderManagement.order.visitDate"),e.k0s(),e.j41(21,"div",86),e.EFF(22),e.nI1(23,"date"),e.k0s()(),e.j41(24,"div",87)(25,"table",88)(26,"thead")(27,"tr")(28,"th",85),e.EFF(29," orderManagement.order.assignTo "),e.k0s(),e.j41(30,"th",85),e.EFF(31," orderManagement.order.workTimes "),e.k0s()()(),e.j41(32,"tbody"),e.DNE(33,Yt,5,2,"tr",47),e.k0s()()()(),e.j41(34,"div",89),e.nrm(35,"button",90),e.j41(36,"button",91),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader),e.R7$(8),e.SpI(" ",e.bMT(11,7,"orderManagement.order.AssignMessage")," "),e.R7$(7),e.SpI(" ",t.orderSelectedData.agentName," "),e.R7$(5),e.SpI(" ",e.i5U(23,9,t.orderSelectedData.visitDate,"yyyy-MM-dd")," "),e.R7$(11),e.Y8G("ngForOf",t.orderSelectedData.teamNames)}}function zt(r,l){if(1&r){const t=e.RV6();e.j41(0,"form",74,6),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.SureOrderRollBack())}),e.nrm(2,"ngx-ui-loader",75),e.j41(3,"div",76)(4,"div",77)(5,"button",78),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",79)(7,"div",92),e.nrm(8,"lord-icon",93),e.j41(9,"div",94),e.nrm(10,"h3",95)(11,"p",96),e.k0s()(),e.j41(12,"div",97),e.nrm(13,"button",90),e.j41(14,"button",91),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}function Ht(r,l){if(1&r&&e.nrm(0,"order-operation",98),2&r){const t=e.XpG();e.Y8G("isOrderEdit",t.isOrderEdit)("isInner",!0)("orderCode",t.orderSelected)}}function Jt(r,l){if(1&r){const t=e.RV6();e.j41(0,"order-timeline",99),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderSelected",t.orderSelected)}}let qt=(()=>{class r extends G.w{constructor(t,i,n,a,o,s,b,u,j,F,x,T,I){super(t,i,b,n,a,o,s),this.baseService=n,this.authDaamService=u,this.excelService=j,this.cityService=F,this.districtService=x,this.channelService=T,this.router=I,this.title="orderManagement.order.urgentOrders.title",this.titleOperation="orderManagement.order.urgentOrders.titleOperation",this.language=localStorage.getItem("language"),this.keySelected="",this.assignUsers=[],this.times=[],this.employees=[],this.searchForm={},this.isResolveList=!0,this.employeeTypes=[{id:1,name:"employeeTeam"},{id:2,name:"managment"},{id:3,name:"customerService"}],this.OrderStatusEnum=te,this.employeeGroups=[],this.activeindex="1",this.active=1,this.formPassword={},this.roles=[],this.userTypes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.countLoad=3,this.orderSelected=0,this.orderSelectedData={},this.cities=[],this.districts=[],this.channels=[],this.isOrderEdit=!1,this.GetCities(),this.GetChannels()}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetDistricts(t){this.districtService.getByCityId(t).subscribe(i=>{this.districts=i.data},i=>{console.log(i)})}GetChannels(){this.channelService.getDropDown().subscribe(t=>{this.channels=t.data},t=>{console.log(t)})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,h.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){var t;if(this.ngxLoader.startLoader(_.a7),console.log(this.searchForm),null!=(t=this.searchForm.dates)&&"to"in t){const i=[t.from,t.to].map(n=>n);this.pagination.visitDateFrom=this.datePipe.transform(i[0],"yyyy-MM-ddT00:00:00"),this.pagination.visitDateTo=this.datePipe.transform(i[1],"yyyy-MM-ddT23:59:59.999")}else this.pagination.visitDateFrom=null,this.pagination.visitDateTo=null;if(null!=(t=this.searchForm.creationDates)&&"to"in t){const i=[t.from,t.to].map(n=>n);this.pagination.creationDateFrom=this.datePipe.transform(i[0],"yyyy-MM-ddT00:00:00"),this.pagination.creationDateTo=this.datePipe.transform(i[1],"yyyy-MM-ddT23:59:59.999")}else this.pagination.creationDateFrom=null,this.pagination.creationDateTo=null;this.pagination.subject=this.searchForm.name,null!=this.searchForm.status&&(this.pagination.status=Number.parseInt(this.searchForm.status)),null!=this.searchForm.priority&&(this.pagination.priority=Number.parseInt(this.searchForm.priority)),this.loadentities()}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.pagination.statusFilter=this.OrderStatusEnum.Urgent,this.ngxLoader.startLoader("urgentOrder"),this.baseService.get(this.pagination).pipe((0,h.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader("urgentOrder"),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader("urgentOrder"),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({"Order Code":i.orderCode,"Created Date":i.createdDate,"Creation user":i.creationUser,"City Name":i.cityName,"District Name":i.districtName?i.districtName:"--","Agent Name":i.agentName,Mobile:i.mobile,"Assigned To":i.teamNames,Times:i.workTimes,"Visit Date":i.visitDate,Location:i.map?this.mapUrl(i?.map):this.translateService.instant("orderManagement.order.noMap")})}),t}assignOrder(){this.ngxLoader.startLoader(_.Fq),this.baseService.assignOrder(this.orderSelected).pipe((0,D.O)(),(0,O.c)(this.mainDelay),(0,w.Z)(),(0,h.Q)(this.notifier),(0,N.j)(()=>this.ngxLoader.stopLoader(_.Fq))).subscribe({next:t=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}goRegister(){this.router.navigateByUrl("/managment/order/new")}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return t.isCancel?"bg-warning-subtle text-warning":t.isFinish?"bg-success-subtle text-success":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen||t.isFree?"bg-warning-subtle text-warning":"bg-success-subtle text-success"}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isFree?"orderManagement.order.free":"orderManagement.order.finished"}openModal(t,i,n="md"){this.form={},this.isOrderEdit=!1,this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}oncityChange(t){this.GetDistricts(t.code)}SureOrderRollBack(){this.ngxLoader.startLoader(_.Fq),this.baseService.SureOrderRollBack(this.orderSelected).pipe((0,D.O)(),(0,O.c)(this.mainDelay),(0,w.Z)(),(0,h.Q)(this.notifier),(0,N.j)(()=>this.ngxLoader.stopLoader(_.Fq))).subscribe({next:t=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}getTimes(t){return""==t?[]:t.split(",")}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}mapUrl(t){if(!t)return"";const[i,n]=t.split(",").map(Number);return`https://www.google.com/maps/dir//${i},${n}/@${i},${n},17z?hl=en-US`}openAssignOrderModalModal(t,i,n="md"){this.form={},this.orderSelected=t.orderCode,this.orderSelectedData={},this.orderSelectedData.agentName=t.agentName,this.orderSelectedData.visitDate=t.visitDate,this.orderSelectedData.workTimes=this.getTimes(t.workTimes),this.orderSelectedData.teamNames=this.getTimes(t.teamNames),this.modalService.open(i,{centered:!0,size:n})}openEditOrderModal(t,i,n="md"){this.form={},this.isOrderEdit=!0,this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}openOrderModal(t,i,n="md"){this.form={},this.isOrderEdit=!1,this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}getServices(t){return t.split("#")}OpenOrderTimeLineModel(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(f.nX),e.rXU(g.c$),e.rXU(q.Q),e.rXU(y.u),e.rXU(c.vh),e.rXU(v.eD),e.rXU(m.Bq),e.rXU(A.J),e.rXU(L.V),e.rXU(z.h),e.rXU(H.m),e.rXU(J.l),e.rXU(f.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-urgent-orders"]],features:[e.Vt3],decls:57,vars:52,consts:[["tableMaster",""],["deleteModal",""],["SubmitOrderModal",""],["SureOrderRollBackModal",""],["orderModel",""],["OrderTimeLineModel",""],["formEntity","ngForm"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"reset","search","exportXlsx","addNew","showAdd","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","agentName","name","agentName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","code","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","name","bindValue","code","bindLabel","name",3,"change","ngModelChange","placeholder","items","multiple","ngModel"],["name","employeeCode","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],[1,"col-12","col-md-4","mb-2"],["type","text","mwlFlatpickr","","id","isDate","mode","range",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["pSortableColumn","orderCode","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","createdDate","translate","",2,"width","10%"],["pSortableColumn","creationUser","translate","",2,"width","8%"],["pSortableColumn","cityId","translate","",2,"width","8%"],["pSortableColumn","agentName","translate","",2,"width","8%"],["translate","",2,"width","8%"],["translate","",2,"width","6%"],[2,"width","15%"],[1,"fs-5"],[3,"click"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.order.nothing",4,"ngIf"],["class","badge bg-success-subtle text-success",4,"ngIf"],[1,"badge","bg-primary-subtle","text-primary","my-1"],[1,"cursor-pointer","badge","bg-danger-subtle","text-danger","fs-6",3,"click"],[1,"ri-clipboard-line"],[4,"ngFor","ngForOf"],["class","badge bg-danger-subtle text-danger mx-1","translate","orderManagement.order.noMap",4,"ngIf"],["target","_blank","class","badge bg-success-subtle text-success mx-1","translate","orderManagement.order.viewMap",3,"href",4,"ngIf"],[1,"d-inline"],["class","  btn btn-sm btn-primary edit-list","tooltipPosition","top",3,"pTooltip","click",4,"hasPermission"],["tooltipPosition","top","class","btn btn-sm btn-soft-info edit-list  mx-1",3,"pTooltip","click",4,"hasPermission"],["tooltipPosition","top","class","  btn btn-sm btn-soft-danger remove-list ",3,"pTooltip","click",4,"hasPermission"],["translate","orderManagement.order.nothing",1,"badge","bg-danger-subtle","text-danger"],[1,"badge","bg-success-subtle","text-success"],[1,"badge","bg-primary-subtle","text-primary","mx-1"],["translate","orderManagement.order.noMap",1,"badge","bg-danger-subtle","text-danger","mx-1"],["target","_blank","translate","orderManagement.order.viewMap",1,"badge","bg-success-subtle","text-success","mx-1",3,"href"],[1,"ri-map-pin-line"],["tooltipPosition","top",1,"btn","btn-sm","btn-primary","edit-list",3,"click","pTooltip"],[1,"ri-check-fill","align-bottom"],["tooltipPosition","top",1,"btn","btn-sm","btn-soft-info","edit-list","mx-1",3,"click","pTooltip"],[1,"ri-pencil-fill","align-bottom"],["tooltipPosition","top",1,"btn","btn-sm","btn-soft-danger","remove-list",3,"click","pTooltip"],[1,"ri-delete-bin-5-fill","align-bottom"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"success","dismiss","orderId"],[3,"ngSubmit"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mx-4"],[1,"mb-0","mt-2","text-center"],[1,"ri-alert-fill","me-2",2,"font-size","1.3rem"],[1,"mt-5","row"],[1,"col-6"],["translate",""],[1,"form-control"],[1,"col-12","text-center","mt-4"],[1,"table","table-bordered"],[1,"d-flex","gap-2","justify-content-end","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],[3,"isOrderEdit","isInner","orderCode"],[3,"dismiss","orderSelected"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",7)(1,"div",8)(2,"div",9),e.nrm(3,"ngx-ui-loader",10),e.j41(4,"base-filter",11),e.bIt("reset",function(){return e.eBV(a),e.Njj(n.onReset())})("search",function(){return e.eBV(a),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(n.onExportXlsx())})("addNew",function(){return e.eBV(a),e.Njj(n.goRegister())}),e.qex(5,12),e.j41(6,"div",13)(7,"div",14)(8,"input",15),e.nI1(9,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.orderCode,s)||(n.pagination.orderCode=s),e.Njj(s)}),e.k0s(),e.nrm(10,"i",16),e.k0s()(),e.j41(11,"div",13)(12,"div",14)(13,"input",17),e.nI1(14,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.agentName,s)||(n.pagination.agentName=s),e.Njj(s)}),e.k0s(),e.nrm(15,"i",16),e.k0s()(),e.j41(16,"div",13)(17,"div",14)(18,"input",15),e.nI1(19,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.mobile,s)||(n.pagination.mobile=s),e.Njj(s)}),e.k0s(),e.nrm(20,"i",16),e.k0s()(),e.j41(21,"div",13)(22,"div",14)(23,"ng-select",18),e.nI1(24,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.channelCode,s)||(n.pagination.channelCode=s),e.Njj(s)}),e.k0s()()(),e.j41(25,"div",13)(26,"div",14)(27,"ng-select",19),e.nI1(28,"translate"),e.bIt("change",function(s){return e.eBV(a),e.Njj(n.oncityChange(s))}),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.cityCode,s)||(n.pagination.cityCode=s),e.Njj(s)}),e.k0s()()(),e.j41(29,"div",13)(30,"div",14)(31,"ng-select",20),e.nI1(32,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.districtName,s)||(n.pagination.districtName=s),e.Njj(s)}),e.k0s()()(),e.j41(33,"div",21)(34,"input",22),e.nI1(35,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.creationDates,s)||(n.searchForm.creationDates=s),e.Njj(s)}),e.k0s()(),e.j41(36,"div",21)(37,"input",22),e.nI1(38,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.dates,s)||(n.searchForm.dates=s),e.Njj(s)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(39,"div",23)(40,"div",24)(41,"p-table",25,0),e.bIt("onLazyLoad",function(s){return e.eBV(a),e.Njj(n.tableChange(s))})("selectionChange",function(s){return e.eBV(a),e.Njj(n.onSelectionChange(s))}),e.DNE(43,Rt,25,0,"ng-template",26)(44,Bt,35,25,"ng-template",27),e.k0s()(),e.DNE(45,Xt,2,0,"div",28)(46,At,6,8,"div",29),e.k0s()()()(),e.DNE(47,Ut,1,1,"ng-template",null,1,e.C5r)(49,Pt,37,12,"ng-template",null,2,e.C5r)(51,zt,15,3,"ng-template",null,3,e.C5r)(53,Ht,1,3,"ng-template",null,4,e.C5r)(55,Jt,1,1,"ng-template",null,5,e.C5r)}2&i&&(e.R7$(3),e.Y8G("loaderId","urgentOrder"),e.R7$(),e.Y8G("showAdd",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,36,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.orderCode),e.R7$(5),e.FS9("placeholder",e.bMT(14,38,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.agentName),e.R7$(5),e.FS9("placeholder",e.bMT(19,40,"orderManagement.order.mobile")),e.R50("ngModel",n.pagination.mobile),e.R7$(5),e.FS9("placeholder",e.bMT(24,42,"orderManagement.order.channelName")),e.Y8G("items",n.channels)("multiple",!1),e.R50("ngModel",n.pagination.channelCode),e.R7$(4),e.FS9("placeholder",e.bMT(28,44,"orderManagement.order.cityName")),e.Y8G("items",n.cities)("multiple",!1),e.R50("ngModel",n.pagination.cityCode),e.R7$(4),e.FS9("placeholder",e.bMT(32,46,"orderManagement.order.districtName")),e.Y8G("items",n.districts)("multiple",!1),e.R50("ngModel",n.pagination.districtName),e.R7$(3),e.FS9("placeholder",e.bMT(35,48,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(3),e.FS9("placeholder",e.bMT(38,50,"orderManagement.order.visitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.dates),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[c.Sq,c.bT,d.qT,d.me,d.Q0,d.BC,d.cb,d.vS,d.cV,m.s5,R.kL,$.b,Z.L,U.p,Y.g,g.Mm,C.XI,P.Ei,C.Tg,v.Cv,V.vr,B.m,ne.p,K.m,_e,ee,c.vh,g.D9],encapsulation:2})}}return r})();const Qt=()=>["confirmed.assignTeam"],Wt=()=>["confirmed.undoOrder"],Kt=()=>["confirmed.edit"],Zt=()=>["confirmed.cancel"];function en(r,l){1&r&&(e.j41(0,"tr",30)(1,"th",31),e.nrm(2,"i",32),e.EFF(3," orderManagement.order.orderCode "),e.k0s(),e.j41(4,"th",33),e.nrm(5,"i",32),e.EFF(6," orderManagement.order.createdDate "),e.k0s(),e.j41(7,"th",34),e.nrm(8,"i",32),e.EFF(9," orderManagement.order.creationUser "),e.k0s(),e.j41(10,"th",35),e.nrm(11,"i",32),e.EFF(12," orderManagement.order.cityName "),e.k0s(),e.j41(13,"th",36),e.nrm(14,"i",32),e.EFF(15," orderManagement.order.agentName "),e.k0s(),e.j41(16,"th",37),e.EFF(17," orderManagement.order.assignTo "),e.k0s(),e.j41(18,"th",37),e.EFF(19," orderManagement.order.workTimes "),e.k0s(),e.j41(20,"th",38),e.nrm(21,"i",32),e.EFF(22," orderManagement.order.visitDate "),e.k0s(),e.j41(23,"th",39),e.EFF(24," orderManagement.order.location "),e.k0s(),e.nrm(25,"th",40),e.k0s())}function tn(r,l){1&r&&e.nrm(0,"span",57)}function nn(r,l){if(1&r&&(e.j41(0,"span",58),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI("",t.districtName," ")}}function rn(r,l){if(1&r&&(e.qex(0),e.j41(1,"span",59),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=l.$implicit;e.R7$(2),e.JRh(t)}}function an(r,l){if(1&r&&(e.qex(0),e.j41(1,"span",59),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=l.$implicit;e.R7$(2),e.JRh(t)}}function sn(r,l){1&r&&e.nrm(0,"span",60)}function on(r,l){if(1&r&&(e.j41(0,"a",61),e.nrm(1,"i",62),e.k0s()),2&r){const t=e.XpG().$implicit,i=e.XpG();e.Y8G("href",i.mapUrl(null==t?null:t.map),e.B4B)}}function ln(r,l){if(1&r){const t=e.RV6();e.j41(0,"button",63),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(),o=e.sdS(50);return e.Njj(a.openAssignOrderModalModal(n,o,"lg"))}),e.nrm(2,"i",64),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"orderManagement.order.assignOrder"))}function dn(r,l){if(1&r){const t=e.RV6();e.j41(0,"button",65),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(),o=e.sdS(52);return e.Njj(a.openModal(n.orderCode,o,"md"))}),e.nrm(2,"i",66),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"orderManagement.order.undoOrder"))}function mn(r,l){if(1&r){const t=e.RV6();e.j41(0,"button",67),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(),o=e.sdS(54);return e.Njj(a.openEditOrderModal(n.orderCode,o,"xxl"))}),e.nrm(2,"i",68),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"orderManagement.order.editOrder"))}function cn(r,l){if(1&r){const t=e.RV6();e.j41(0,"button",69),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(),o=e.sdS(48);return e.Njj(a.openModal(n.orderCode,o))}),e.nrm(2,"i",70),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"orderManagement.order.cancelOrder"))}function pn(r,l){if(1&r){const t=e.RV6();e.j41(0,"tr",41)(1,"td",42),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),o=e.sdS(54);return e.Njj(a.openModal(n.orderCode,o,"xxl"))}),e.j41(2,"bdi"),e.EFF(3),e.k0s()(),e.j41(4,"td"),e.EFF(5),e.nI1(6,"date"),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td"),e.EFF(10),e.DNE(11,tn,1,0,"span",43)(12,nn,2,1,"span",44),e.k0s(),e.j41(13,"td")(14,"span",45),e.EFF(15),e.k0s(),e.nrm(16,"br"),e.j41(17,"span",46),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.copytext(n.mobile))}),e.EFF(18),e.nrm(19,"i",47),e.k0s()(),e.j41(20,"td"),e.DNE(21,rn,4,1,"ng-container",48),e.k0s(),e.j41(22,"td"),e.DNE(23,an,4,1,"ng-container",48),e.k0s(),e.j41(24,"td"),e.EFF(25),e.nI1(26,"date"),e.k0s(),e.j41(27,"td"),e.DNE(28,sn,1,0,"span",49)(29,on,2,1,"a",50),e.k0s(),e.j41(30,"td")(31,"div",51)(32,"i",52),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),o=e.sdS(56);return e.Njj(a.OpenOrderTimeLineModel(n,o,"lg"))}),e.k0s(),e.DNE(33,ln,3,3,"button",53)(34,dn,3,3,"button",54)(35,mn,3,3,"button",55)(36,cn,3,3,"button",56),e.k0s()()()}if(2&r){const t=l.$implicit,i=e.XpG();e.R7$(3),e.SpI("#SO#",t.orderCode,""),e.R7$(2),e.JRh(e.i5U(6,17,t.createdDate,"yyyy-MM-dd")),e.R7$(3),e.JRh(t.creationUser),e.R7$(2),e.SpI("",t.cityName," "),e.R7$(),e.Y8G("ngIf",null==t.districtName),e.R7$(),e.Y8G("ngIf",null!==t.districtName),e.R7$(3),e.SpI("",t.agentName," "),e.R7$(3),e.SpI("",t.mobile," "),e.R7$(3),e.Y8G("ngForOf",i.getTimes(t.teamNames)),e.R7$(2),e.Y8G("ngForOf",i.getTimes(t.workTimes)),e.R7$(2),e.SpI(" ",e.i5U(26,20,t.visitDate,"yyyy-MM-dd"),""),e.R7$(3),e.Y8G("ngIf",""==t.map),e.R7$(),e.Y8G("ngIf",null==t?null:t.map),e.R7$(4),e.Y8G("hasPermission",e.lJ4(23,Qt)),e.R7$(),e.Y8G("hasPermission",e.lJ4(24,Wt)),e.R7$(),e.Y8G("hasPermission",e.lJ4(25,Kt)),e.R7$(),e.Y8G("hasPermission",e.lJ4(26,Zt))}}function gn(r,l){1&r&&(e.j41(0,"div",71),e.EFF(1," general.table.noData "),e.k0s())}function _n(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",72)(1,"div",73),e.nrm(2,"ngb-pagination-info",74),e.j41(3,"table-length",75),e.bIt("lengthChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",76)(5,"ngb-pagination",77),e.bIt("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,n)||(a.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function hn(r,l){if(1&r){const t=e.RV6();e.j41(0,"cancel-order-model",78),e.bIt("success",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.loadentities())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderId",t.orderSelected)}}function un(r,l){if(1&r&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s()()),2&r){const t=l.$implicit,i=l.index,n=e.XpG(2);e.R7$(2),e.JRh(t),e.R7$(2),e.JRh(n.orderSelectedData.workTimes[i])}}function bn(r,l){if(1&r){const t=e.RV6();e.j41(0,"form",79,6),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.AssignOrder())}),e.nrm(2,"ngx-ui-loader",80),e.j41(3,"div",81)(4,"div",82)(5,"button",83),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",84)(7,"div",85)(8,"h4",86),e.nrm(9,"i",87),e.EFF(10),e.nI1(11,"translate"),e.k0s(),e.j41(12,"div",88)(13,"div",89)(14,"label",90),e.EFF(15,"orderManagement.order.agentName"),e.k0s(),e.j41(16,"div",91),e.EFF(17),e.k0s()(),e.j41(18,"div",89)(19,"label",90),e.EFF(20,"orderManagement.order.visitDate"),e.k0s(),e.j41(21,"div",91),e.EFF(22),e.nI1(23,"date"),e.k0s()(),e.j41(24,"div",92)(25,"table",93)(26,"thead")(27,"tr")(28,"th",90),e.EFF(29," orderManagement.order.assignTo "),e.k0s(),e.j41(30,"th",90),e.EFF(31," orderManagement.order.workTimes "),e.k0s()()(),e.j41(32,"tbody"),e.DNE(33,un,5,2,"tr",48),e.k0s()()()(),e.j41(34,"div",94),e.nrm(35,"button",95),e.j41(36,"button",96),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader),e.R7$(8),e.SpI(" ",e.bMT(11,7,"orderManagement.order.AssignMessage")," "),e.R7$(7),e.SpI(" ",t.orderSelectedData.agentName," "),e.R7$(5),e.SpI(" ",e.i5U(23,9,t.orderSelectedData.visitDate,"yyyy-MM-dd")," "),e.R7$(11),e.Y8G("ngForOf",t.orderSelectedData.teamNames)}}function fn(r,l){if(1&r){const t=e.RV6();e.j41(0,"form",79,6),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.SureOrderRollBack())}),e.nrm(2,"ngx-ui-loader",80),e.j41(3,"div",81)(4,"div",82)(5,"button",83),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",84)(7,"div",97),e.nrm(8,"lord-icon",98),e.j41(9,"div",99),e.nrm(10,"h3",100)(11,"p",101),e.k0s()(),e.j41(12,"div",102),e.nrm(13,"button",95),e.j41(14,"button",96),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}function vn(r,l){if(1&r&&e.nrm(0,"order-operation",103),2&r){const t=e.XpG();e.Y8G("isOrderEdit",t.isOrderEdit)("isInner",!0)("orderCode",t.orderSelected)}}function Cn(r,l){if(1&r){const t=e.RV6();e.j41(0,"order-timeline",104),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderSelected",t.orderSelected)}}let jn=(()=>{class r extends G.w{constructor(t,i,n,a,o,s,b,u,j,F,x,T,I){super(t,i,b,n,a,o,s),this.baseService=n,this.authDaamService=u,this.excelService=j,this.cityService=F,this.districtService=x,this.channelService=T,this.router=I,this.title="orderManagement.order.sureOrders.title",this.titleOperation="orderManagement.order.sureOrders.titleOperation",this.language=localStorage.getItem("language"),this.keySelected="",this.assignUsers=[],this.times=[],this.employees=[],this.searchForm={},this.OrderStatusEnum=te,this.isResolveList=!0,this.employeeTypes=[{id:1,name:"employeeTeam"},{id:2,name:"managment"},{id:3,name:"customerService"}],this.employeeGroups=[],this.activeindex="1",this.active=1,this.formPassword={},this.orderSelectedData={},this.roles=[],this.userTypes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.countLoad=2,this.orderSelected=0,this.cities=[],this.districts=[],this.channels=[],this.isOrderEdit=!1,this.GetCities(),this.GetChannels()}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetDistricts(t){this.districtService.getByCityId(t).subscribe(i=>{this.districts=i.data},i=>{console.log(i)})}GetChannels(){this.channelService.getDropDown().subscribe(t=>{this.channels=t.data},t=>{console.log(t)})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,h.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){var t;if(this.ngxLoader.startLoader(_.a7),console.log(this.searchForm),null!=(t=this.searchForm.dates)&&"to"in t){const i=[t.from,t.to].map(n=>n);this.pagination.visitDateFrom=this.datePipe.transform(i[0],"yyyy-MM-ddT00:00:00"),this.pagination.visitDateTo=this.datePipe.transform(i[1],"yyyy-MM-ddT23:59:59.999")}else this.pagination.visitDateFrom=null,this.pagination.visitDateTo=null;if(null!=(t=this.searchForm.creationDates)&&"to"in t){const i=[t.from,t.to].map(n=>n);this.pagination.creationDateFrom=this.datePipe.transform(i[0],"yyyy-MM-ddT00:00:00"),this.pagination.creationDateTo=this.datePipe.transform(i[1],"yyyy-MM-ddT23:59:59.999")}else this.pagination.creationDateFrom=null,this.pagination.creationDateTo=null;this.pagination.subject=this.searchForm.name,null!=this.searchForm.status&&(this.pagination.status=Number.parseInt(this.searchForm.status)),null!=this.searchForm.priority&&(this.pagination.priority=Number.parseInt(this.searchForm.priority)),this.loadentities()}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.pagination.statusFilter=this.OrderStatusEnum.Confirmed,this.ngxLoader.startLoader("sureOrder"),this.baseService.get(this.pagination).pipe((0,h.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader("sureOrder"),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader("sureOrder"),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({"Order Code":i.orderCode,"Created Date":i.createdDate,"Creation user":i.creationUser,"City Name":i.cityName,"District Name":i.districtName?i.districtName:"--","Agent Name":i.agentName,Mobile:i.mobile,"Assigned To":i.teamNames,Times:i.workTimes,"Visit Date":i.visitDate,Location:i.map?this.mapUrl(i?.map):this.translateService.instant("orderManagement.order.noMap")})}),t}AssignOrder(){this.ngxLoader.startLoader(_.Fq),this.baseService.assignOrder(this.orderSelected).pipe((0,D.O)(),(0,O.c)(this.mainDelay),(0,w.Z)(),(0,h.Q)(this.notifier),(0,N.j)(()=>this.ngxLoader.stopLoader(_.Fq))).subscribe({next:t=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}SureOrderRollBack(){this.ngxLoader.startLoader(_.Fq),this.baseService.SureOrderRollBack(this.orderSelected).pipe((0,D.O)(),(0,O.c)(this.mainDelay),(0,w.Z)(),(0,h.Q)(this.notifier),(0,N.j)(()=>this.ngxLoader.stopLoader(_.Fq))).subscribe({next:t=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}goRegister(){this.router.navigateByUrl("/managment/order/new")}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return t.isCancel?"bg-warning-subtle text-warning":t.isFinish?"bg-success-subtle text-success":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen||t.isFree?"bg-warning-subtle text-warning":"bg-success-subtle text-success"}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isFree?"orderManagement.order.free":"orderManagement.order.finished"}openModal(t,i,n="md"){this.form={},this.isOrderEdit=!1,this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}getTimes(t){return t.split(",")}oncityChange(t){this.GetDistricts(t.code)}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}mapUrl(t){if(!t)return"";const[i,n]=t.split(",").map(Number);return`https://www.google.com/maps/dir//${i},${n}/@${i},${n},17z?hl=en-US`}openAssignOrderModalModal(t,i,n="md"){this.form={},this.orderSelected=t.orderCode,this.orderSelectedData={},this.orderSelectedData.agentName=t.agentName,this.orderSelectedData.visitDate=t.visitDate,this.orderSelectedData.workTimes=this.getTimes(t.workTimes),this.orderSelectedData.teamNames=this.getTimes(t.teamNames),this.modalService.open(i,{centered:!0,size:n})}openEditOrderModal(t,i,n="md"){this.form={},this.isOrderEdit=!0,this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}getServices(t){return t.split("#")}OpenOrderTimeLineModel(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(f.nX),e.rXU(g.c$),e.rXU(q.Q),e.rXU(y.u),e.rXU(c.vh),e.rXU(v.eD),e.rXU(m.Bq),e.rXU(A.J),e.rXU(L.V),e.rXU(z.h),e.rXU(H.m),e.rXU(J.l),e.rXU(f.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-sure-orders"]],features:[e.Vt3],decls:57,vars:52,consts:[["tableMaster",""],["deleteModal",""],["AssignOrderModal",""],["SureOrderRollBackModal",""],["orderModel",""],["OrderTimeLineModel",""],["formEntity","ngForm"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"reset","search","exportXlsx","addNew","showAdd","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","agentName","name","agentName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","code","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","name","bindValue","code","bindLabel","name",3,"change","ngModelChange","placeholder","items","multiple","ngModel"],["name","employeeCode","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],[1,"col-12","col-md-4","mb-2"],["type","text","mwlFlatpickr","","id","isDate","mode","range",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["pSortableColumn","orderCode","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","createdDate","translate","",2,"width","10%"],["pSortableColumn","creationUser","translate","",2,"width","8%"],["pSortableColumn","cityId","translate","",2,"width","8%"],["pSortableColumn","agentName","translate","",2,"width","8%"],["translate","",2,"width","8%"],["pSortableColumn","visitDate","translate","",2,"width","8%"],["translate","",2,"width","6%"],[2,"width","15%"],[1,"fs-5"],[3,"click"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.order.nothing",4,"ngIf"],["class","badge bg-success-subtle text-success",4,"ngIf"],[1,"badge","bg-primary-subtle","text-primary","my-1"],[1,"cursor-pointer","badge","bg-danger-subtle","text-danger","fs-6",3,"click"],[1,"ri-clipboard-line"],[4,"ngFor","ngForOf"],["class","badge bg-danger-subtle text-danger mx-1","translate","orderManagement.order.noMap",4,"ngIf"],["target","_blank","class","badge bg-success-subtle text-success mx-1","translate","orderManagement.order.viewMap",3,"href",4,"ngIf"],[1,"d-inline"],[1,"ri-history-fill","d-inline","text-primary","fs-16","align-middle","me-1",3,"click"],["tooltipPosition","top","class","mt-2  btn btn-sm btn-primary edit-list",3,"pTooltip","click",4,"hasPermission"],["class","mt-2 btn btn-sm mx-1 btn-warning edit-list","tooltipPosition","top",3,"pTooltip","click",4,"hasPermission"],["tooltipPosition","top","class","mt-2 btn btn-sm btn-soft-info edit-list  ",3,"pTooltip","click",4,"hasPermission"],["tooltipPosition","top","class","mt-2 btn btn-sm btn-soft-danger remove-list  mx-1",3,"pTooltip","click",4,"hasPermission"],["translate","orderManagement.order.nothing",1,"badge","bg-danger-subtle","text-danger"],[1,"badge","bg-success-subtle","text-success"],[1,"badge","bg-primary-subtle","text-primary","mx-1"],["translate","orderManagement.order.noMap",1,"badge","bg-danger-subtle","text-danger","mx-1"],["target","_blank","translate","orderManagement.order.viewMap",1,"badge","bg-success-subtle","text-success","mx-1",3,"href"],[1,"ri-map-pin-line"],["tooltipPosition","top",1,"mt-2","btn","btn-sm","btn-primary","edit-list",3,"click","pTooltip"],[1,"ri-check-fill","align-bottom"],["tooltipPosition","top",1,"mt-2","btn","btn-sm","mx-1","btn-warning","edit-list",3,"click","pTooltip"],[1,"ri-arrow-go-back-fill","align-bottom"],["tooltipPosition","top",1,"mt-2","btn","btn-sm","btn-soft-info","edit-list",3,"click","pTooltip"],[1,"ri-pencil-fill","align-bottom"],["tooltipPosition","top",1,"mt-2","btn","btn-sm","btn-soft-danger","remove-list","mx-1",3,"click","pTooltip"],[1,"ri-delete-bin-5-fill","align-bottom"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"success","dismiss","orderId"],[3,"ngSubmit"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mx-4"],[1,"mb-0","mt-2","text-center"],[1,"ri-alert-fill","text-info","me-2",2,"font-size","1.3rem"],[1,"mt-5","row"],[1,"col-6"],["translate",""],[1,"form-control"],[1,"col-12","text-center","mt-4"],[1,"table","table-bordered"],[1,"d-flex","gap-2","justify-content-end","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],[3,"isOrderEdit","isInner","orderCode"],[3,"dismiss","orderSelected"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",7)(1,"div",8)(2,"div",9),e.nrm(3,"ngx-ui-loader",10),e.j41(4,"base-filter",11),e.bIt("reset",function(){return e.eBV(a),e.Njj(n.onReset())})("search",function(){return e.eBV(a),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(n.onExportXlsx())})("addNew",function(){return e.eBV(a),e.Njj(n.goRegister())}),e.qex(5,12),e.j41(6,"div",13)(7,"div",14)(8,"input",15),e.nI1(9,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.orderCode,s)||(n.pagination.orderCode=s),e.Njj(s)}),e.k0s(),e.nrm(10,"i",16),e.k0s()(),e.j41(11,"div",13)(12,"div",14)(13,"input",17),e.nI1(14,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.agentName,s)||(n.pagination.agentName=s),e.Njj(s)}),e.k0s(),e.nrm(15,"i",16),e.k0s()(),e.j41(16,"div",13)(17,"div",14)(18,"input",15),e.nI1(19,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.mobile,s)||(n.pagination.mobile=s),e.Njj(s)}),e.k0s(),e.nrm(20,"i",16),e.k0s()(),e.j41(21,"div",13)(22,"div",14)(23,"ng-select",18),e.nI1(24,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.channelCode,s)||(n.pagination.channelCode=s),e.Njj(s)}),e.k0s()()(),e.j41(25,"div",13)(26,"div",14)(27,"ng-select",19),e.nI1(28,"translate"),e.bIt("change",function(s){return e.eBV(a),e.Njj(n.oncityChange(s))}),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.cityCode,s)||(n.pagination.cityCode=s),e.Njj(s)}),e.k0s()()(),e.j41(29,"div",13)(30,"div",14)(31,"ng-select",20),e.nI1(32,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.districtName,s)||(n.pagination.districtName=s),e.Njj(s)}),e.k0s()()(),e.j41(33,"div",21)(34,"input",22),e.nI1(35,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.creationDates,s)||(n.searchForm.creationDates=s),e.Njj(s)}),e.k0s()(),e.j41(36,"div",21)(37,"input",22),e.nI1(38,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.dates,s)||(n.searchForm.dates=s),e.Njj(s)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(39,"div",23)(40,"div",24)(41,"p-table",25,0),e.bIt("onLazyLoad",function(s){return e.eBV(a),e.Njj(n.tableChange(s))})("selectionChange",function(s){return e.eBV(a),e.Njj(n.onSelectionChange(s))}),e.DNE(43,en,26,0,"ng-template",26)(44,pn,37,27,"ng-template",27),e.k0s()(),e.DNE(45,gn,2,0,"div",28)(46,_n,6,8,"div",29),e.k0s()()()(),e.DNE(47,hn,1,1,"ng-template",null,1,e.C5r)(49,bn,37,12,"ng-template",null,2,e.C5r)(51,fn,15,3,"ng-template",null,3,e.C5r)(53,vn,1,3,"ng-template",null,4,e.C5r)(55,Cn,1,1,"ng-template",null,5,e.C5r)}2&i&&(e.R7$(3),e.Y8G("loaderId","sureOrder"),e.R7$(),e.Y8G("showAdd",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,36,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.orderCode),e.R7$(5),e.FS9("placeholder",e.bMT(14,38,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.agentName),e.R7$(5),e.FS9("placeholder",e.bMT(19,40,"orderManagement.order.mobile")),e.R50("ngModel",n.pagination.mobile),e.R7$(5),e.FS9("placeholder",e.bMT(24,42,"orderManagement.order.channelName")),e.Y8G("items",n.channels)("multiple",!1),e.R50("ngModel",n.pagination.channelCode),e.R7$(4),e.FS9("placeholder",e.bMT(28,44,"orderManagement.order.cityName")),e.Y8G("items",n.cities)("multiple",!1),e.R50("ngModel",n.pagination.cityCode),e.R7$(4),e.FS9("placeholder",e.bMT(32,46,"orderManagement.order.districtName")),e.Y8G("items",n.districts)("multiple",!1),e.R50("ngModel",n.pagination.districtName),e.R7$(3),e.FS9("placeholder",e.bMT(35,48,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(3),e.FS9("placeholder",e.bMT(38,50,"orderManagement.order.visitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.dates),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[c.Sq,c.bT,d.qT,d.me,d.Q0,d.BC,d.cb,d.vS,d.cV,m.s5,R.kL,$.b,Z.L,U.p,Y.g,g.Mm,C.XI,P.Ei,C.Tg,v.Cv,V.vr,B.m,ne.p,K.m,_e,ee,c.vh,g.D9],encapsulation:2})}}return r})();var ie=p(45312),Te=p(63022),Se=p(96402),he=p(99902);const Fn=["FileInput"],Mn=()=>["assigned.changeStatus"],xn=()=>["assigned.undoAssign"],Tn=()=>["assigned.finishedOrder"];function Sn(r,l){1&r&&(e.j41(0,"tr",35)(1,"th",36),e.nrm(2,"i",37),e.EFF(3," orderManagement.order.orderCode "),e.k0s(),e.j41(4,"th",38),e.nrm(5,"i",37),e.EFF(6," orderManagement.order.cityName "),e.k0s(),e.j41(7,"th",39),e.nrm(8,"i",37),e.EFF(9," orderManagement.order.agentName "),e.k0s(),e.j41(10,"th",40),e.EFF(11," orderManagement.order.assignTo "),e.k0s(),e.j41(12,"th",41),e.EFF(13," orderManagement.order.workTimes "),e.k0s(),e.j41(14,"th",42),e.nrm(15,"i",37),e.EFF(16," orderManagement.order.visitDate "),e.k0s(),e.j41(17,"th",43),e.EFF(18," orderManagement.order.services "),e.k0s(),e.j41(19,"th",44),e.nrm(20,"i",37),e.EFF(21," orderManagement.order.teamStatus "),e.k0s(),e.nrm(22,"th",45),e.k0s())}function In(r,l){1&r&&e.nrm(0,"span",64)}function kn(r,l){if(1&r&&(e.j41(0,"span",65),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI("",t.districtName," ")}}function yn(r,l){if(1&r&&(e.qex(0),e.j41(1,"span",66),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=l.$implicit;e.R7$(2),e.JRh(t)}}function Rn(r,l){if(1&r&&(e.qex(0),e.j41(1,"span",66),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=l.$implicit;e.R7$(2),e.JRh(t)}}function En(r,l){if(1&r&&(e.qex(0),e.j41(1,"span",66),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=l.$implicit;e.R7$(2),e.JRh(t)}}function Nn(r,l){if(1&r){const t=e.RV6();e.j41(0,"button",67),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(),o=e.sdS(48);return e.Njj(a.openChangeStatusModal(n,o))}),e.nrm(1,"i",68)(2,"span",69),e.k0s()}}function Dn(r,l){if(1&r){const t=e.RV6();e.j41(0,"li")(1,"a",70),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(),o=e.sdS(56);return e.Njj(a.OpenOrderTimeLineModel(n.orderCode,o,"md"))}),e.nrm(2,"i",71)(3,"span",72),e.k0s()()}}function On(r,l){if(1&r){const t=e.RV6();e.j41(0,"li",47),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(),o=e.sdS(50);return a.GetOrderServiceAndPayment(n),e.Njj(a.openChangeStatusModal(n,o,"xl"))}),e.j41(1,"a",73),e.nrm(2,"i",74)(3,"span",75),e.k0s()()}}function wn(r,l){if(1&r){const t=e.RV6();e.j41(0,"tr",46)(1,"td",47),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),o=e.sdS(52);return e.Njj(a.openModal(n.orderCode,o,"xxl"))}),e.j41(2,"bdi"),e.EFF(3),e.k0s()(),e.j41(4,"td"),e.EFF(5),e.DNE(6,In,1,0,"span",48)(7,kn,2,1,"span",49),e.k0s(),e.j41(8,"td")(9,"span",50),e.EFF(10),e.k0s(),e.nrm(11,"br"),e.j41(12,"span",51),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.copytext(n.mobile))}),e.EFF(13),e.nrm(14,"i",52),e.k0s()(),e.j41(15,"td"),e.DNE(16,yn,4,1,"ng-container",53),e.k0s(),e.j41(17,"td"),e.DNE(18,Rn,4,1,"ng-container",53),e.k0s(),e.j41(19,"td"),e.EFF(20),e.nI1(21,"date"),e.k0s(),e.j41(22,"td"),e.DNE(23,En,4,1,"ng-container",53),e.k0s(),e.j41(24,"td")(25,"span"),e.nrm(26,"i",54),e.EFF(27),e.nI1(28,"translate"),e.k0s()(),e.j41(29,"td")(30,"i",55),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),o=e.sdS(54);return e.Njj(a.OpenOrderTimeLineModel(n,o,"lg"))}),e.k0s(),e.DNE(31,Nn,3,0,"button",56),e.j41(32,"div",57)(33,"div",58)(34,"button",59),e.nI1(35,"translate"),e.nrm(36,"i",60),e.k0s(),e.j41(37,"ul",61),e.DNE(38,Dn,4,0,"li",62)(39,On,4,0,"li",63),e.k0s()()()()()}if(2&r){const t=l.$implicit,i=e.XpG();e.R7$(3),e.SpI("#SO#",t.orderCode,""),e.R7$(2),e.SpI(" ",t.cityName," "),e.R7$(),e.Y8G("ngIf",null==t.districtName),e.R7$(),e.Y8G("ngIf",null!==t.districtName),e.R7$(3),e.SpI("",t.agentName," "),e.R7$(3),e.SpI("",t.mobile," "),e.R7$(3),e.Y8G("ngForOf",i.getTimes(t.teamNames)),e.R7$(2),e.Y8G("ngForOf",i.getTimes(t.workTimes)),e.R7$(2),e.JRh(e.i5U(21,18,t.visitDate,"yyyy-MM-dd")),e.R7$(3),e.Y8G("ngForOf",i.getServices(t.services)),e.R7$(2),e.ZvI("  badge ",i.getTeamStatus(t.teamStatus)," "),e.R7$(2),e.SpI(" ",e.bMT(28,21,"orderManagement.order."+t.teamStatusName),""),e.R7$(4),e.Y8G("hasPermission",e.lJ4(25,Mn)),e.R7$(3),e.FS9("pTooltip",e.bMT(35,23,"general.actions")),e.R7$(4),e.Y8G("hasPermission",e.lJ4(26,xn)),e.R7$(),e.Y8G("hasPermission",e.lJ4(27,Tn))}}function Vn(r,l){1&r&&(e.j41(0,"div",76),e.EFF(1," general.table.noData "),e.k0s())}function Gn(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",77)(1,"div",78),e.nrm(2,"ngb-pagination-info",79),e.j41(3,"table-length",80),e.bIt("lengthChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",81)(5,"ngb-pagination",82),e.bIt("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,n)||(a.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function Ln(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",91)(1,"label",100),e.EFF(2,"orderManagement.order.cancelReasonName"),e.k0s(),e.j41(3,"ng-select",101),e.nI1(4,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG(2);return e.DH7(a.form.cancelReasonCode,n)||(a.form.cancelReasonCode=n),e.Njj(n)}),e.k0s()()}if(2&r){const t=e.XpG(2);e.R7$(3),e.FS9("placeholder",e.bMT(4,4,"orderManagement.order.cancelReasonName")),e.Y8G("items",t.cancelReasons)("multiple",!1),e.R50("ngModel",t.form.cancelReasonCode)}}function $n(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",83)(1,"div",84)(2,"h4",85),e.nrm(3,"span",86),e.k0s(),e.j41(4,"button",87),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(5,"div",88),e.nrm(6,"ngx-ui-loader",89),e.j41(7,"form",90,6),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.changeStatus())}),e.j41(9,"div",12)(10,"div",91)(11,"label",92),e.EFF(12,"orderManagement.order.changeTeamStatus"),e.k0s(),e.j41(13,"ng-select",93),e.nI1(14,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.form.teamStatus,n)||(a.form.teamStatus=n),e.Njj(n)}),e.k0s()(),e.DNE(15,Ln,5,6,"div",94),e.j41(16,"div",91)(17,"label",92),e.EFF(18,"orderManagement.order.teamStatusNotes"),e.k0s(),e.j41(19,"textarea",95),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.form.teamStatusNotes,n)||(a.form.teamStatusNotes=n),e.Njj(n)}),e.k0s()()(),e.j41(20,"div",96)(21,"button",97),e.nrm(22,"i",98)(23,"span",99),e.k0s()()()()()}if(2&r){const t=e.sdS(8),i=e.XpG();e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",i.loaderOperationShap)("loaderId",i.operationLoader),e.R7$(7),e.FS9("placeholder",e.bMT(14,10,"orderManagement.order.changeTeamStatus")),e.Y8G("items",i.statusList)("multiple",!1),e.R50("ngModel",i.form.teamStatus),e.R7$(2),e.Y8G("ngIf",3==i.form.teamStatus),e.R7$(4),e.R50("ngModel",i.form.teamStatusNotes),e.R7$(2),e.Y8G("disabled",!t.valid)}}function Bn(r,l){if(1&r&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",t.price," ")}}function Xn(r,l){if(1&r){const t=e.RV6();e.j41(0,"span",144)(1,"input",145),e.nI1(2,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG(3);return e.DH7(a.editPrice,n)||(a.editPrice=n),e.Njj(n)}),e.k0s(),e.j41(3,"button",146),e.bIt("click",function(){e.eBV(t);const n=e.XpG().index,a=e.XpG(2);return e.Njj(a.editEachPrice(n))}),e.nrm(4,"i",147),e.k0s(),e.j41(5,"button",148),e.bIt("click",function(){e.eBV(t);const n=e.XpG(3);return e.Njj(n.isEditPrice=!1)}),e.nrm(6,"i",149),e.k0s()()}if(2&r){const t=e.XpG(3);e.R7$(),e.FS9("placeholder",e.bMT(2,2,"orderManagement.order.notes")),e.R50("ngModel",t.editPrice)}}function An(r,l){if(1&r){const t=e.RV6();e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.DNE(4,Bn,2,1,"span",118)(5,Xn,7,4,"span",140),e.k0s(),e.j41(6,"td"),e.EFF(7),e.k0s(),e.j41(8,"td")(9,"button",141),e.bIt("click",function(){const n=e.eBV(t).index,a=e.XpG(2);return e.Njj(a.deleteService(n))}),e.nrm(10,"i",142),e.k0s(),e.j41(11,"button",113),e.bIt("click",function(){const n=e.eBV(t).index,a=e.XpG(2);return a.isEditPrice=!0,e.Njj(a.editPrice=a.finishOrderForm.invoiceService[n].price)}),e.nrm(12,"i",143),e.k0s()()()}if(2&r){const t=l.$implicit,i=e.XpG(2);e.R7$(2),e.JRh(t.service),e.R7$(2),e.Y8G("ngIf",!i.isEditPrice),e.R7$(),e.Y8G("ngIf",i.isEditPrice),e.R7$(2),e.JRh(t.notes)}}function Un(r,l){1&r&&(e.j41(0,"tr")(1,"td",150),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&r&&(e.R7$(2),e.JRh(e.bMT(3,1,"orderManagement.order.noData")))}function Yn(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",151)(1,"i",152),e.bIt("click",function(){const n=e.eBV(t),a=n.$implicit,o=n.index,s=e.XpG(2);return e.Njj(s.removeImage(a.id,o))}),e.k0s(),e.j41(2,"div",153),e.nrm(3,"img",154),e.k0s()()}if(2&r){const t=l.$implicit,i=e.XpG(2);e.R7$(3),e.Y8G("src",0==t.id?t.path:i.serverPath+t.path,e.B4B)}}function Pn(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",84)(1,"h4",85),e.nrm(2,"span",102),e.k0s(),e.j41(3,"button",87),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(4,"div",88)(5,"form",null,6),e.nrm(7,"ngx-ui-loader",89),e.j41(8,"div",103)(9,"div",104)(10,"div",35)(11,"div",105)(12,"div",106)(13,"label",107),e.EFF(14,"orderManagement.order.services"),e.k0s()(),e.j41(15,"div",108)(16,"ng-select",109,7),e.nI1(18,"translate"),e.bIt("change",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.setService(n))}),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.finishOrderForm.serviceCode,n)||(a.finishOrderForm.serviceCode=n),e.Njj(n)}),e.k0s()(),e.j41(19,"div",108)(20,"div",110)(21,"input",111,8),e.nI1(23,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.finishOrderForm.note,n)||(a.finishOrderForm.note=n),e.Njj(n)}),e.k0s()()(),e.j41(24,"div",112)(25,"button",113),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.addService())}),e.nrm(26,"i",114),e.k0s()(),e.j41(27,"div",115)(28,"table",116)(29,"thead")(30,"tr")(31,"th",117),e.EFF(32," orderManagement.order.service "),e.k0s(),e.j41(33,"th",117),e.EFF(34," orderManagement.order.price "),e.k0s(),e.j41(35,"th",117),e.EFF(36," orderManagement.order.notes "),e.k0s(),e.j41(37,"th",117),e.EFF(38," orderManagement.order.actions "),e.k0s()()(),e.j41(39,"tbody"),e.DNE(40,An,13,4,"tr",53)(41,Un,4,3,"tr",118),e.k0s()()()(),e.j41(42,"div",119)(43,"div",120)(44,"div",121),e.nrm(45,"i",122),e.j41(46,"strong",117),e.EFF(47,"orderManagement.order.assignedOrders.usedShow "),e.k0s(),e.EFF(48),e.k0s(),e.nrm(49,"div",123),e.k0s()(),e.j41(50,"div",119)(51,"div",124)(52,"label",125),e.EFF(53,"orderManagement.order.assignedOrders.total"),e.k0s(),e.j41(54,"div",126),e.EFF(55),e.k0s()(),e.j41(56,"div",124)(57,"label",125),e.EFF(58,"orderManagement.order.assignedOrders.extraDiscount"),e.k0s(),e.j41(59,"div",126),e.EFF(60),e.k0s()(),e.j41(61,"div",124)(62,"label",125),e.EFF(63,"orderManagement.order.assignedOrders.tax"),e.k0s(),e.j41(64,"div",126),e.EFF(65),e.k0s()(),e.j41(66,"div",124)(67,"label",125),e.EFF(68,"orderManagement.order.assignedOrders.promotionDiscount"),e.k0s(),e.j41(69,"div",126),e.EFF(70),e.k0s()(),e.j41(71,"div",124)(72,"label",125),e.EFF(73,"orderManagement.order.assignedOrders.net"),e.k0s(),e.j41(74,"div",126),e.EFF(75),e.k0s()(),e.j41(76,"div",124)(77,"label",125),e.EFF(78,"orderManagement.order.assignedOrders.paid"),e.k0s(),e.j41(79,"div",126),e.EFF(80),e.k0s()(),e.j41(81,"div",124)(82,"label",127),e.EFF(83,"orderManagement.order.assignedOrders.paymentMethod"),e.k0s(),e.j41(84,"div",128)(85,"ng-select",129,9),e.nI1(87,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.finishOrderForm.paymentTypeCode,n)||(a.finishOrderForm.paymentTypeCode=n),e.Njj(n)}),e.k0s()()(),e.j41(88,"div",124)(89,"label",125),e.EFF(90,"orderManagement.order.assignedOrders.remain"),e.k0s(),e.j41(91,"div",126),e.EFF(92),e.k0s()(),e.j41(93,"div",130)(94,"label",125),e.EFF(95,"orderManagement.order.assignedOrders.notes"),e.k0s(),e.j41(96,"textarea",131,10),e.nI1(98,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.finishOrderForm.notes,n)||(a.finishOrderForm.notes=n),e.Njj(n)}),e.EFF(99,"                                "),e.k0s()(),e.j41(100,"div",132)(101,"label",125),e.EFF(102,"orderManagement.order.assignedOrders.attachments"),e.k0s(),e.j41(103,"div",128)(104,"button",133),e.bIt("click",function(){e.eBV(t);const n=e.sdS(109);return e.Njj(n.click())}),e.EFF(105," orderManagement.order.assignedOrders.select "),e.k0s(),e.j41(106,"div",134),e.DNE(107,Yn,4,1,"div",135),e.k0s()(),e.j41(108,"input",136,11),e.bIt("change",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.onFileChanged(n))}),e.k0s()()(),e.j41(110,"div",137)(111,"button",138),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.finishOrder())}),e.k0s(),e.j41(112,"button",139),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()()()}if(2&r){const t=e.XpG();e.R7$(7),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader),e.R7$(9),e.FS9("placeholder",e.bMT(18,27,"orderManagement.order.services")),e.Y8G("items",t.services)("multiple",!1),e.R50("ngModel",t.finishOrderForm.serviceCode),e.R7$(5),e.FS9("placeholder",e.bMT(23,29,"orderManagement.order.notes")),e.R50("ngModel",t.finishOrderForm.note),e.R7$(19),e.Y8G("ngForOf",t.finishOrderForm.invoiceService),e.R7$(),e.Y8G("ngIf",0==t.finishOrderForm.invoiceService.length),e.R7$(7),e.SpI(" - ",t.finishOrderForm.usedShow||"--"," "),e.R7$(7),e.SpI(" ",t.finishOrderForm.total||"0"," "),e.R7$(5),e.SpI(" ",t.finishOrderForm.discountAdd||"0"," "),e.R7$(5),e.SpI(" ",t.finishOrderForm.tax||"0"," "),e.R7$(5),e.SpI(" ",t.finishOrderForm.promotionDiscount||"0"," "),e.R7$(5),e.SpI(" ",t.finishOrderForm.net||"0"," "),e.R7$(5),e.SpI(" ",t.finishOrderForm.paid||"0"," "),e.R7$(5),e.FS9("placeholder",e.bMT(87,31,"orderManagement.order.assignedOrders.paymentMethod")),e.Y8G("items",t.paymentTypes)("multiple",!1),e.R50("ngModel",t.finishOrderForm.paymentTypeCode),e.R7$(7),e.SpI(" ",t.finishOrderForm.remain||"--"," "),e.R7$(4),e.FS9("placeholder",e.bMT(98,33,"orderManagement.order.notes")),e.R50("ngModel",t.finishOrderForm.notes),e.R7$(11),e.Y8G("ngForOf",t.images),e.R7$(4),e.Y8G("disabled",!t.finishOrderForm.paymentTypeCode)}}function zn(r,l){if(1&r&&e.nrm(0,"order-operation",155),2&r){const t=e.XpG();e.Y8G("isOrderEdit",!1)("isInner",!0)("orderCode",t.orderSelected)}}function Hn(r,l){if(1&r){const t=e.RV6();e.j41(0,"order-timeline",156),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderSelected",t.orderSelected)}}function Jn(r,l){if(1&r){const t=e.RV6();e.j41(0,"form",90,6),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.RollBack())}),e.nrm(2,"ngx-ui-loader",89),e.j41(3,"div",103)(4,"div",157)(5,"button",158),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",88)(7,"div",159),e.nrm(8,"lord-icon",160),e.j41(9,"div",161),e.nrm(10,"h3",162)(11,"p",163),e.k0s()(),e.j41(12,"div",164),e.nrm(13,"button",165),e.j41(14,"button",166),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}let qn=(()=>{class r extends G.w{constructor(t,i,n,a,o,s,b,u,j,F,x,T,I,X,ce,pe,Fe){super(t,i,b,n,a,o,s),this.baseService=n,this.authDaamService=u,this.invoicesService=j,this._servicesService=F,this.excelService=x,this._formDataService=T,this.cityService=I,this.districtService=X,this.channelService=ce,this.cancelReasonService=pe,this.router=Fe,this.title="orderManagement.order.urgentOrders.title",this.titleOperation="orderManagement.order.urgentOrders.titleOperation",this.language=localStorage.getItem("language"),this.keySelected="",this.assignUsers=[],this.times=[],this.images=[],this.employees=[],this.searchForm={},this.finishOrderForm={invoiceService:[],invoiceAttachImages:[],usedShow:"",promotionDiscount:""},this.isResolveList=!0,this.editPrice=0,this.isEditPrice=!1,this.formPassword={},this.OrderStatusEnum=te,this.roles=[],this.userTypes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.serverPath=ie.c.mediaUrl,this.countLoad=2,this.orderSelected=0,this.cities=[],this.districts=[],this.channels=[],this.services=[],this.statusList=[],this.cancelReasons=[],this.statusList=this.baseService.getTeamStatus(),this.GetCities(),this.GetServicesDropDown(),this.GetPaymentTypesDropDown(),this.GetChannels(),this.translateStatus(),this.GetReturnReasons()}GetReturnReasons(){this.cancelReasonService.getDropDown().subscribe(t=>{this.cancelReasons=t.data},t=>{console.log(t)})}translateStatus(){this.statusList.forEach(t=>{t.name=this.getTranslationText("orderManagement.order."+t.name)})}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetDistricts(t){this.finishOrderForm.districtCode=null,this.districtService.getByCityId(t).subscribe(i=>{this.districts=i.data},i=>{console.log(i)})}GetChannels(){this.channelService.getDropDown().subscribe(t=>{this.channels=t.data},t=>{console.log(t)})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,h.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){var t;if(this.ngxLoader.startLoader(_.a7),console.log(this.searchForm),null!=(t=this.searchForm.dates)&&"to"in t){const i=[t.from,t.to].map(n=>n);this.pagination.visitDateFrom=this.datePipe.transform(i[0],"yyyy-MM-ddT00:00:00"),this.pagination.visitDateTo=this.datePipe.transform(i[1],"yyyy-MM-ddT23:59:59.999")}else this.pagination.visitDateFrom=null,this.pagination.visitDateTo=null;if(null!=(t=this.searchForm.creationDates)&&"to"in t){const i=[t.from,t.to].map(n=>n);this.pagination.creationDateFrom=this.datePipe.transform(i[0],"yyyy-MM-ddT00:00:00"),this.pagination.creationDateTo=this.datePipe.transform(i[1],"yyyy-MM-ddT23:59:59.999")}else this.pagination.creationDateFrom=null,this.pagination.creationDateTo=null;this.pagination.subject=this.searchForm.name,null!=this.searchForm.status&&(this.pagination.status=Number.parseInt(this.searchForm.status)),null!=this.searchForm.priority&&(this.pagination.priority=Number.parseInt(this.searchForm.priority)),this.loadentities()}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.ngxLoader.startLoader("assignLoader"),this.pagination.statusFilter=this.OrderStatusEnum.Assigned,this.baseService.get(this.pagination).pipe((0,h.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader("assignLoader"),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader("assignLoader"),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({"Order Code":i.orderCode,"City Name":i.cityName,"District Name":i.districtName?i.districtName:"--","Agent Name":i.agentName,Mobile:i.mobile,"Assigned To":i.teamNames,Times:i.workTimes,Services:this.getServices(i.services),Status:this.translateService.instant(`orderManagement.order.${i.teamStatusName}`)})}),t}reCallOrder(){this.ngxLoader.startLoader(_.Fq),this.baseService.UpdateCallCounter(this.orderSelected).pipe((0,D.O)(),(0,O.c)(this.mainDelay),(0,w.Z)(),(0,h.Q)(this.notifier),(0,N.j)(()=>this.ngxLoader.stopLoader(_.Fq))).subscribe({next:t=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return t.isCancel?"bg-warning-subtle text-warning":t.isFinish?"bg-success-subtle text-success":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen||t.isFree?"bg-warning-subtle text-warning":"bg-success-subtle text-success"}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isFree?"orderManagement.order.free":"orderManagement.order.finished"}openModal(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}oncityChange(t){this.GetDistricts(t.code)}getTimes(t){return t.split(",")}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}getTeamStatus(t){return 0==t||1==t||2==t||3==t?"bg-info":4==t?"bg-success":5==t?"bg-danger":6==t?"bg-danger ":7==t?"bg-success":""}openChangeStatusModal(t,i,n="md"){this.form={},this.form.teamStatus=t.teamStatus,this.finishOrderForm.orderCode=t.orderCode,this.orderSelected=t.orderCode,this.modalService.open(i,{centered:!0,size:n})}changeStatus(){this.ngxLoader.startLoader(this.operationLoader),this.baseService.ChangeTeamStatus({OrderCode:this.orderSelected,teamStatus:this.form.teamStatus,cancelReasonCode:this.form.cancelReasonCode,teamStatusNotes:this.form.teamStatusNotes}).pipe((0,h.Q)(this.notifier),(0,N.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(i=>{this.loadentities(),this.alertService.success(),this.modalService.dismissAll()},()=>{this.alertService.error()})}finishOrder(){this.ngxLoader.startLoader(_.Fq);let t=this._formDataService.formatFormData(this.finishOrderForm);this.invoicesService.SaveInvoice(t).subscribe(i=>{this.ngxLoader.stopLoader(_.Fq),this.loadentities(),this.modalService.dismissAll()},i=>{console.log(i),this.ngxLoader.stopLoader(_.Fq)})}GetServicesDropDown(){this._servicesService.getDropDown().subscribe(t=>{this.services=t.data},t=>{console.log(t)})}GetOrderServiceAndPayment(t){this.finishOrderForm={},this.finishOrderDetails=t,this.finishOrderForm={...this.finishOrderForm,orderCode:t.orderCode,discountAdd:t.discountAmountAdd},this.invoicesService.GetOrderServiceAndPayment(t.orderCode).subscribe(n=>{this.finishOrderForm.invoiceService=[],this.OrderServiceAndPayment=n.data,n.data.forEach(a=>{this.finishOrderForm.invoiceService.push({serviceCode:a.serviceCode,service:a.serviceName,notes:a.notes,price:a.price,paidValue:a.paidValue})}),this.calculatePrices()},n=>{console.log(n)})}GetPaymentTypesDropDown(){this.baseService.GetOrderLookUp().subscribe(t=>{this.paymentTypes=t.data.paymentTypes},t=>{console.log(t)})}setService(t){console.log(t),this.finishOrderForm.service=t.name,this.finishOrderForm.price=t.price}addService(){this.finishOrderForm.invoiceService.push({service:this.finishOrderForm.service,serviceCode:this.finishOrderForm.serviceCode,price:this.finishOrderForm.price,notes:this.finishOrderForm.note,paidValue:0}),this.calculatePrices()}calculatePrices(){const t=this.finishOrderForm.discountAdd||0;let i=0,n=0;this.finishOrderForm.invoiceService.forEach(u=>{i+=+u.price,n+=+u.paidValue});let a=0,o=0,s=0;a=+(.15*(i-t)).toFixed(3),o=+(i-t+a).toFixed(3),s=+(o-n).toFixed(3),this.finishOrderForm={...this.finishOrderForm,net:o,tax:a,total:i,remain:s,paid:n}}editEachPrice(t){this.finishOrderForm.invoiceService[t].price=this.editPrice,this.isEditPrice=!1,this.calculatePrices()}deleteService(t){console.log(t),this.finishOrderForm.invoiceService.splice(t,1),this.calculatePrices()}onFileChanged(t){if(t.target.files&&t.target.files[0]){let i=t.target.files.length;for(let n=0;n<i;n++){let a=new FileReader;this.finishOrderForm.invoiceAttachImages.push({attachImage:t.target.files.item(n),type:"file"}),console.log(this.finishOrderForm.invoiceAttachImages),a.onload=o=>{this.images.push({id:0,path:o.target.result,completePath:o.target.result})},a.readAsDataURL(t.target.files[n])}}}removeImage(t,i){this.finishOrderForm.invoiceAttachImages.splice(i,1),this.images.splice(i,1)}getServices(t){return t.split("#")}OpenOrderTimeLineModel(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}RollBack(){this.ngxLoader.startLoader(_.Fq),this.baseService.RemoveAssign(this.orderSelected).pipe((0,D.O)(),(0,O.c)(this.mainDelay),(0,w.Z)(),(0,h.Q)(this.notifier),(0,N.j)(()=>this.ngxLoader.stopLoader(_.Fq))).subscribe({next:t=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(f.nX),e.rXU(g.c$),e.rXU(q.Q),e.rXU(y.u),e.rXU(c.vh),e.rXU(v.eD),e.rXU(m.Bq),e.rXU(A.J),e.rXU(Te.U),e.rXU(Se.N),e.rXU(L.V),e.rXU(he.Q),e.rXU(z.h),e.rXU(H.m),e.rXU(J.l),e.rXU(se.e),e.rXU(f.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-assigned-orders"]],viewQuery:function(i,n){if(1&i&&e.GBs(Fn,5),2&i){let a;e.mGM(a=e.lsd())&&(n.FileInput=a.first)}},features:[e.Vt3],decls:57,vars:52,consts:[["tableMaster",""],["changeStatusModal",""],["finishOrderModal",""],["orderModel",""],["OrderTimeLineModel",""],["RollBackModal",""],["formEntity","ngForm"],["serviceCode","ngModel"],["note","ngModel"],["paymentTypeCode","ngModel"],["notes","ngModel"],["FileInput",""],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"reset","search","exportXlsx","showAdd","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","agentName","name","agentName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","code","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","name","bindValue","code","bindLabel","name",3,"change","ngModelChange","placeholder","items","multiple","ngModel"],["name","employeeCode","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],[1,"col-12","col-md-4","mb-2"],["type","text","mwlFlatpickr","","id","isDate","mode","range",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["pSortableColumn","orderCode","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","cityId","translate","",2,"width","10%"],["pSortableColumn","agentName","translate","",2,"width","10%"],["translate","",2,"width","10%"],["translate","",2,"width","6%"],["pSortableColumn","visitDate","translate","",2,"width","8%"],["translate","",2,"width","12%"],["pSortableColumn","teamStatus","translate","",2,"width","10%"],[2,"width","20%"],[1,"fs-5"],[3,"click"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.order.nothing",4,"ngIf"],["class","badge bg-success-subtle text-success",4,"ngIf"],[1,"badge","bg-primary-subtle","text-primary","my-1"],[1,"cursor-pointer","badge","bg-danger-subtle","text-danger","fs-6",3,"click"],[1,"ri-clipboard-line"],[4,"ngFor","ngForOf"],[1,"mdi","mdi-circle-medium"],[1,"ri-history-fill","d-inline","text-primary","fs-16","align-middle","me-1",3,"click"],["type","button","class","btn btn-sm px-4 btn-primary   btn-label waves-effect waves-light rounded-pill mx-1",3,"click",4,"hasPermission"],[1,"d-inline"],[1,"dropdown-custom"],["tooltipPosition","top","type","button",1,"btn","dropbtn","btn-soft-secondary","btn-sm","dropdown-custom","arrow-none",3,"pTooltip"],[1,"ri-more-fill"],[1,"dropdown-menu","dropdown-menu-end","dropdown-content",2,"left","0"],[4,"hasPermission"],[3,"click",4,"hasPermission"],["translate","orderManagement.order.nothing",1,"badge","bg-danger-subtle","text-danger"],[1,"badge","bg-success-subtle","text-success"],[1,"badge","bg-primary-subtle","text-primary","mx-1"],["type","button",1,"btn","btn-sm","px-4","btn-primary","btn-label","waves-effect","waves-light","rounded-pill","mx-1",3,"click"],[1,"ri-swap-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","orderManagement.order.changeTeamStatus"],["href","javascript:void(0);",1,"dropdown-item",3,"click"],[1,"ri-exchange-box-fill","align-bottom","me-2","text-muted"],["translate","orderManagement.order.rollBackAssign"],["href","javascript:void(0);",1,"dropdown-item"],[1,"ri-checkbox-circle-fill","align-bottom","me-2","text-muted"],["translate","orderManagement.order.finishOrder"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["translate","orderManagement.order.changeTeamStatus",1,"fw-bold","fs-4"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"ngSubmit"],[1,"mb-3"],["for","actionMismatch","translate","",1,"fw-bold","form-label"],["name","teamStatus","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["class","mb-3",4,"ngIf"],["rows","2","InputTirmFilter","","name","teamStatusNotes","type","text","id","teamStatusNotes",1,"form-control","fs-6",3,"ngModelChange","ngModel"],[1,"text-center"],["type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["for","cancelReasonName","translate","",1,"required","fw-bold","form-label"],["name","name","bindValue","code","bindLabel","name","required","",3,"ngModelChange","placeholder","items","multiple","ngModel"],["translate","orderManagement.order.assignedOrders.finishOrder",1,"fw-bold","fs-4"],[1,"modal-content"],[1,"modal-body","p-1"],[1,"mt-2","row"],[1,"col-lg-2","mb-3"],["translate","",1,"fw-bold","form-label","w-100"],[1,"col-12","col-lg-4","mb-2"],["name","serviceCode","bindValue","code","bindLabel","name",3,"change","ngModelChange","items","multiple","placeholder","ngModel"],[1,"input-group"],["InputTirmFilter","","name","note","type","text","id","notes",1,"form-control","fs-6",3,"ngModelChange","placeholder","ngModel"],[1,"col-lg-2","mb-2"],[1,"btn","btn-success","py-1","px-2",3,"click"],[1,"ri-add-fill",2,"font-size","1.2rem"],[1,"col-12","text-center","mt-2"],[1,"table","table-bordered","table-service"],["translate",""],[4,"ngIf"],[1,"pt-2","row"],[1,"col-12","mb-3"],["role","alert",1,"alert","alert-success","alert-dismissible","material-shadow","alert-label-icon","rounded-label","fade","show"],[1,"ri-check-double-line","label-icon"],[1,"form-control","custom-form-textArea"],[1,"col-12","col-lg-6","mb-3","d-flex"],["translate","",1,"fw-bold","form-label","w-25"],[1,"form-control","w-75","custom-form-input"],["translate","",1,"fw-bold","form-label","required","w-25"],[1,"w-75"],["name","paymentTypeCode","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],[1,"col-12","col-lg-12","mb-3","d-flex"],["InputTirmFilter","","name","note","rows","2",1,"form-control","fs-6","w-75",3,"ngModelChange","placeholder","ngModel"],[1,"col-12","col-lg-12","mt-3","d-flex"],["translate","",1,"btn","btn-warning","px-5",3,"click"],[1,"my-3","d-flex"],["class","avatar-lg mx-2 position-relative",4,"ngFor","ngForOf"],["multiple","","value","","type","file","accept","image/png, image/gif, image/jpeg",1,"form-control","d-none",3,"change"],[1,"d-flex","gap-2","justify-content-end","my-0"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-success",3,"click","disabled"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-danger",3,"click"],["class","d-flex",4,"ngIf"],[1,"btn","btn-danger","py-1","px-2","me-1",3,"click"],[1,"ri-delete-bin-3-fill",2,"font-size","1.2rem"],[1,"ri-edit-2-fill",2,"font-size","1.2rem"],[1,"d-flex"],["InputTirmFilter","","name","editPrice","type","text","id","editPrice",1,"form-control","fs-6",3,"ngModelChange","placeholder","ngModel"],[1,"btn","btn-sm","btn-success","py-1","px-2","mx-1",3,"click"],[1,"ri-check-double-fill",2,"font-size","1.2rem"],[1,"btn","btn-sm","btn-danger","py-1","px-2",3,"click"],[1,"ri-close-fill",2,"font-size","1.2rem"],["colspan","4"],[1,"avatar-lg","mx-2","position-relative"],[1,"position-absolute","bx","bx-x-circle","text-white",2,"background","red","top","1px","right","-4px","font-size","1rem","border-radius","50%",3,"click"],[1,"avatar-title","bg-light","rounded"],["id","product-img1","alt","",1,"avatar-md","h-auto",3,"src"],[3,"isOrderEdit","isInner","orderCode"],[3,"dismiss","orderSelected"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",12)(1,"div",13)(2,"div",14),e.nrm(3,"ngx-ui-loader",15),e.j41(4,"base-filter",16),e.bIt("reset",function(){return e.eBV(a),e.Njj(n.onReset())})("search",function(){return e.eBV(a),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(n.onExportXlsx())}),e.qex(5,17),e.j41(6,"div",18)(7,"div",19)(8,"input",20),e.nI1(9,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.orderCode,s)||(n.pagination.orderCode=s),e.Njj(s)}),e.k0s(),e.nrm(10,"i",21),e.k0s()(),e.j41(11,"div",18)(12,"div",19)(13,"input",22),e.nI1(14,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.agentName,s)||(n.pagination.agentName=s),e.Njj(s)}),e.k0s(),e.nrm(15,"i",21),e.k0s()(),e.j41(16,"div",18)(17,"div",19)(18,"input",20),e.nI1(19,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.mobile,s)||(n.pagination.mobile=s),e.Njj(s)}),e.k0s(),e.nrm(20,"i",21),e.k0s()(),e.j41(21,"div",18)(22,"div",19)(23,"ng-select",23),e.nI1(24,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.channelCode,s)||(n.pagination.channelCode=s),e.Njj(s)}),e.k0s()()(),e.j41(25,"div",18)(26,"div",19)(27,"ng-select",24),e.nI1(28,"translate"),e.bIt("change",function(s){return e.eBV(a),e.Njj(n.oncityChange(s))}),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.cityCode,s)||(n.pagination.cityCode=s),e.Njj(s)}),e.k0s()()(),e.j41(29,"div",18)(30,"div",19)(31,"ng-select",25),e.nI1(32,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.districtName,s)||(n.pagination.districtName=s),e.Njj(s)}),e.k0s()()(),e.j41(33,"div",26)(34,"input",27),e.nI1(35,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.creationDates,s)||(n.searchForm.creationDates=s),e.Njj(s)}),e.k0s()(),e.j41(36,"div",26)(37,"input",27),e.nI1(38,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.dates,s)||(n.searchForm.dates=s),e.Njj(s)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(39,"div",28)(40,"div",29)(41,"p-table",30,0),e.bIt("onLazyLoad",function(s){return e.eBV(a),e.Njj(n.tableChange(s))})("selectionChange",function(s){return e.eBV(a),e.Njj(n.onSelectionChange(s))}),e.DNE(43,Sn,23,0,"ng-template",31)(44,wn,40,28,"ng-template",32),e.k0s()(),e.DNE(45,Vn,2,0,"div",33)(46,Gn,6,8,"div",34),e.k0s()()()(),e.DNE(47,$n,24,12,"ng-template",null,1,e.C5r)(49,Pn,113,35,"ng-template",null,2,e.C5r)(51,zn,1,3,"ng-template",null,3,e.C5r)(53,Hn,1,1,"ng-template",null,4,e.C5r)(55,Jn,15,3,"ng-template",null,5,e.C5r)}2&i&&(e.R7$(3),e.Y8G("loaderId","assignLoader"),e.R7$(),e.Y8G("showAdd",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,36,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.orderCode),e.R7$(5),e.FS9("placeholder",e.bMT(14,38,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.agentName),e.R7$(5),e.FS9("placeholder",e.bMT(19,40,"orderManagement.order.mobile")),e.R50("ngModel",n.pagination.mobile),e.R7$(5),e.FS9("placeholder",e.bMT(24,42,"orderManagement.order.channelName")),e.Y8G("items",n.channels)("multiple",!1),e.R50("ngModel",n.pagination.channelCode),e.R7$(4),e.FS9("placeholder",e.bMT(28,44,"orderManagement.order.cityName")),e.Y8G("items",n.cities)("multiple",!1),e.R50("ngModel",n.pagination.cityCode),e.R7$(4),e.FS9("placeholder",e.bMT(32,46,"orderManagement.order.districtName")),e.Y8G("items",n.districts)("multiple",!1),e.R50("ngModel",n.pagination.districtName),e.R7$(3),e.FS9("placeholder",e.bMT(35,48,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(3),e.FS9("placeholder",e.bMT(38,50,"orderManagement.order.visitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.dates),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[c.Sq,c.bT,d.qT,d.me,d.Q0,d.BC,d.cb,d.YS,d.vS,d.cV,m.s5,R.kL,$.b,Z.L,U.p,Y.g,g.Mm,C.XI,P.Ei,C.Tg,v.Cv,V.vr,B.m,ne.p,K.m,ee,c.vh,g.D9],encapsulation:2})}}return r})();var Qn=p(75312);const Wn=()=>["completed.print"],Kn=()=>["completed.reOpenOrder"];function Zn(r,l){1&r&&(e.j41(0,"tr",28)(1,"th",29),e.nrm(2,"i",30),e.EFF(3," orderManagement.order.orderCode "),e.k0s(),e.j41(4,"th",31),e.nrm(5,"i",30),e.EFF(6," orderManagement.order.creation "),e.k0s(),e.j41(7,"th",32),e.nrm(8,"i",30),e.EFF(9," orderManagement.order.cityName "),e.k0s(),e.j41(10,"th",33),e.nrm(11,"i",30),e.EFF(12," orderManagement.order.agentName "),e.k0s(),e.j41(13,"th",34),e.EFF(14," orderManagement.order.assignTo "),e.k0s(),e.j41(15,"th",34),e.EFF(16," orderManagement.order.workTimes "),e.k0s(),e.j41(17,"th",35),e.nrm(18,"i",30),e.EFF(19," orderManagement.order.visitDate "),e.k0s(),e.j41(20,"th",36),e.EFF(21," orderManagement.order.services "),e.k0s(),e.j41(22,"th",37),e.EFF(23," orderManagement.order.paymentTypeName "),e.k0s(),e.j41(24,"th",34),e.EFF(25," orderManagement.order.finishUser "),e.k0s(),e.j41(26,"th",37),e.EFF(27," orderManagement.order.cost "),e.k0s(),e.j41(28,"th",37),e.EFF(29," orderManagement.order.VAT "),e.k0s(),e.j41(30,"th",37),e.EFF(31," orderManagement.order.total "),e.k0s(),e.nrm(32,"th",38),e.k0s())}function ei(r,l){1&r&&e.nrm(0,"span",55)}function ti(r,l){if(1&r&&(e.j41(0,"span",41),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI("",t.districtName," ")}}function ni(r,l){if(1&r&&(e.qex(0),e.j41(1,"span",56),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=l.$implicit;e.R7$(2),e.JRh(t)}}function ii(r,l){if(1&r&&(e.qex(0),e.j41(1,"span",56),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=l.$implicit;e.R7$(2),e.JRh(t)}}function ri(r,l){if(1&r&&(e.qex(0),e.j41(1,"span",56),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=l.$implicit;e.R7$(2),e.JRh(t)}}function ai(r,l){if(1&r&&(e.nrm(0,"i",57),e.EFF(1),e.nI1(2,"date"),e.nrm(3,"br")(4,"i",58),e.EFF(5),e.nI1(6,"date"),e.nrm(7,"br")(8,"i",59),e.EFF(9)),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",e.i5U(2,3,t.createdDate,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",e.i5U(6,6,t.updatedDate,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",t.creatorName," ")}}function si(r,l){if(1&r){const t=e.RV6();e.j41(0,"li",40),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG();return e.Njj(a.openInNewTab(n.orderCode))}),e.j41(1,"span",60),e.nrm(2,"i",61)(3,"span",62),e.k0s()()}}function oi(r,l){if(1&r){const t=e.RV6();e.j41(0,"li",40),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(),o=e.sdS(46);return e.Njj(a.openModal(n.orderCode,o))}),e.j41(1,"span",60),e.nrm(2,"i",63)(3,"span",64),e.k0s()()}}function li(r,l){if(1&r){const t=e.RV6();e.j41(0,"tr",39)(1,"td",40),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),o=e.sdS(48);return e.Njj(a.openModal(n.orderCode,o,"xxl"))}),e.j41(2,"bdi"),e.EFF(3),e.k0s()(),e.j41(4,"td"),e.EFF(5),e.nI1(6,"date"),e.j41(7,"span",41),e.EFF(8),e.k0s()(),e.j41(9,"td"),e.EFF(10),e.DNE(11,ei,1,0,"span",42)(12,ti,2,1,"span",43),e.k0s(),e.j41(13,"td")(14,"span",44),e.EFF(15),e.k0s(),e.nrm(16,"br"),e.j41(17,"span",45),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.copytext(n.mobile))}),e.EFF(18),e.nrm(19,"i",46),e.k0s()(),e.j41(20,"td"),e.DNE(21,ni,4,1,"ng-container",47),e.k0s(),e.j41(22,"td"),e.DNE(23,ii,4,1,"ng-container",47),e.k0s(),e.j41(24,"td"),e.EFF(25),e.nI1(26,"date"),e.k0s(),e.j41(27,"td"),e.DNE(28,ri,4,1,"ng-container",47),e.k0s(),e.j41(29,"td"),e.EFF(30),e.k0s(),e.j41(31,"td"),e.EFF(32),e.k0s(),e.j41(33,"td"),e.EFF(34),e.k0s(),e.j41(35,"td"),e.EFF(36),e.k0s(),e.j41(37,"td")(38,"span",48),e.EFF(39),e.k0s()(),e.j41(40,"td"),e.DNE(41,ai,10,9,"ng-template",null,4,e.C5r),e.j41(43,"span",49)(44,"div",50)(45,"button",51),e.nrm(46,"i",52),e.k0s(),e.j41(47,"ul",53),e.DNE(48,si,4,0,"li",54)(49,oi,4,0,"li",54),e.k0s()()()()()}if(2&r){const t=l.$implicit,i=e.XpG();e.R7$(3),e.SpI("#SO#",t.orderCode,""),e.R7$(2),e.SpI("",e.i5U(6,19,t.createdDate,"yyyy-MM-dd")," "),e.R7$(3),e.SpI("",t.creationUser," "),e.R7$(2),e.SpI("",t.cityName," "),e.R7$(),e.Y8G("ngIf",null==t.districtName),e.R7$(),e.Y8G("ngIf",null!==t.districtName),e.R7$(3),e.SpI("",t.agentName," "),e.R7$(3),e.SpI("",t.mobile," "),e.R7$(3),e.Y8G("ngForOf",i.getTimes(t.teamNames)),e.R7$(2),e.Y8G("ngForOf",i.getTimes(t.workTimes)),e.R7$(2),e.SpI(" ",e.i5U(26,22,t.visitDate,"yyyy-MM-dd"),""),e.R7$(3),e.Y8G("ngForOf",i.getServices(t.services)),e.R7$(2),e.SpI(" ",t.paymentTypeName,""),e.R7$(2),e.SpI(" ",t.finishUser,""),e.R7$(2),e.SpI(" ",i.getCost(t.totalTaxNet,0)," "),e.R7$(2),e.SpI(" ",i.getCost(t.totalTaxNet,1)," "),e.R7$(3),e.JRh(i.getCost(t.totalTaxNet,2)),e.R7$(9),e.Y8G("hasPermission",e.lJ4(25,Wn)),e.R7$(),e.Y8G("hasPermission",e.lJ4(26,Kn))}}function di(r,l){1&r&&(e.j41(0,"div",65),e.EFF(1," general.table.noData "),e.k0s())}function mi(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",66)(1,"div",67),e.nrm(2,"ngb-pagination-info",68),e.j41(3,"table-length",69),e.bIt("lengthChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",70)(5,"ngb-pagination",71),e.bIt("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,n)||(a.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function ci(r,l){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",72),e.bIt("deleteConfirm",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.DeleteConfirm())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}}function pi(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",73)(1,"div",74)(2,"h4",75)(3,"span",76),e.EFF(4,"orderManagement.order.completeOrders.title"),e.k0s()(),e.j41(5,"button",77),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",78),e.nrm(7,"ngx-ui-loader",79),e.j41(8,"form",80,5),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onReopenOrder())}),e.j41(10,"div",6)(11,"div",81)(12,"label",82),e.EFF(13,"orderManagement.order.reopenOrder"),e.k0s(),e.j41(14,"ng-select",83),e.nI1(15,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.form.returnReasonCode,n)||(a.form.returnReasonCode=n),e.Njj(n)}),e.k0s()(),e.j41(16,"div",81)(17,"label",82),e.EFF(18,"orderManagement.order.reopenNotes"),e.k0s(),e.j41(19,"textarea",84),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.form.reopenNotes,n)||(a.form.reopenNotes=n),e.Njj(n)}),e.k0s()()(),e.j41(20,"div",85)(21,"button",86),e.nrm(22,"i",87)(23,"span",88),e.k0s()()()()()}if(2&r){const t=e.sdS(9),i=e.XpG();e.R7$(7),e.Y8G("hasProgressBar",!1)("fgsType",i.loaderOperationShap)("loaderId",i.operationLoader),e.R7$(7),e.FS9("placeholder",e.bMT(15,9,"orderManagement.order.returnReason")),e.Y8G("items",i.returnReasons)("multiple",!1),e.R50("ngModel",i.form.returnReasonCode),e.R7$(5),e.R50("ngModel",i.form.reopenNotes),e.R7$(2),e.Y8G("disabled",!t.valid)}}function gi(r,l){if(1&r&&e.nrm(0,"order-operation",89),2&r){const t=e.XpG();e.Y8G("isOrderEdit",!1)("isInner",!0)("orderCode",t.orderSelected)}}let _i=(()=>{class r extends G.w{constructor(t,i,n,a,o,s,b,u,j,F,x,T,I,X){super(t,i,b,n,a,o,s),this.baseService=n,this.authDaamService=u,this.excelService=j,this.cityService=F,this.districtService=x,this.channelService=T,this.returnReasonService=I,this.router=X,this.title="orderManagement.order.completeOrders.title",this.titleOperation="orderManagement.order.urgentOrders.titleOperation",this.language=localStorage.getItem("language"),this.keySelected="",this.assignUsers=[],this.times=[],this.employees=[],this.searchForm={},this.isResolveList=!0,this.employeeGroups=[],this.formPassword={},this.OrderStatusEnum=te,this.roles=[],this.userTypes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.countLoad=2,this.orderSelected=0,this.cities=[],this.districts=[],this.channels=[],this.returnReasons=[],this.GetCities(),this.GetReturnReasons()}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetDistricts(t){this.districtService.getByCityId(t).subscribe(i=>{this.districts=i.data},i=>{console.log(i)})}GetReturnReasons(){this.returnReasonService.getDropDown().subscribe(t=>{this.returnReasons=t.data},t=>{console.log(t)})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,h.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}openInNewTab(t){this.router.navigateByUrl("/orders-invoices",{state:{id:t}})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){var t;if(this.ngxLoader.startLoader(_.a7),console.log(this.searchForm),null!=(t=this.searchForm.dates)&&"to"in t){const i=[t.from,t.to].map(n=>n);this.pagination.visitDateFrom=this.datePipe.transform(i[0],"yyyy-MM-ddT00:00:00"),this.pagination.visitDateTo=this.datePipe.transform(i[1],"yyyy-MM-ddT23:59:59.999")}else this.pagination.visitDateFrom=null,this.pagination.visitDateTo=null;if(null!=(t=this.searchForm.creationDates)&&"to"in t){const i=[t.from,t.to].map(n=>n);this.pagination.creationDateFrom=this.datePipe.transform(i[0],"yyyy-MM-ddT00:00:00"),this.pagination.creationDateTo=this.datePipe.transform(i[1],"yyyy-MM-ddT23:59:59.999")}else this.pagination.creationDateFrom=null,this.pagination.creationDateTo=null;this.pagination.subject=this.searchForm.name,null!=this.searchForm.status&&(this.pagination.status=Number.parseInt(this.searchForm.status)),null!=this.searchForm.priority&&(this.pagination.priority=Number.parseInt(this.searchForm.priority)),this.loadentities()}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.ngxLoader.startLoader("completeLoader"),this.pagination.statusFilter=this.OrderStatusEnum.Finished,this.baseService.get(this.pagination).pipe((0,h.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader("completeLoader"),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader("completeLoader"),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({"Order Code":i.orderCode,"Created Date":i.createdDate,"Creation user":i.creationUser,"City Name":i.cityName,"District Name":i.districtName?i.districtName:"--","Agent Name":i.agentName,Mobile:i.mobile,"Assigned To":i.teamNames,Times:i.workTimes,"Visit Date":i.visitDate,Services:i.services,Payment:i.paymentTypeName,"Finished By":i.finishUser,Cost:this.getCost(i.totalTaxNet,0),Vat:this.getCost(i.totalTaxNet,1),Total:this.getCost(i.totalTaxNet,2)})}),t}reCallOrder(){this.ngxLoader.startLoader(_.Fq),this.baseService.UpdateCallCounter(this.orderSelected).pipe((0,D.O)(),(0,O.c)(this.mainDelay),(0,w.Z)(),(0,h.Q)(this.notifier),(0,N.j)(()=>this.ngxLoader.stopLoader(_.Fq))).subscribe({next:t=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return t.isCancel?"bg-warning-subtle text-warning":t.isFinish?"bg-success-subtle text-success":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen||t.isFree?"bg-warning-subtle text-warning":"bg-success-subtle text-success"}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isFree?"orderManagement.order.free":"orderManagement.order.finished"}openModal(t,i,n="md"){this.form={},this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}oncityChange(t){this.GetDistricts(t.code)}getTimes(t){return t.split(",")}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}getCost(t,i){return t.split("#")[i]}onReopenOrder(){let t={returnReasonCode:this.form.returnReasonCode,orderId:this.orderSelected};this.ngxLoader.startLoader(this.operationLoader),this.baseService.ReopenOrder(t).pipe((0,h.Q)(this.notifier)).subscribe(i=>{this.ngxLoader.stopLoader(this.operationLoader),i.success?(this.alertService.success(),this.modalService.dismissAll(),this.loadentities()):this.alertService.error()},()=>{this.alertService.error(),this.ngxLoader.stopLoader(this.operationLoader)})}getServices(t){return t.split("#")}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(f.nX),e.rXU(g.c$),e.rXU(q.Q),e.rXU(y.u),e.rXU(c.vh),e.rXU(v.eD),e.rXU(m.Bq),e.rXU(A.J),e.rXU(L.V),e.rXU(z.h),e.rXU(H.m),e.rXU(J.l),e.rXU(Qn.Y),e.rXU(f.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-complete-orders"]],features:[e.Vt3],decls:49,vars:46,consts:[["tableMaster",""],["deleteModal",""],["reopenOrder",""],["orderModel",""],["tooltipContent",""],["formEntity","ngForm"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"reset","search","exportXlsx","showAdd","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","agentName","name","agentName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","code","bindLabel","name",3,"change","ngModelChange","placeholder","items","multiple","ngModel"],["name","employeeCode","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],[1,"col-12","col-md-4","mb-2"],["type","text","mwlFlatpickr","","id","isDate","mode","range",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["pSortableColumn","orderCode","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","createdDate","translate","",2,"width","15%"],["pSortableColumn","cityId","translate","",2,"width","10%"],["pSortableColumn","agentName","translate","",2,"width","8%"],["translate","",2,"width","6%"],["pSortableColumn","visitDate","translate","",2,"width","8%"],["translate","",2,"width","10%"],["translate","",2,"width","5%"],[2,"width","15%"],[1,"fs-5"],[3,"click"],[1,"badge","bg-success-subtle","text-success"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.order.nothing",4,"ngIf"],["class","badge bg-success-subtle text-success",4,"ngIf"],[1,"badge","bg-primary-subtle","text-primary","my-1"],[1,"cursor-pointer","badge","bg-danger-subtle","text-danger","fs-6",3,"click"],[1,"ri-clipboard-line"],[4,"ngFor","ngForOf"],[1,"badge","bg-primary-subtle","text-primary","fs-5"],[1,"d-inline"],[1,"dropdown-custom"],["type","button",1,"btn","dropbtn","btn-soft-secondary","btn-sm","dropdown-custom","arrow-none"],[1,"ri-more-fill"],[1,"dropdown-menu","dropdown-menu-end","dropdown-content",2,"left","0"],[3,"click",4,"hasPermission"],["translate","orderManagement.order.nothing",1,"badge","bg-danger-subtle","text-danger"],[1,"badge","bg-primary-subtle","text-primary","mx-1"],[1,"ri-history-fill","text-warning"],[1,"ri-history-fill","text-danger"],[1,"ri-user-location-fill","text-primary"],[1,"dropdown-item"],[1,"ri-printer-line","align-bottom","me-2","text-muted"],["translate","orderManagement.order.printPill"],[1,"ri-exchange-fill","align-bottom","me-2","text-muted"],["translate","orderManagement.order.reopenOrder"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"deleteConfirm","dismiss"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["translate","",1,"fw-bold","fs-4"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"ngSubmit"],[1,"mb-3"],["for","actionMismatch","translate","",1,"fw-bold","form-label"],["name","name","bindValue","code","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["rows","2","InputTirmFilter","","name","reopenNotes","type","text","id","reopenNotes",1,"form-control","fs-6",3,"ngModelChange","ngModel"],[1,"text-center"],["type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],[3,"isOrderEdit","isInner","orderCode"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",6)(1,"div",7)(2,"div",8),e.nrm(3,"ngx-ui-loader",9),e.j41(4,"base-filter",10),e.bIt("reset",function(){return e.eBV(a),e.Njj(n.onReset())})("search",function(){return e.eBV(a),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(n.onExportXlsx())}),e.qex(5,11),e.j41(6,"div",12)(7,"div",13)(8,"input",14),e.nI1(9,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.orderCode,s)||(n.pagination.orderCode=s),e.Njj(s)}),e.k0s(),e.nrm(10,"i",15),e.k0s()(),e.j41(11,"div",12)(12,"div",13)(13,"input",16),e.nI1(14,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.agentName,s)||(n.pagination.agentName=s),e.Njj(s)}),e.k0s(),e.nrm(15,"i",15),e.k0s()(),e.j41(16,"div",12)(17,"div",13)(18,"input",14),e.nI1(19,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.mobile,s)||(n.pagination.mobile=s),e.Njj(s)}),e.k0s(),e.nrm(20,"i",15),e.k0s()(),e.j41(21,"div",12)(22,"div",13)(23,"ng-select",17),e.nI1(24,"translate"),e.bIt("change",function(s){return e.eBV(a),e.Njj(n.oncityChange(s))}),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.cityCode,s)||(n.pagination.cityCode=s),e.Njj(s)}),e.k0s()()(),e.j41(25,"div",12)(26,"div",13)(27,"ng-select",18),e.nI1(28,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.districtName,s)||(n.pagination.districtName=s),e.Njj(s)}),e.k0s()()(),e.j41(29,"div",19)(30,"input",20),e.nI1(31,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.creationDates,s)||(n.searchForm.creationDates=s),e.Njj(s)}),e.k0s()(),e.j41(32,"div",19)(33,"input",20),e.nI1(34,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.dates,s)||(n.searchForm.dates=s),e.Njj(s)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(35,"div",21)(36,"div",22)(37,"p-table",23,0),e.bIt("onLazyLoad",function(s){return e.eBV(a),e.Njj(n.tableChange(s))})("selectionChange",function(s){return e.eBV(a),e.Njj(n.onSelectionChange(s))}),e.DNE(39,Zn,33,0,"ng-template",24)(40,li,50,27,"ng-template",25),e.k0s()(),e.DNE(41,di,2,0,"div",26)(42,mi,6,8,"div",27),e.k0s()()()(),e.DNE(43,ci,1,0,"ng-template",null,1,e.C5r)(45,pi,24,11,"ng-template",null,2,e.C5r)(47,gi,1,3,"ng-template",null,3,e.C5r)}2&i&&(e.R7$(3),e.Y8G("loaderId","completeLoader"),e.R7$(),e.Y8G("showAdd",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,32,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.orderCode),e.R7$(5),e.FS9("placeholder",e.bMT(14,34,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.agentName),e.R7$(5),e.FS9("placeholder",e.bMT(19,36,"orderManagement.order.mobile")),e.R50("ngModel",n.pagination.mobile),e.R7$(5),e.FS9("placeholder",e.bMT(24,38,"orderManagement.order.cityName")),e.Y8G("items",n.cities)("multiple",!1),e.R50("ngModel",n.pagination.cityCode),e.R7$(4),e.FS9("placeholder",e.bMT(28,40,"orderManagement.order.districtName")),e.Y8G("items",n.districts)("multiple",!1),e.R50("ngModel",n.pagination.districtName),e.R7$(3),e.FS9("placeholder",e.bMT(31,42,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(3),e.FS9("placeholder",e.bMT(34,44,"orderManagement.order.visitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.dates),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[c.Sq,c.bT,d.qT,d.me,d.Q0,d.BC,d.cb,d.vS,d.cV,m.s5,R.kL,$.b,Z.L,ae.w,U.p,Y.g,g.Mm,C.XI,P.Ei,C.Tg,v.Cv,V.vr,B.m,ne.p,c.vh,g.D9],encapsulation:2})}}return r})();function hi(r,l){1&r&&(e.j41(0,"tr",26)(1,"th",27),e.nrm(2,"i",28),e.EFF(3," orderManagement.order.orderCode "),e.k0s(),e.j41(4,"th",29),e.nrm(5,"i",28),e.EFF(6," orderManagement.order.creation "),e.k0s(),e.j41(7,"th",30),e.nrm(8,"i",28),e.EFF(9," orderManagement.order.cityName "),e.k0s(),e.j41(10,"th",31),e.nrm(11,"i",28),e.EFF(12," orderManagement.order.agentName "),e.k0s(),e.j41(13,"th",32),e.EFF(14," orderManagement.order.assignTo "),e.k0s(),e.j41(15,"th",32),e.EFF(16," orderManagement.order.workTimes "),e.k0s(),e.j41(17,"th",33),e.nrm(18,"i",28),e.EFF(19," orderManagement.order.visitDate "),e.k0s(),e.j41(20,"th",34),e.EFF(21," orderManagement.order.services "),e.k0s(),e.j41(22,"th",35),e.EFF(23," orderManagement.order.cancelReasonName "),e.k0s(),e.nrm(24,"th",36),e.k0s())}function ui(r,l){1&r&&e.nrm(0,"span",47)}function bi(r,l){if(1&r&&(e.j41(0,"span",38),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI("",t.districtName," ")}}function fi(r,l){if(1&r&&(e.qex(0),e.j41(1,"span",48),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=l.$implicit;e.R7$(2),e.JRh(t)}}function vi(r,l){if(1&r&&(e.qex(0),e.j41(1,"span",48),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=l.$implicit;e.R7$(2),e.JRh(t)}}function Ci(r,l){if(1&r&&(e.qex(0),e.j41(1,"span",48),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=l.$implicit;e.R7$(2),e.JRh(t)}}function ji(r,l){if(1&r){const t=e.RV6();e.j41(0,"tr",37)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.nI1(5,"date"),e.j41(6,"span",38),e.EFF(7),e.k0s()(),e.j41(8,"td"),e.EFF(9),e.DNE(10,ui,1,0,"span",39)(11,bi,2,1,"span",40),e.k0s(),e.j41(12,"td")(13,"span",41),e.EFF(14),e.k0s(),e.nrm(15,"br"),e.j41(16,"span",42),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.copytext(n.mobile))}),e.EFF(17),e.nrm(18,"i",43),e.k0s()(),e.j41(19,"td"),e.DNE(20,fi,4,1,"ng-container",44),e.k0s(),e.j41(21,"td"),e.DNE(22,vi,4,1,"ng-container",44),e.k0s(),e.j41(23,"td"),e.EFF(24),e.nI1(25,"date"),e.k0s(),e.j41(26,"td"),e.DNE(27,Ci,4,1,"ng-container",44),e.k0s(),e.j41(28,"td"),e.EFF(29),e.k0s(),e.j41(30,"td")(31,"div",45)(32,"i",46),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),o=e.sdS(50);return e.Njj(a.OpenOrderTimeLineModel(n,o,"lg"))}),e.k0s()()()()}if(2&r){const t=l.$implicit,i=e.XpG();e.R7$(2),e.SpI("#SO#",t.orderCode,""),e.R7$(2),e.SpI("",e.i5U(5,13,t.createdDate,"yyyy-MM-dd HH:mm")," "),e.R7$(3),e.SpI("",t.creationUser," "),e.R7$(2),e.SpI("",t.cityName," "),e.R7$(),e.Y8G("ngIf",null==t.districtName),e.R7$(),e.Y8G("ngIf",null!==t.districtName),e.R7$(3),e.SpI("",t.agentName," "),e.R7$(3),e.SpI("",t.mobile," "),e.R7$(3),e.Y8G("ngForOf",i.getTimes(t.teamNames)),e.R7$(2),e.Y8G("ngForOf",i.getTimes(t.workTimes)),e.R7$(2),e.SpI(" ",e.i5U(25,16,t.visitDate,"yyyy-MM-dd"),""),e.R7$(3),e.Y8G("ngForOf",i.getServices(t.services)),e.R7$(2),e.SpI(" ",t.cancelReasonName,"")}}function Fi(r,l){1&r&&(e.j41(0,"div",49),e.EFF(1," general.table.noData "),e.k0s())}function Mi(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",50)(1,"div",51),e.nrm(2,"ngb-pagination-info",52),e.j41(3,"table-length",53),e.bIt("lengthChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",54)(5,"ngb-pagination",55),e.bIt("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,n)||(a.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function xi(r,l){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",56),e.bIt("deleteConfirm",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.DeleteConfirm())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}}function Ti(r,l){if(1&r){const t=e.RV6();e.j41(0,"order-timeline",57),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderSelected",t.orderSelected)}}let Si=(()=>{class r extends G.w{constructor(t,i,n,a,o,s,b,u,j,F,x,T,I){super(t,i,b,n,a,o,s),this.baseService=n,this.authDaamService=u,this.excelService=j,this.cityService=F,this.districtService=x,this.channelService=T,this.router=I,this.title="orderManagement.order.refundable",this.titleOperation="orderManagement.order.refundable",this.language=localStorage.getItem("language"),this.keySelected="",this.assignUsers=[],this.times=[],this.employees=[],this.searchForm={},this.isResolveList=!0,this.formPassword={},this.OrderStatusEnum=te,this.roles=[],this.userTypes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.countLoad=2,this.orderSelected=0,this.cities=[],this.districts=[],this.channels=[],this.GetCities(),this.GetChannels()}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetDistricts(t){this.districtService.getByCityId(t).subscribe(i=>{this.districts=i.data},i=>{console.log(i)})}GetChannels(){this.channelService.getDropDown().subscribe(t=>{this.channels=t.data},t=>{console.log(t)})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,h.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){var t;if(this.ngxLoader.startLoader(_.a7),console.log(this.searchForm),null!=(t=this.searchForm.dates)&&"to"in t){const i=[t.from,t.to].map(n=>n);this.pagination.visitDateFrom=this.datePipe.transform(i[0],"yyyy-MM-ddT00:00:00"),this.pagination.visitDateTo=this.datePipe.transform(i[1],"yyyy-MM-ddT23:59:59.999")}else this.pagination.visitDateFrom=null,this.pagination.visitDateTo=null;if(null!=(t=this.searchForm.creationDates)&&"to"in t){const i=[t.from,t.to].map(n=>n);this.pagination.creationDateFrom=this.datePipe.transform(i[0],"yyyy-MM-ddT00:00:00"),this.pagination.creationDateTo=this.datePipe.transform(i[1],"yyyy-MM-ddT23:59:59.999")}else this.pagination.creationDateFrom=null,this.pagination.creationDateTo=null;this.pagination.subject=this.searchForm.name,null!=this.searchForm.status&&(this.pagination.status=Number.parseInt(this.searchForm.status)),null!=this.searchForm.priority&&(this.pagination.priority=Number.parseInt(this.searchForm.priority)),this.loadentities()}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.ngxLoader.startLoader("cancalLoader"),this.pagination.statusFilter=this.OrderStatusEnum.Canceled,this.baseService.get(this.pagination).pipe((0,h.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader("cancalLoader"),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader("cancalLoader"),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({"Order Code":i.orderCode,"Created Date":i.createdDate,"Creation user":i.creationUser,"City Name":i.cityName,"District Name":i.districtName?i.districtName:"--",Status:this.translateService.instant(this.getTrnslate(i)),"Agent Name":i.agentName,Mobile:i.mobile,"Assigned To":i.teamNames,Times:i.workTimes,"Visit Date":i.visitDate,Services:i.services})}),t}reCallOrder(){this.ngxLoader.startLoader(_.Fq),this.baseService.UpdateCallCounter(this.orderSelected).pipe((0,D.O)(),(0,O.c)(this.mainDelay),(0,w.Z)(),(0,h.Q)(this.notifier),(0,N.j)(()=>this.ngxLoader.stopLoader(_.Fq))).subscribe({next:t=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return t.isCancel?"bg-warning-subtle text-warning":t.isFinish?"bg-success-subtle text-success":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen||t.isFree?"bg-warning-subtle text-warning":"bg-success-subtle text-success"}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isFree?"orderManagement.order.free":"orderManagement.order.finished"}openModal(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}oncityChange(t){this.GetDistricts(t.code)}getTimes(t){return t.split(",")}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}getServices(t){return t.split("#")}OpenOrderTimeLineModel(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(f.nX),e.rXU(g.c$),e.rXU(q.Q),e.rXU(y.u),e.rXU(c.vh),e.rXU(v.eD),e.rXU(m.Bq),e.rXU(A.J),e.rXU(L.V),e.rXU(z.h),e.rXU(H.m),e.rXU(J.l),e.rXU(f.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-refundable-orders"]],features:[e.Vt3],decls:51,vars:52,consts:[["tableMaster",""],["deleteModal",""],["OrderTimeLineModel",""],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"reset","search","exportXlsx","showAdd","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","agentName","name","agentName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","code","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","name","bindValue","code","bindLabel","name",3,"change","ngModelChange","placeholder","items","multiple","ngModel"],["name","employeeCode","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],[1,"col-12","col-md-4","mb-2"],["type","text","mwlFlatpickr","","id","isDate","mode","range",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["pSortableColumn","orderCode","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","createdDate","translate","",2,"width","15%"],["pSortableColumn","cityId","translate","",2,"width","10%"],["pSortableColumn","agentName","translate","",2,"width","10%"],["translate","",2,"width","10%"],["pSortableColumn","visitDate","translate","",2,"width","8%"],["translate","",2,"width","20%"],["translate","",2,"width","15%"],[2,"width","10%"],[1,"fs-5"],[1,"badge","bg-success-subtle","text-success"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.order.nothing",4,"ngIf"],["class","badge bg-success-subtle text-success",4,"ngIf"],[1,"badge","bg-primary-subtle","text-primary","my-1"],[1,"cursor-pointer","badge","bg-danger-subtle","text-danger","fs-6",3,"click"],[1,"ri-clipboard-line"],[4,"ngFor","ngForOf"],[1,"d-inline"],[1,"ri-history-fill","d-inline","text-primary","fs-16","align-middle","me-1",3,"click"],["translate","orderManagement.order.nothing",1,"badge","bg-danger-subtle","text-danger"],[1,"badge","bg-primary-subtle","text-primary","mx-1"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"deleteConfirm","dismiss"],[3,"dismiss","orderSelected"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",3)(1,"div",4)(2,"div",5),e.nrm(3,"ngx-ui-loader",6),e.j41(4,"base-filter",7),e.bIt("reset",function(){return e.eBV(a),e.Njj(n.onReset())})("search",function(){return e.eBV(a),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(n.onExportXlsx())}),e.qex(5,8),e.j41(6,"div",9)(7,"div",10)(8,"input",11),e.nI1(9,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.orderCode,s)||(n.pagination.orderCode=s),e.Njj(s)}),e.k0s(),e.nrm(10,"i",12),e.k0s()(),e.j41(11,"div",9)(12,"div",10)(13,"input",13),e.nI1(14,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.agentName,s)||(n.pagination.agentName=s),e.Njj(s)}),e.k0s(),e.nrm(15,"i",12),e.k0s()(),e.j41(16,"div",9)(17,"div",10)(18,"input",11),e.nI1(19,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.mobile,s)||(n.pagination.mobile=s),e.Njj(s)}),e.k0s(),e.nrm(20,"i",12),e.k0s()(),e.j41(21,"div",9)(22,"div",10)(23,"ng-select",14),e.nI1(24,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.channelCode,s)||(n.pagination.channelCode=s),e.Njj(s)}),e.k0s()()(),e.j41(25,"div",9)(26,"div",10)(27,"ng-select",15),e.nI1(28,"translate"),e.bIt("change",function(s){return e.eBV(a),e.Njj(n.oncityChange(s))}),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.cityCode,s)||(n.pagination.cityCode=s),e.Njj(s)}),e.k0s()()(),e.j41(29,"div",9)(30,"div",10)(31,"ng-select",16),e.nI1(32,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.districtName,s)||(n.pagination.districtName=s),e.Njj(s)}),e.k0s()()(),e.j41(33,"div",17)(34,"input",18),e.nI1(35,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.creationDates,s)||(n.searchForm.creationDates=s),e.Njj(s)}),e.k0s()(),e.j41(36,"div",17)(37,"input",18),e.nI1(38,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.dates,s)||(n.searchForm.dates=s),e.Njj(s)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(39,"div",19)(40,"div",20)(41,"p-table",21,0),e.bIt("onLazyLoad",function(s){return e.eBV(a),e.Njj(n.tableChange(s))})("selectionChange",function(s){return e.eBV(a),e.Njj(n.onSelectionChange(s))}),e.DNE(43,hi,25,0,"ng-template",22)(44,ji,33,19,"ng-template",23),e.k0s()(),e.DNE(45,Fi,2,0,"div",24)(46,Mi,6,8,"div",25),e.k0s()()()(),e.DNE(47,xi,1,0,"ng-template",null,1,e.C5r)(49,Ti,1,1,"ng-template",null,2,e.C5r)}2&i&&(e.R7$(3),e.Y8G("loaderId","cancalLoader"),e.R7$(),e.Y8G("showAdd",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,36,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.orderCode),e.R7$(5),e.FS9("placeholder",e.bMT(14,38,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.agentName),e.R7$(5),e.FS9("placeholder",e.bMT(19,40,"orderManagement.order.mobile")),e.R50("ngModel",n.pagination.mobile),e.R7$(5),e.FS9("placeholder",e.bMT(24,42,"orderManagement.order.channelName")),e.Y8G("items",n.channels)("multiple",!1),e.R50("ngModel",n.pagination.channelCode),e.R7$(4),e.FS9("placeholder",e.bMT(28,44,"orderManagement.order.cityName")),e.Y8G("items",n.cities)("multiple",!1),e.R50("ngModel",n.pagination.cityCode),e.R7$(4),e.FS9("placeholder",e.bMT(32,46,"orderManagement.order.districtName")),e.Y8G("items",n.districts)("multiple",!1),e.R50("ngModel",n.pagination.districtName),e.R7$(3),e.FS9("placeholder",e.bMT(35,48,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(3),e.FS9("placeholder",e.bMT(38,50,"orderManagement.order.visitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.dates),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[c.Sq,c.bT,d.me,d.Q0,d.BC,d.vS,m.s5,R.kL,$.b,ae.w,U.p,Y.g,g.Mm,C.XI,P.Ei,C.Tg,v.Cv,V.vr,B.m,ee,c.vh,g.D9],encapsulation:2})}}return r})();const Ii=()=>["reopen.assignTeam"],ki=()=>["reopen.cancel"];function yi(r,l){1&r&&(e.j41(0,"tr",27)(1,"th",28),e.nrm(2,"i",29),e.EFF(3," orderManagement.order.orderCode "),e.k0s(),e.j41(4,"th",30),e.nrm(5,"i",29),e.EFF(6," orderManagement.order.creation "),e.k0s(),e.j41(7,"th",31),e.nrm(8,"i",29),e.EFF(9," orderManagement.order.cityName "),e.k0s(),e.j41(10,"th",32),e.nrm(11,"i",29),e.EFF(12," orderManagement.order.agentName "),e.k0s(),e.j41(13,"th",33),e.EFF(14," orderManagement.order.assignTo "),e.k0s(),e.j41(15,"th",33),e.EFF(16," orderManagement.order.workTimes "),e.k0s(),e.j41(17,"th",34),e.nrm(18,"i",29),e.EFF(19," orderManagement.order.visitDate "),e.k0s(),e.j41(20,"th",35),e.EFF(21," orderManagement.order.services "),e.k0s(),e.j41(22,"th",35),e.EFF(23," orderManagement.order.returnReasonName "),e.k0s(),e.nrm(24,"th",36),e.k0s())}function Ri(r,l){1&r&&e.nrm(0,"span",50)}function Ei(r,l){if(1&r&&(e.j41(0,"span",39),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI("",t.districtName," ")}}function Ni(r,l){if(1&r&&(e.qex(0),e.j41(1,"span",51),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=l.$implicit;e.R7$(2),e.JRh(t)}}function Di(r,l){if(1&r&&(e.qex(0),e.j41(1,"span",51),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.bVm()),2&r){const t=l.$implicit;e.R7$(2),e.JRh(t)}}function Oi(r,l){if(1&r){const t=e.RV6();e.j41(0,"button",52),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(),o=e.sdS(50);return e.Njj(a.openEditOrderModal(n.orderCode,o,"xxl"))}),e.nrm(2,"i",53),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"orderManagement.order.reAssign"))}function wi(r,l){if(1&r){const t=e.RV6();e.j41(0,"button",54),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(),o=e.sdS(48);return e.Njj(a.openModal(n.orderCode,o))}),e.nrm(2,"i",55),e.k0s()}2&r&&e.FS9("pTooltip",e.bMT(1,1,"orderManagement.order.cancelOrder"))}function Vi(r,l){if(1&r){const t=e.RV6();e.j41(0,"tr",37)(1,"td",38),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),o=e.sdS(50);return e.Njj(a.openModal(n.orderCode,o,"xxl"))}),e.j41(2,"bdi"),e.EFF(3),e.k0s()(),e.j41(4,"td"),e.EFF(5),e.nI1(6,"date"),e.j41(7,"span",39),e.EFF(8),e.k0s()(),e.j41(9,"td"),e.EFF(10),e.DNE(11,Ri,1,0,"span",40)(12,Ei,2,1,"span",41),e.k0s(),e.j41(13,"td")(14,"span",42),e.EFF(15),e.k0s(),e.nrm(16,"br"),e.j41(17,"span",43),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.copytext(n.mobile))}),e.EFF(18),e.nrm(19,"i",44),e.k0s()(),e.j41(20,"td"),e.DNE(21,Ni,4,1,"ng-container",45),e.k0s(),e.j41(22,"td"),e.DNE(23,Di,4,1,"ng-container",45),e.k0s(),e.j41(24,"td"),e.EFF(25),e.nI1(26,"date"),e.k0s(),e.j41(27,"td"),e.EFF(28),e.k0s(),e.j41(29,"td"),e.EFF(30),e.k0s(),e.j41(31,"td")(32,"div",46)(33,"i",47),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),o=e.sdS(52);return e.Njj(a.OpenOrderTimeLineModel(n,o,"lg"))}),e.k0s(),e.DNE(34,Oi,3,3,"button",48)(35,wi,3,3,"button",49),e.k0s()()()}if(2&r){const t=l.$implicit,i=e.XpG();e.R7$(3),e.SpI("#SO#",t.orderCode,""),e.R7$(2),e.SpI("",e.i5U(6,15,t.createdDate,"yyyy-MM-dd")," "),e.R7$(3),e.SpI("",t.creationUser," "),e.R7$(2),e.SpI("",t.cityName," "),e.R7$(),e.Y8G("ngIf",null==t.districtName),e.R7$(),e.Y8G("ngIf",null!==t.districtName),e.R7$(3),e.SpI("",t.agentName," "),e.R7$(3),e.SpI("",t.mobile," "),e.R7$(3),e.Y8G("ngForOf",i.getTimes(t.teamNames)),e.R7$(2),e.Y8G("ngForOf",i.getTimes(t.workTimes)),e.R7$(2),e.SpI(" ",e.i5U(26,18,t.visitDate,"yyyy-MM-dd"),""),e.R7$(3),e.SpI(" ",t.services,""),e.R7$(2),e.SpI(" ",t.returnReasonName,""),e.R7$(4),e.Y8G("hasPermission",e.lJ4(21,Ii)),e.R7$(),e.Y8G("hasPermission",e.lJ4(22,ki))}}function Gi(r,l){1&r&&(e.j41(0,"div",56),e.EFF(1," general.table.noData "),e.k0s())}function Li(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",57)(1,"div",58),e.nrm(2,"ngb-pagination-info",59),e.j41(3,"table-length",60),e.bIt("lengthChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",61)(5,"ngb-pagination",62),e.bIt("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,n)||(a.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function $i(r,l){if(1&r){const t=e.RV6();e.j41(0,"cancel-order-model",63),e.bIt("success",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.loadentities())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderId",t.orderSelected)}}function Bi(r,l){if(1&r&&e.nrm(0,"order-operation",64),2&r){const t=e.XpG();e.Y8G("isReopen",!0)("isOrderEdit",!0)("isInner",!0)("orderCode",t.orderSelected)}}function Xi(r,l){if(1&r){const t=e.RV6();e.j41(0,"order-timeline",65),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderSelected",t.orderSelected)}}let Ai=(()=>{class r extends G.w{constructor(t,i,n,a,o,s,b,u,j,F,x,T,I){super(t,i,b,n,a,o,s),this.baseService=n,this.authDaamService=u,this.excelService=j,this.cityService=F,this.districtService=x,this.channelService=T,this.router=I,this.title="orderManagement.order.reopenTitle",this.titleOperation="orderManagement.order.reopenTitle",this.language=localStorage.getItem("language"),this.keySelected="",this.assignUsers=[],this.times=[],this.employees=[],this.searchForm={},this.isResolveList=!0,this.formPassword={},this.OrderStatusEnum=te,this.roles=[],this.userTypes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.countLoad=2,this.orderSelected=0,this.cities=[],this.districts=[],this.channels=[],this.isOrderEdit=!0,this.GetCities(),this.GetChannels()}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetDistricts(t){this.districtService.getByCityId(t).subscribe(i=>{this.districts=i.data},i=>{console.log(i)})}GetChannels(){this.channelService.getDropDown().subscribe(t=>{this.channels=t.data},t=>{console.log(t)})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,h.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){var t;if(this.ngxLoader.startLoader(_.a7),console.log(this.searchForm),null!=(t=this.searchForm.dates)&&"to"in t){const i=[t.from,t.to].map(n=>n);this.pagination.visitDateFrom=this.datePipe.transform(i[0],"yyyy-MM-ddT00:00:00"),this.pagination.visitDateTo=this.datePipe.transform(i[1],"yyyy-MM-ddT23:59:59.999")}else this.pagination.visitDateFrom=null,this.pagination.visitDateTo=null;if(null!=(t=this.searchForm.creationDates)&&"to"in t){const i=[t.from,t.to].map(n=>n);this.pagination.creationDateFrom=this.datePipe.transform(i[0],"yyyy-MM-ddT00:00:00"),this.pagination.creationDateTo=this.datePipe.transform(i[1],"yyyy-MM-ddT23:59:59.999")}else this.pagination.creationDateFrom=null,this.pagination.creationDateTo=null;this.pagination.subject=this.searchForm.name,null!=this.searchForm.status&&(this.pagination.status=Number.parseInt(this.searchForm.status)),null!=this.searchForm.priority&&(this.pagination.priority=Number.parseInt(this.searchForm.priority)),this.loadentities()}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.ngxLoader.startLoader("reopenLoader"),this.pagination.statusFilter=this.OrderStatusEnum.Reopened,this.baseService.get(this.pagination).pipe((0,h.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader("reopenLoader"),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader("reopenLoader"),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({"Order Code":i.orderCode,"Created Date":i.createdDate,"Creation user":i.creationUser,"City Name":i.cityName,"District Name":i.districtName?i.districtName:"--","Agent Name":i.agentName,Mobile:i.mobile,"Assigned To":i.teamNames,Times:i.workTimes,"Visit Date":i.visitDate,Services:i.services,Reason:i.returnReasonName})}),t}reCallOrder(){this.ngxLoader.startLoader(_.Fq),this.baseService.UpdateCallCounter(this.orderSelected).pipe((0,D.O)(),(0,O.c)(this.mainDelay),(0,w.Z)(),(0,h.Q)(this.notifier),(0,N.j)(()=>this.ngxLoader.stopLoader(_.Fq))).subscribe({next:t=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return t.isCancel?"bg-warning-subtle text-warning":t.isFinish?"bg-success-subtle text-success":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen||t.isFree?"bg-warning-subtle text-warning":"bg-success-subtle text-success"}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isFree?"orderManagement.order.free":"orderManagement.order.finished"}openModal(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}oncityChange(t){this.GetDistricts(t.code)}getTimes(t){return t.split(",")}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}openEditOrderModal(t,i,n="md"){this.form={},this.isOrderEdit=!0,this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}OpenOrderTimeLineModel(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(f.nX),e.rXU(g.c$),e.rXU(q.Q),e.rXU(y.u),e.rXU(c.vh),e.rXU(v.eD),e.rXU(m.Bq),e.rXU(A.J),e.rXU(L.V),e.rXU(z.h),e.rXU(H.m),e.rXU(J.l),e.rXU(f.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["reopen-order"]],features:[e.Vt3],decls:53,vars:52,consts:[["tableMaster",""],["deleteModal",""],["orderModel",""],["OrderTimeLineModel",""],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"reset","search","exportXlsx","showAdd","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","agentName","name","agentName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","code","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","name","bindValue","code","bindLabel","name",3,"change","ngModelChange","placeholder","items","multiple","ngModel"],["name","employeeCode","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],[1,"col-12","col-md-4","mb-2"],["type","text","mwlFlatpickr","","id","isDate","mode","range",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["pSortableColumn","orderCode","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["pSortableColumn","createdDate","translate","",2,"width","15%"],["pSortableColumn","cityId","translate","",2,"width","10%"],["pSortableColumn","agentName","translate","",2,"width","8%"],["translate","",2,"width","6%"],["pSortableColumn","visitDate","translate","",2,"width","8%"],["translate","",2,"width","15%"],[2,"width","10%"],[1,"fs-5"],[3,"click"],[1,"badge","bg-success-subtle","text-success"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.order.nothing",4,"ngIf"],["class","badge bg-success-subtle text-success",4,"ngIf"],[1,"badge","bg-primary-subtle","text-primary","my-1"],[1,"cursor-pointer","badge","bg-danger-subtle","text-danger","fs-6",3,"click"],[1,"ri-clipboard-line"],[4,"ngFor","ngForOf"],[1,"d-inline"],[1,"ri-history-fill","d-inline","text-primary","fs-16","align-middle","me-1",3,"click"],["tooltipPosition","top","class","mt-1 btn btn-sm btn-primary  mx-1","data-bs-toggle","modal",3,"pTooltip","click",4,"hasPermission"],["tooltipPosition","top","class","mt-1 btn btn-sm btn-soft-danger remove-list  mx-1",3,"pTooltip","click",4,"hasPermission"],["translate","orderManagement.order.nothing",1,"badge","bg-danger-subtle","text-danger"],[1,"badge","bg-primary-subtle","text-primary","mx-1"],["tooltipPosition","top","data-bs-toggle","modal",1,"mt-1","btn","btn-sm","btn-primary","mx-1",3,"click","pTooltip"],[1,"ri-checkbox-circle-line","align-bottom"],["tooltipPosition","top",1,"mt-1","btn","btn-sm","btn-soft-danger","remove-list","mx-1",3,"click","pTooltip"],[1,"ri-delete-bin-5-fill","align-bottom"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"success","dismiss","orderId"],[3,"isReopen","isOrderEdit","isInner","orderCode"],[3,"dismiss","orderSelected"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",4)(1,"div",5)(2,"div",6),e.nrm(3,"ngx-ui-loader",7),e.j41(4,"base-filter",8),e.bIt("reset",function(){return e.eBV(a),e.Njj(n.onReset())})("search",function(){return e.eBV(a),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(n.onExportXlsx())}),e.qex(5,9),e.j41(6,"div",10)(7,"div",11)(8,"input",12),e.nI1(9,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.orderCode,s)||(n.pagination.orderCode=s),e.Njj(s)}),e.k0s(),e.nrm(10,"i",13),e.k0s()(),e.j41(11,"div",10)(12,"div",11)(13,"input",14),e.nI1(14,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.agentName,s)||(n.pagination.agentName=s),e.Njj(s)}),e.k0s(),e.nrm(15,"i",13),e.k0s()(),e.j41(16,"div",10)(17,"div",11)(18,"input",12),e.nI1(19,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.mobile,s)||(n.pagination.mobile=s),e.Njj(s)}),e.k0s(),e.nrm(20,"i",13),e.k0s()(),e.j41(21,"div",10)(22,"div",11)(23,"ng-select",15),e.nI1(24,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.channelCode,s)||(n.pagination.channelCode=s),e.Njj(s)}),e.k0s()()(),e.j41(25,"div",10)(26,"div",11)(27,"ng-select",16),e.nI1(28,"translate"),e.bIt("change",function(s){return e.eBV(a),e.Njj(n.oncityChange(s))}),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.cityCode,s)||(n.pagination.cityCode=s),e.Njj(s)}),e.k0s()()(),e.j41(29,"div",10)(30,"div",11)(31,"ng-select",17),e.nI1(32,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.districtName,s)||(n.pagination.districtName=s),e.Njj(s)}),e.k0s()()(),e.j41(33,"div",18)(34,"input",19),e.nI1(35,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.creationDates,s)||(n.searchForm.creationDates=s),e.Njj(s)}),e.k0s()(),e.j41(36,"div",18)(37,"input",19),e.nI1(38,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.dates,s)||(n.searchForm.dates=s),e.Njj(s)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(39,"div",20)(40,"div",21)(41,"p-table",22,0),e.bIt("onLazyLoad",function(s){return e.eBV(a),e.Njj(n.tableChange(s))})("selectionChange",function(s){return e.eBV(a),e.Njj(n.onSelectionChange(s))}),e.DNE(43,yi,25,0,"ng-template",23)(44,Vi,36,23,"ng-template",24),e.k0s()(),e.DNE(45,Gi,2,0,"div",25)(46,Li,6,8,"div",26),e.k0s()()()(),e.DNE(47,$i,1,1,"ng-template",null,1,e.C5r)(49,Bi,1,4,"ng-template",null,2,e.C5r)(51,Xi,1,1,"ng-template",null,3,e.C5r)}2&i&&(e.R7$(3),e.Y8G("loaderId","reopenLoader"),e.R7$(),e.Y8G("showAdd",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,36,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.orderCode),e.R7$(5),e.FS9("placeholder",e.bMT(14,38,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.agentName),e.R7$(5),e.FS9("placeholder",e.bMT(19,40,"orderManagement.order.mobile")),e.R50("ngModel",n.pagination.mobile),e.R7$(5),e.FS9("placeholder",e.bMT(24,42,"orderManagement.order.channelName")),e.Y8G("items",n.channels)("multiple",!1),e.R50("ngModel",n.pagination.channelCode),e.R7$(4),e.FS9("placeholder",e.bMT(28,44,"orderManagement.order.cityName")),e.Y8G("items",n.cities)("multiple",!1),e.R50("ngModel",n.pagination.cityCode),e.R7$(4),e.FS9("placeholder",e.bMT(32,46,"orderManagement.order.districtName")),e.Y8G("items",n.districts)("multiple",!1),e.R50("ngModel",n.pagination.districtName),e.R7$(3),e.FS9("placeholder",e.bMT(35,48,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(3),e.FS9("placeholder",e.bMT(38,50,"orderManagement.order.visitDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.dates),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[c.Sq,c.bT,d.me,d.Q0,d.BC,d.vS,m.s5,R.kL,$.b,Z.L,U.p,Y.g,g.Mm,C.XI,P.Ei,C.Tg,v.Cv,V.vr,B.m,ne.p,K.m,_e,ee,c.vh,g.D9]})}}return r})();const Ui=()=>["order.view"],Yi=()=>["newOrder.view"],Pi=()=>["urgented.view"],zi=()=>["confirmed.view"],Hi=()=>["assigned.view"],Ji=()=>["completed.view"],qi=()=>["reopen.view"],Qi=()=>["canceled.view"];function Wi(r,l){1&r&&e.nrm(0,"app-all-order")}function Ki(r,l){1&r&&(e.j41(0,"li",6)(1,"a",7),e.nrm(2,"span",8),e.k0s(),e.DNE(3,Wi,1,0,"ng-template",9),e.k0s()),2&r&&e.Y8G("ngbNavItem",1)}function Zi(r,l){1&r&&e.nrm(0,"app-new-orders")}function er(r,l){1&r&&(e.j41(0,"li",6)(1,"a",7),e.nrm(2,"span",10),e.k0s(),e.DNE(3,Zi,1,0,"ng-template",9),e.k0s()),2&r&&e.Y8G("ngbNavItem",2)}function tr(r,l){1&r&&e.nrm(0,"app-urgent-orders")}function nr(r,l){1&r&&(e.j41(0,"li",6)(1,"a",7),e.nrm(2,"span",11),e.k0s(),e.DNE(3,tr,1,0,"ng-template",9),e.k0s()),2&r&&e.Y8G("ngbNavItem",3)}function ir(r,l){1&r&&e.nrm(0,"app-sure-orders")}function rr(r,l){1&r&&(e.j41(0,"li",6)(1,"a",7),e.nrm(2,"span",12),e.k0s(),e.DNE(3,ir,1,0,"ng-template",9),e.k0s()),2&r&&e.Y8G("ngbNavItem",4)}function ar(r,l){1&r&&e.nrm(0,"app-assigned-orders")}function sr(r,l){1&r&&(e.j41(0,"li",6)(1,"a",7),e.nrm(2,"span",13),e.k0s(),e.DNE(3,ar,1,0,"ng-template",9),e.k0s()),2&r&&e.Y8G("ngbNavItem",5)}function or(r,l){1&r&&e.nrm(0,"app-complete-orders")}function lr(r,l){1&r&&(e.j41(0,"li",6)(1,"a",7),e.nrm(2,"span",14),e.k0s(),e.DNE(3,or,1,0,"ng-template",9),e.k0s()),2&r&&e.Y8G("ngbNavItem",6)}function dr(r,l){1&r&&e.nrm(0,"reopen-order")}function mr(r,l){1&r&&(e.j41(0,"li",6)(1,"a",7),e.nrm(2,"span",15),e.k0s(),e.DNE(3,dr,1,0,"ng-template",9),e.k0s()),2&r&&e.Y8G("ngbNavItem",7)}function cr(r,l){1&r&&e.nrm(0,"app-refundable-orders")}function pr(r,l){1&r&&(e.j41(0,"li",6)(1,"a",7),e.nrm(2,"span",16),e.k0s(),e.DNE(3,cr,1,0,"ng-template",9),e.k0s()),2&r&&e.Y8G("ngbNavItem",8)}let gr=(()=>{class r extends G.w{constructor(t,i,n,a,o,s,b,u){super(t,i,b,n,a,o,s),this.baseService=n,this.authDaamService=u,this.title="orderManagement.order.title",this.titleOperation="orderManagement.order.titleOperation",this.active=1,this.activeindex="1"}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(f.nX),e.rXU(g.c$),e.rXU(q.Q),e.rXU(y.u),e.rXU(c.vh),e.rXU(v.eD),e.rXU(m.Bq),e.rXU(A.J))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-all-order-types"]],features:[e.Vt3],decls:13,vars:18,consts:[["nav","ngbNav"],[1,"row"],[1,"col-lg-12"],["ngbNav","",1,"nav","nav-tabs-custom","card-header-tabs","border-bottom-0",3,"activeIdChange","navChange","activeId"],[3,"ngbNavItem",4,"hasPermission"],[1,"mt-2",3,"ngbNavOutlet"],[3,"ngbNavItem"],["ngbNavLink",""],["translate","orderManagement.order.all"],["ngbNavContent",""],["translate","orderManagement.order.newOrders.title"],["translate","orderManagement.order.urgentOrders.title"],["translate","orderManagement.order.sureOrders.title"],["translate","orderManagement.order.assignedOrders.title"],["translate","orderManagement.order.completeOrders.title"],["translate","orderManagement.order.reopenTitle"],["translate","orderManagement.order.refundableOrders.title"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"ul",3,0),e.mxI("activeIdChange",function(s){return e.eBV(a),e.DH7(n.active,s)||(n.active=s),e.Njj(s)}),e.bIt("navChange",function(s){return e.eBV(a),e.Njj(n.onNavChange(s))}),e.DNE(4,Ki,4,1,"li",4)(5,er,4,1,"li",4)(6,nr,4,1,"li",4)(7,rr,4,1,"li",4)(8,sr,4,1,"li",4)(9,lr,4,1,"li",4)(10,mr,4,1,"li",4)(11,pr,4,1,"li",4),e.k0s(),e.nrm(12,"div",5),e.k0s()()}if(2&i){const a=e.sdS(3);e.R7$(2),e.R50("activeId",n.active),e.R7$(2),e.Y8G("hasPermission",e.lJ4(10,Ui)),e.R7$(),e.Y8G("hasPermission",e.lJ4(11,Yi)),e.R7$(),e.Y8G("hasPermission",e.lJ4(12,Pi)),e.R7$(),e.Y8G("hasPermission",e.lJ4(13,zi)),e.R7$(),e.Y8G("hasPermission",e.lJ4(14,Hi)),e.R7$(),e.Y8G("hasPermission",e.lJ4(15,Ji)),e.R7$(),e.Y8G("hasPermission",e.lJ4(16,qi)),e.R7$(),e.Y8G("hasPermission",e.lJ4(17,Qi)),e.R7$(),e.Y8G("ngbNavOutlet",a)}},dependencies:[m.Um,m.X9,m.sy,m.Gx,m.Ri,m.WA,m.m_,g.Mm,ne.p,st,St,qt,jn,qn,_i,Si,Ai],encapsulation:2})}}return r})();var ue=p(26364),_r=p(80388);let hr=(()=>{class r{constructor(){this.title="orderManagement.timeAvailable.title"}ngOnInit(){}onTimeSelected(t){console.log(t)}static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-timeAvailable"]],decls:3,vars:4,consts:[[3,"title","breadcrumbItems"],[3,"onTimeSelected"]],template:function(i,n){1&i&&(e.nrm(0,"app-breadcrumbs",0),e.nI1(1,"translate"),e.j41(2,"time-available",1),e.bIt("onTimeSelected",function(o){return n.onTimeSelected(o)}),e.k0s()),2&i&&(e.FS9("title",e.bMT(1,2,n.title)),e.Y8G("breadcrumbItems",n.breadCrumbItems))},dependencies:[ue.m,_r.h,g.D9]})}}return r})();var oe=p(71100),de=p(50949);let me=(()=>{class r{constructor(t,i,n,a){this.cancelReasonService=t,this.orderService=i,this.ngxLoader=n,this.alertService=a,this.cancelReasons=[],this.form={},this.orderId=0,this.loaderOperationShap=_.$$,this.operationLoader=_.ZW,this.notifier=new xe.B,this.success=new e.bkB,this.dismiss=new e.bkB}ngOnInit(){this.GetReturnReasons()}GetReturnReasons(){this.cancelReasonService.getDropDown().subscribe(t=>{this.cancelReasons=t.data},t=>{console.log(t)})}onCancelOrder(){let t={cancelReasonCode:this.form.cancelReasonCode,id:this.orderId};this.ngxLoader.startLoader(this.operationLoader),this.orderService.RemoveEvaluateOrder(t).pipe((0,h.Q)(this.notifier)).subscribe(i=>{this.ngxLoader.stopLoader(this.operationLoader),i.success?(this.alertService.success(),this.success.emit(!0),this.dismiss.emit(!0)):this.alertService.error()},()=>{this.alertService.error(),this.ngxLoader.stopLoader(this.operationLoader)})}dismissFn(){this.dismiss.emit(!0)}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(se.e),e.rXU(oe.W),e.rXU(v.eD),e.rXU(y.u))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["cancel-evaluation-model"]],inputs:{orderId:"orderId"},outputs:{success:"success",dismiss:"dismiss"},decls:19,vars:10,consts:[["formEntity","ngForm"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["translate","orderManagement.order.cancelReasonName",1,"fw-bold","fs-4"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"ngSubmit"],[1,"row"],[1,"mb-3"],["for","actionMismatch","translate","",1,"fw-bold","form-label"],["name","name","bindValue","code","bindLabel","name","required","",3,"ngModelChange","placeholder","items","multiple","ngModel"],[1,"text-center"],["type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"h4",3),e.nrm(3,"span",4),e.k0s(),e.j41(4,"button",5),e.bIt("click",function(){return e.eBV(a),e.Njj(n.dismissFn())}),e.k0s()(),e.j41(5,"div",6),e.nrm(6,"ngx-ui-loader",7),e.j41(7,"form",8,0),e.bIt("ngSubmit",function(){return e.eBV(a),e.Njj(n.onCancelOrder())}),e.j41(9,"div",9)(10,"div",10)(11,"label",11),e.EFF(12,"orderManagement.order.cancelReasonName"),e.k0s(),e.j41(13,"ng-select",12),e.nI1(14,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.form.cancelReasonCode,s)||(n.form.cancelReasonCode=s),e.Njj(s)}),e.k0s()()(),e.j41(15,"div",13)(16,"button",14),e.nrm(17,"i",15)(18,"span",16),e.k0s()()()()()}if(2&i){const a=e.sdS(8);e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",n.loaderOperationShap)("loaderId",n.operationLoader),e.R7$(7),e.FS9("placeholder",e.bMT(14,8,"orderManagement.order.cancelReasonName")),e.Y8G("items",n.cancelReasons)("multiple",!1),e.R50("ngModel",n.form.cancelReasonCode),e.R7$(3),e.Y8G("disabled",!a.valid)}},dependencies:[d.qT,d.BC,d.cb,d.YS,d.vS,d.cV,g.Mm,v.Cv,V.vr,g.D9],encapsulation:2})}}return r})();function ur(r,l){1&r&&(e.j41(0,"tr",29)(1,"th",30),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",31),e.nrm(4,"i",32),e.EFF(5," orderManagement.order.orderCode "),e.k0s(),e.j41(6,"th",33),e.EFF(7," general.table.creationTime "),e.k0s(),e.j41(8,"th",34),e.EFF(9," orderManagement.order.agentName "),e.k0s(),e.j41(10,"th",34),e.EFF(11," orderManagement.order.mobile "),e.k0s(),e.j41(12,"th",35),e.EFF(13," orderManagement.order.cityName "),e.k0s(),e.j41(14,"th",35),e.EFF(15," orderManagement.order.districtName "),e.k0s(),e.j41(16,"th",35),e.EFF(17," orderManagement.priceEvaluation.status "),e.k0s(),e.nrm(18,"th",36),e.k0s())}function br(r,l){1&r&&e.nrm(0,"span",52)}function fr(r,l){if(1&r&&(e.j41(0,"span",53),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI("",t.districtName," ")}}function vr(r,l){1&r&&e.nrm(0,"span",54)}function Cr(r,l){1&r&&e.nrm(0,"span",55)}function jr(r,l){if(1&r&&(e.nrm(0,"i",56),e.EFF(1),e.nI1(2,"date"),e.nrm(3,"br")(4,"i",57),e.EFF(5)),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",e.i5U(2,2,t.createdDate,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",t.name," ")}}function Fr(r,l){if(1&r){const t=e.RV6();e.j41(0,"tr",37)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.nI1(7,"date"),e.j41(8,"span",38),e.EFF(9),e.k0s()(),e.j41(10,"td"),e.EFF(11),e.k0s(),e.j41(12,"td")(13,"span",39),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.copytext(n.mobile))}),e.EFF(14),e.nrm(15,"i",40),e.k0s()(),e.j41(16,"td"),e.EFF(17),e.k0s(),e.j41(18,"td"),e.DNE(19,br,1,0,"span",41)(20,fr,2,1,"span",42),e.k0s(),e.j41(21,"td"),e.DNE(22,vr,1,0,"span",43)(23,Cr,1,0,"span",44),e.k0s(),e.j41(24,"td"),e.DNE(25,jr,6,5,"ng-template",null,3,e.C5r),e.nrm(27,"i",45),e.j41(28,"button",46),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),o=e.sdS(43);return a.getEvalById(n.evaluationCode),e.Njj(a.openModal(n.evaluationCode,o,"lg"))}),e.nrm(29,"i",47)(30,"span",48),e.k0s(),e.j41(31,"button",49),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),o=e.sdS(41);return e.Njj(a.openModal(n.evaluationCode,o))}),e.nrm(32,"i",50)(33,"span",51),e.k0s()()()}if(2&r){const t=l.$implicit,i=l.rowIndex,n=e.sdS(26);e.R7$(2),e.JRh(i+1),e.R7$(2),e.SpI(" ",t.evaluationCode,""),e.R7$(2),e.SpI("",e.i5U(7,12,t.createdDate,"yyyy-MM-dd HH:mm")," "),e.R7$(3),e.SpI("",t.createdBy," "),e.R7$(2),e.JRh(t.agentName),e.R7$(3),e.SpI("",t.mobile," "),e.R7$(3),e.JRh(t.cityName),e.R7$(2),e.Y8G("ngIf",""==t.districtName),e.R7$(),e.Y8G("ngIf",""!==t.districtName),e.R7$(2),e.Y8G("ngIf",t.isUrgent),e.R7$(),e.Y8G("ngIf",!t.isUrgent),e.R7$(4),e.Y8G("ngbTooltip",n)}}function Mr(r,l){1&r&&(e.j41(0,"div",58),e.EFF(1," general.table.noData "),e.k0s())}function xr(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",59)(1,"div",60),e.nrm(2,"ngb-pagination-info",61),e.j41(3,"table-length",62),e.bIt("lengthChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",63)(5,"ngb-pagination",64),e.bIt("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,n)||(a.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function Tr(r,l){if(1&r){const t=e.RV6();e.j41(0,"cancel-evaluation-model",65),e.bIt("success",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.loadentities())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderId",t.orderSelected)}}function Sr(r,l){if(1&r&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s()()),2&r){const t=l.$implicit;e.R7$(2),e.JRh(t.serviceCode),e.R7$(2),e.JRh(t.price),e.R7$(2),e.JRh(t.notes)}}function Ir(r,l){1&r&&(e.j41(0,"tr")(1,"td",99),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&r&&(e.R7$(2),e.JRh(e.bMT(3,1,"orderManagement.order.noData")))}function kr(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",66)(1,"h4",67),e.nrm(2,"span",68),e.k0s(),e.j41(3,"button",69),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(4,"form",null,4),e.nrm(6,"ngx-ui-loader",70),e.j41(7,"div",71)(8,"div",72)(9,"div",73)(10,"div",7)(11,"div",74)(12,"label",75),e.EFF(13,"orderManagement.order.cityName"),e.k0s(),e.j41(14,"div",76),e.EFF(15),e.k0s()(),e.j41(16,"div",74)(17,"label",75),e.EFF(18,"orderManagement.order.districtName"),e.k0s(),e.j41(19,"div",76),e.EFF(20),e.k0s()(),e.j41(21,"div",74)(22,"label",77),e.EFF(23,"orderManagement.order.date"),e.k0s(),e.j41(24,"div",76),e.EFF(25),e.nI1(26,"date"),e.k0s()()(),e.j41(27,"div",78)(28,"div",79)(29,"table",80)(30,"thead")(31,"tr")(32,"th",81),e.EFF(33," orderManagement.order.service "),e.k0s(),e.j41(34,"th",81),e.EFF(35," orderManagement.order.price "),e.k0s(),e.j41(36,"th",81),e.EFF(37," orderManagement.order.notes "),e.k0s()()(),e.j41(38,"tbody"),e.DNE(39,Sr,7,3,"tr",82)(40,Ir,4,3,"tr",83),e.k0s()()()(),e.j41(41,"div",84)(42,"div",85)(43,"label",86),e.EFF(44),e.nI1(45,"translate"),e.k0s(),e.j41(46,"span",87),e.EFF(47),e.nI1(48,"translate"),e.nI1(49,"translate"),e.k0s()(),e.j41(50,"div",88)(51,"label",89),e.EFF(52,"orderManagement.order.notes"),e.k0s(),e.j41(53,"span",90),e.EFF(54),e.k0s()(),e.j41(55,"div",91)(56,"label",92),e.EFF(57,"orderManagement.order.assignDate"),e.k0s(),e.j41(58,"div",93)(59,"input",94,5),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.assignForm.assignDate,n)||(a.assignForm.assignDate=n),e.Njj(n)}),e.k0s()()(),e.j41(61,"div",91)(62,"label",92),e.EFF(63,"orderManagement.order.team"),e.k0s(),e.j41(64,"ng-select",95,6),e.nI1(66,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.assignForm.teamCode,n)||(a.assignForm.teamCode=n),e.Njj(n)}),e.k0s()()(),e.j41(67,"div",96)(68,"button",97),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.ChangeAssignTeam())}),e.k0s(),e.j41(69,"button",98),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()()}if(2&r){const t=e.XpG();e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader),e.R7$(9),e.SpI(" ",t.evaluationDetails.cityName||"--"," "),e.R7$(5),e.SpI(" ",t.evaluationDetails.districtName||"--"," "),e.R7$(5),e.SpI(" ",e.i5U(26,16,t.evaluationDetails.visitDate,"yyyy-MM-dd")||"--"," "),e.R7$(14),e.Y8G("ngForOf",t.evaluationDetails.evaluationservices),e.R7$(),e.Y8G("ngIf",!t.evaluationDetails.evaluationservices),e.R7$(4),e.SpI(" ",e.bMT(45,19,"orderManagement.order.isUrgent")," "),e.R7$(3),e.SpI(" ",t.evaluationDetails.isUrgent?e.bMT(48,21,"orderManagement.order.yes"):e.bMT(49,23,"orderManagement.order.no")," "),e.R7$(7),e.SpI(" ",t.evaluationDetails.notes||"--"," "),e.R7$(5),e.R50("ngModel",t.assignForm.assignDate),e.R7$(5),e.FS9("placeholder",e.bMT(66,25,"orderManagement.order.team")),e.Y8G("items",t.teams)("multiple",!1),e.R50("ngModel",t.assignForm.teamCode)}}let yr=(()=>{class r extends G.w{constructor(t,i,n,a,o,s,b,u,j,F,x,T,I,X){super(t,i,u,n,o,s,b),this.baseService=n,this.orderPendingService=a,this.authDaamService=j,this.excelService=F,this.cityService=x,this.districtService=T,this.channelService=I,this.router=X,this.title="orderManagement.priceEvaluation.title",this.titleOperation="orderManagement.priceEvaluation.titleOperation",this.keySelected="",this.assignUsers=[],this.times=[],this.teams=[],this.employees=[],this.searchForm={},this.assignForm={},this.isResolveList=!1,this.activeindex="1",this.active=1,this.formPassword={},this.roles=[],this.userTypes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.countLoad=3,this.orderSelected=0,this.selectedCallCounter=0,this.cities=[],this.districts=[],this.channels=[],this.callHistory={},this.GetCities(),this.getEvalTeams()}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetDistricts(t){this.districtService.getByCityId(t).subscribe(i=>{this.districts=i.data},i=>{console.log(i)})}GetChannels(){this.channelService.getDropDown().subscribe(t=>{this.channels=t.data},t=>{console.log(t)})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,h.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){var t;if(this.ngxLoader.startLoader(_.a7),console.log(this.searchForm),null!=(t=this.searchForm.dates)&&"to"in t){const i=[t.from,t.to].map(n=>n);this.pagination.visitDateFrom=this.datePipe.transform(i[0],"yyyy-MM-ddT00:00:00"),this.pagination.visitDateTo=this.datePipe.transform(i[1],"yyyy-MM-ddT23:59:59.999")}else this.pagination.visitDateFrom=null,this.pagination.visitDateTo=null;if(null!=(t=this.searchForm.creationDates)&&"to"in t){const i=[t.from,t.to].map(n=>n);this.pagination.creationDateFrom=this.datePipe.transform(i[0],"yyyy-MM-ddT00:00:00"),this.pagination.creationDateTo=this.datePipe.transform(i[1],"yyyy-MM-ddT23:59:59.999")}else this.pagination.creationDateFrom=null,this.pagination.creationDateTo=null;this.pagination.subject=this.searchForm.name,null!=this.searchForm.status&&(this.pagination.status=Number.parseInt(this.searchForm.status)),null!=this.searchForm.priority&&(this.pagination.priority=Number.parseInt(this.searchForm.priority)),this.loadentities()}onReset(){this.form={},this.searchForm={},this.pagination={pageSize:10,pageNumber:1,totalItems:this.pagination.totalItems}}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.ngxLoader.startLoader("priceEvalLoader"),this.pagination.isEvaluationPrice=!0,this.baseService.get(this.pagination).pipe((0,h.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader("priceEvalLoader"),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader("priceEvalLoader"),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({orderCode:i.orderCode,visitDate:i.visitDate,notes:i.notes,createdDate:i.createdDate,assignDate:i.assignDate,finishDate:i.finishDate,districtName:i.districtName,cityName:i.cityName,agentName:i.agentName,mobile:i.mobile,email:i.email,creationUser:i.creationUser,channelName:i.channelName,teamNames:i.teamNames,services:i.services,workTimes:i.workTimes,paymentTypeName:i.paymentTypeName,finishUser:i.finishUser,isCancel:i.isCancel,isReopen:i.isReopen,isFree:i.isFree,isFinish:i.isFinish})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,"User",[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}goRegister(){this.router.navigateByUrl("/managment/order/new")}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return t.isCancel?"bg-warning-subtle text-warning":t.isFinish?"bg-success-subtle text-success":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen||t.isFree?"bg-warning-subtle text-warning":"bg-success-subtle text-success"}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isFree?"orderManagement.order.free":"orderManagement.order.finished"}openModal(t,i,n="md"){this.orderSelected=t,this.assignForm.code=t,this.modalService.open(i,{centered:!0,size:n})}oncityChange(t){this.GetDistricts(t.code)}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}getEvalById(t){this.baseService.getById(t).subscribe(i=>{this.evaluationDetails=i.data},()=>{this.alertService.error()})}getEvalTeams(){this.baseService.EvaluationLookUp().subscribe(t=>{this.teams=t.data.teams},()=>{this.alertService.error()})}ChangeAssignTeam(){this.ngxLoader.startLoader(_.Fq),this.baseService.ChangeAssignTeam(this.assignForm).subscribe(t=>{this.ngxLoader.stopLoader(_.Fq),this.loadentities(),this.modalService.dismissAll(),t.success?this.alertService.success():this.alertService.error("general.message."+t.message)},()=>{this.alertService.error()})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(f.nX),e.rXU(g.c$),e.rXU(oe.W),e.rXU(de.H),e.rXU(y.u),e.rXU(c.vh),e.rXU(v.eD),e.rXU(m.Bq),e.rXU(A.J),e.rXU(L.V),e.rXU(z.h),e.rXU(H.m),e.rXU(J.l),e.rXU(f.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["priceEvaluation"]],features:[e.Vt3],decls:44,vars:41,consts:[["tableMaster",""],["deleteModal",""],["evaluateModal",""],["tooltipContent",""],["formEntity","ngForm"],["assignDate","ngModel"],["teamCode","ngModel"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"reset","search","exportXlsx","addNew","showAllStr","showAdd","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","agentName","name","agentName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","code","bindLabel","name",3,"change","ngModelChange","placeholder","items","multiple","ngModel"],["name","employeeCode","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],[1,"col-12","col-md-4","mb-2"],["type","text","mwlFlatpickr","","id","isDate","mode","range",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["translate","",2,"width",".5%"],["pSortableColumn","orderCode","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["translate","",2,"width","12%"],["translate","",2,"width","10%"],["translate","",2,"width","8%"],["translate","",2,"width","15%"],[1,"fs-5"],[1,"badge","bg-primary-subtle","text-primary"],[1,"cursor-pointer","badge","bg-danger-subtle","text-danger","fs-6",3,"click"],[1,"ri-clipboard-line"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.order.nothing",4,"ngIf"],["class","badge bg-success-subtle text-success",4,"ngIf"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.priceEvaluation.isUrgent",4,"ngIf"],["class","badge bg-success-subtle text-success","translate","orderManagement.priceEvaluation.normal",4,"ngIf"],["tooltipPosition","top",1,"d-inline","text-primary","fs-10",3,"ngbTooltip"],["type","button",1,"btn","btn-sm","btn-success","w-sm","btn-label","waves-effect","waves-light","rounded-pill","p-0","py-1",3,"click"],[1,"ri-user-follow-fill","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","orderManagement.priceEvaluation.assign"],["type","button",1,"btn","btn-sm","btn-danger","w-sm","btn-label","waves-effect","waves-light","rounded-pill","p-0","mx-1","py-1",3,"click"],[1,"ri-chat-delete-fill","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","orderManagement.priceEvaluation.cancel"],["translate","orderManagement.order.nothing",1,"badge","bg-danger-subtle","text-danger"],[1,"badge","bg-success-subtle","text-success"],["translate","orderManagement.priceEvaluation.isUrgent",1,"badge","bg-danger-subtle","text-danger"],["translate","orderManagement.priceEvaluation.normal",1,"badge","bg-success-subtle","text-success"],[1,"ri-history-fill","text-warning"],[1,"ri-user-location-fill","text-primary"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"success","dismiss","orderId"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["translate","orderManagement.priceEvaluation.title",1,"fw-bold","fs-4"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-body"],[1,"mx-4"],[1,"col-12","col-md-4","mb-3"],["translate","",1,"fw-bold","form-label","w-100"],[1,"form-control","w-100"],["for","visitDate","translate","",1,"fw-bold","form-label"],[1,"mt-4","row",2,"border-top","1px solid rgba(128,128,128,0.29)"],[1,"col-12","text-center","mt-4"],[1,"table","table-bordered"],["translate",""],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"mt-4","pt-3","row",2,"border-top","1px solid rgba(128,128,128,0.29)"],[1,"col-md-12","mb-3","d-flex"],[1,"fw-bold","form-label","w-25"],[1,"fw-bold","form-label","w-75"],[1,"col-12","col-md-12","mb-3","d-flex"],["translate","",1,"fw-bold","form-label","w-25"],[1,"fw-bold","form-label","w-75","form-control","py-3"],[1,"col-12","col-md-6","mb-3"],["for","assignDate","translate","",1,"fw-bold","form-label"],[1,"input-group"],["InputTirmFilter","","name","mobile","type","date","id","assignDate",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["name","teamCode","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],[1,"d-flex","gap-2","justify-content-end","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger",3,"click"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],["colspan","4"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",7)(1,"div",8)(2,"div",9),e.nrm(3,"ngx-ui-loader",10),e.j41(4,"base-filter",11),e.bIt("reset",function(){return e.eBV(a),e.Njj(n.onReset())})("search",function(){return e.eBV(a),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(n.onExportXlsx())})("addNew",function(){return e.eBV(a),e.Njj(n.goRegister())}),e.qex(5,12),e.j41(6,"div",13)(7,"div",14)(8,"input",15),e.nI1(9,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.orderCode,s)||(n.pagination.orderCode=s),e.Njj(s)}),e.k0s(),e.nrm(10,"i",16),e.k0s()(),e.j41(11,"div",13)(12,"div",14)(13,"input",17),e.nI1(14,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.agentName,s)||(n.pagination.agentName=s),e.Njj(s)}),e.k0s(),e.nrm(15,"i",16),e.k0s()(),e.j41(16,"div",13)(17,"div",14)(18,"input",15),e.nI1(19,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.mobile,s)||(n.pagination.mobile=s),e.Njj(s)}),e.k0s(),e.nrm(20,"i",16),e.k0s()(),e.j41(21,"div",13)(22,"div",14)(23,"ng-select",18),e.nI1(24,"translate"),e.bIt("change",function(s){return e.eBV(a),e.Njj(n.oncityChange(s))}),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.cityCode,s)||(n.pagination.cityCode=s),e.Njj(s)}),e.k0s()()(),e.j41(25,"div",13)(26,"div",14)(27,"ng-select",19),e.nI1(28,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.districtName,s)||(n.pagination.districtName=s),e.Njj(s)}),e.k0s()()(),e.j41(29,"div",20)(30,"input",21),e.nI1(31,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.creationDates,s)||(n.searchForm.creationDates=s),e.Njj(s)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(32,"div",22)(33,"div",23)(34,"p-table",24,0),e.bIt("onLazyLoad",function(s){return e.eBV(a),e.Njj(n.tableChange(s))})("selectionChange",function(s){return e.eBV(a),e.Njj(n.onSelectionChange(s))}),e.DNE(36,ur,19,0,"ng-template",25)(37,Fr,34,15,"ng-template",26),e.k0s()(),e.DNE(38,Mr,2,0,"div",27)(39,xr,6,8,"div",28),e.k0s()()()(),e.DNE(40,Tr,1,1,"ng-template",null,1,e.C5r)(42,kr,70,27,"ng-template",null,2,e.C5r)}2&i&&(e.R7$(3),e.Y8G("loaderId","priceEvalLoader"),e.R7$(),e.Y8G("showAllStr",!1)("showAdd",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,29,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.orderCode),e.R7$(5),e.FS9("placeholder",e.bMT(14,31,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.agentName),e.R7$(5),e.FS9("placeholder",e.bMT(19,33,"orderManagement.order.mobile")),e.R50("ngModel",n.pagination.mobile),e.R7$(5),e.FS9("placeholder",e.bMT(24,35,"orderManagement.order.cityName")),e.Y8G("items",n.cities)("multiple",!1),e.R50("ngModel",n.pagination.cityCode),e.R7$(4),e.FS9("placeholder",e.bMT(28,37,"orderManagement.order.districtName")),e.Y8G("items",n.districts)("multiple",!1),e.R50("ngModel",n.pagination.districtName),e.R7$(3),e.FS9("placeholder",e.bMT(31,39,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[c.Sq,c.bT,d.qT,d.me,d.Q0,d.BC,d.cb,d.vS,d.cV,m.s5,R.kL,$.b,U.p,Y.g,g.Mm,C.XI,P.Ei,C.Tg,v.Cv,V.vr,m.md,B.m,me,c.vh,g.D9]})}}return r})();var fe=p(67569),ve=p(21626);let Ie=(()=>{class r extends fe.d{constructor(t){super(t,ie.c.apiUrl+"OrderAssign/")}static{this.\u0275fac=function(i){return new(i||r)(e.KVO(ve.Qq))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function Rr(r,l){1&r&&(e.j41(0,"tr",31)(1,"th",32),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",33),e.nrm(4,"i",34),e.EFF(5," orderManagement.order.orderCode "),e.k0s(),e.j41(6,"th",35),e.EFF(7," general.table.creationTime "),e.k0s(),e.j41(8,"th",36),e.EFF(9," orderManagement.order.agentName "),e.k0s(),e.j41(10,"th",36),e.EFF(11," orderManagement.order.mobile "),e.k0s(),e.j41(12,"th",37),e.EFF(13," orderManagement.order.cityName "),e.k0s(),e.j41(14,"th",37),e.EFF(15," orderManagement.order.districtName "),e.k0s(),e.j41(16,"th",37),e.EFF(17," orderManagement.priceEvaluation.status "),e.k0s(),e.j41(18,"th",37),e.EFF(19," orderManagement.order.teamName "),e.k0s(),e.j41(20,"th",37),e.EFF(21," orderManagement.order.visitDate "),e.k0s(),e.nrm(22,"th",35),e.k0s())}function Er(r,l){1&r&&e.nrm(0,"span",61)}function Nr(r,l){if(1&r&&(e.j41(0,"span",62),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI("",t.districtName," ")}}function Dr(r,l){1&r&&e.nrm(0,"span",63)}function Or(r,l){1&r&&e.nrm(0,"span",64)}function wr(r,l){if(1&r&&(e.nrm(0,"i",65),e.EFF(1),e.nI1(2,"date"),e.nrm(3,"br")(4,"i",66),e.EFF(5)),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",e.i5U(2,2,t.createdDate,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",t.name," ")}}function Vr(r,l){if(1&r){const t=e.RV6();e.j41(0,"tr",38)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td")(4,"bdi"),e.EFF(5),e.k0s()(),e.j41(6,"td"),e.EFF(7),e.nI1(8,"date"),e.j41(9,"span",39),e.EFF(10),e.k0s()(),e.j41(11,"td"),e.EFF(12),e.k0s(),e.j41(13,"td")(14,"span",40),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.copytext(n.mobile))}),e.EFF(15),e.nrm(16,"i",41),e.k0s()(),e.j41(17,"td"),e.EFF(18),e.k0s(),e.j41(19,"td"),e.DNE(20,Er,1,0,"span",42)(21,Nr,2,1,"span",43),e.k0s(),e.j41(22,"td"),e.DNE(23,Dr,1,0,"span",44)(24,Or,1,0,"span",45),e.k0s(),e.j41(25,"td"),e.EFF(26),e.k0s(),e.j41(27,"td"),e.EFF(28),e.nI1(29,"date"),e.k0s(),e.j41(30,"td"),e.DNE(31,wr,6,5,"ng-template",null,5,e.C5r),e.nrm(33,"i",46),e.j41(34,"div",47)(35,"div",48)(36,"button",49),e.nrm(37,"i",50),e.k0s(),e.j41(38,"ul",51)(39,"li",52),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),o=e.sdS(45);return a.getEvalById(n.evaluationCode),e.Njj(a.openModal(n.evaluationCode,o,"lg"))}),e.j41(40,"a",53),e.nrm(41,"i",54)(42,"span",55),e.k0s()(),e.j41(43,"li",52),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),o=e.sdS(43);return a.getEvalById(n.evaluationCode),e.Njj(a.openModal(n.evaluationCode,o,"lg"))}),e.j41(44,"a",53),e.nrm(45,"i",56)(46,"span",57),e.k0s()(),e.j41(47,"li",52),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),o=e.sdS(41);return e.Njj(a.openModal(n.evaluationCode,o))}),e.j41(48,"a",53),e.nrm(49,"i",58)(50,"span",59),e.k0s()(),e.j41(51,"li",52),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),o=e.sdS(47);return e.Njj(a.openModal(n.evaluationCode,o))}),e.j41(52,"a",53),e.nrm(53,"i",58)(54,"span",60),e.k0s()()()()()()()}if(2&r){const t=l.$implicit,i=l.rowIndex,n=e.sdS(32);e.R7$(2),e.JRh(i+1),e.R7$(3),e.SpI("#SO#",t.evaluationCode,""),e.R7$(2),e.SpI("",e.i5U(8,14,t.createdDate,"yyyy-MM-dd HH:mm")," "),e.R7$(3),e.JRh(t.createdBy),e.R7$(2),e.JRh(t.agentName),e.R7$(3),e.SpI("",t.mobile," "),e.R7$(3),e.JRh(t.cityName),e.R7$(2),e.Y8G("ngIf",""==t.districtName),e.R7$(),e.Y8G("ngIf",""!==t.districtName),e.R7$(2),e.Y8G("ngIf",t.isUrgent),e.R7$(),e.Y8G("ngIf",!t.isUrgent),e.R7$(2),e.JRh(t.teamName),e.R7$(2),e.JRh(e.i5U(29,17,t.visitDate,"yyyy-MM-dd ")),e.R7$(5),e.Y8G("ngbTooltip",n)}}function Gr(r,l){1&r&&(e.j41(0,"div",67),e.EFF(1," general.table.noData "),e.k0s())}function Lr(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",68)(1,"div",69),e.nrm(2,"ngb-pagination-info",70),e.j41(3,"table-length",71),e.bIt("lengthChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",72)(5,"ngb-pagination",73),e.bIt("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,n)||(a.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function $r(r,l){if(1&r){const t=e.RV6();e.j41(0,"cancel-evaluation-model",74),e.bIt("success",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.loadentities())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderId",t.orderSelected)}}function Br(r,l){if(1&r&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s()()),2&r){const t=l.$implicit;e.R7$(2),e.JRh(t.serviceCode),e.R7$(2),e.JRh(t.price),e.R7$(2),e.JRh(t.notes)}}function Xr(r,l){1&r&&(e.j41(0,"tr")(1,"td",108),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&r&&(e.R7$(2),e.JRh(e.bMT(3,1,"orderManagement.order.noData")))}function Ar(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",75)(1,"h4",76),e.nrm(2,"span",77),e.k0s(),e.j41(3,"button",78),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(4,"form",null,6),e.nrm(6,"ngx-ui-loader",79),e.j41(7,"div",80)(8,"div",81)(9,"div",82)(10,"div",9)(11,"div",83)(12,"label",84),e.EFF(13,"orderManagement.order.cityName"),e.k0s(),e.j41(14,"div",85),e.EFF(15),e.k0s()(),e.j41(16,"div",83)(17,"label",84),e.EFF(18,"orderManagement.order.districtName"),e.k0s(),e.j41(19,"div",85),e.EFF(20),e.k0s()(),e.j41(21,"div",83)(22,"label",86),e.EFF(23,"orderManagement.order.date"),e.k0s(),e.j41(24,"div",85),e.EFF(25),e.nI1(26,"date"),e.k0s()()(),e.j41(27,"div",87)(28,"div",88)(29,"table",89)(30,"thead")(31,"tr")(32,"th",90),e.EFF(33," orderManagement.order.service "),e.k0s(),e.j41(34,"th",90),e.EFF(35," orderManagement.order.price "),e.k0s(),e.j41(36,"th",90),e.EFF(37," orderManagement.order.notes "),e.k0s()()(),e.j41(38,"tbody"),e.DNE(39,Br,7,3,"tr",91)(40,Xr,4,3,"tr",92),e.k0s()()()(),e.j41(41,"div",93)(42,"div",94)(43,"label",95),e.EFF(44),e.nI1(45,"translate"),e.k0s(),e.j41(46,"span",96),e.EFF(47),e.nI1(48,"translate"),e.nI1(49,"translate"),e.k0s()(),e.j41(50,"div",97)(51,"label",98),e.EFF(52,"orderManagement.order.notes"),e.k0s(),e.j41(53,"span",99),e.EFF(54),e.k0s()(),e.j41(55,"div",100)(56,"label",101),e.EFF(57,"orderManagement.order.assignDate"),e.k0s(),e.j41(58,"div",102)(59,"input",103,7),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.assignForm.assignDate,n)||(a.assignForm.assignDate=n),e.Njj(n)}),e.k0s()()(),e.j41(61,"div",100)(62,"label",101),e.EFF(63,"orderManagement.order.team"),e.k0s(),e.j41(64,"ng-select",104,8),e.nI1(66,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.assignForm.teamCode,n)||(a.assignForm.teamCode=n),e.Njj(n)}),e.k0s()()(),e.j41(67,"div",105)(68,"button",106),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.ChangeAssignTeam())}),e.k0s(),e.j41(69,"button",107),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()()}if(2&r){const t=e.XpG();e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader),e.R7$(9),e.SpI(" ",t.evaluationDetails.cityName," "),e.R7$(5),e.SpI(" ",t.evaluationDetails.districtName," "),e.R7$(5),e.SpI(" ",e.i5U(26,16,t.evaluationDetails.visitDate,"yyyy-MM-dd")," "),e.R7$(14),e.Y8G("ngForOf",t.evaluationDetails.evaluationservices),e.R7$(),e.Y8G("ngIf",!t.evaluationDetails.evaluationservices),e.R7$(4),e.SpI(" ",e.bMT(45,19,"orderManagement.order.isUrgent")," "),e.R7$(3),e.SpI(" ",t.evaluationDetails.isUrgent?e.bMT(48,21,"orderManagement.order.yes"):e.bMT(49,23,"orderManagement.order.no")," "),e.R7$(7),e.SpI(" ",t.evaluationDetails.notes||"--"," "),e.R7$(5),e.R50("ngModel",t.assignForm.assignDate),e.R7$(5),e.FS9("placeholder",e.bMT(66,25,"orderManagement.order.team")),e.Y8G("items",t.teams)("multiple",!1),e.R50("ngModel",t.assignForm.teamCode)}}function Ur(r,l){if(1&r&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s()()),2&r){const t=l.$implicit;e.R7$(2),e.JRh(t.serviceCode),e.R7$(2),e.JRh(t.price),e.R7$(2),e.JRh(t.notes)}}function Yr(r,l){1&r&&(e.j41(0,"tr")(1,"td",108),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&r&&(e.R7$(2),e.JRh(e.bMT(3,1,"orderManagement.order.noData")))}function Pr(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",75)(1,"h4",76),e.nrm(2,"span",109),e.k0s(),e.j41(3,"button",78),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(4,"form",null,6),e.nrm(6,"ngx-ui-loader",79),e.j41(7,"div",80)(8,"div",81)(9,"div",82)(10,"div",9)(11,"div",83)(12,"label",84),e.EFF(13,"orderManagement.order.cityName"),e.k0s(),e.j41(14,"div",85),e.EFF(15),e.k0s()(),e.j41(16,"div",83)(17,"label",84),e.EFF(18,"orderManagement.order.districtName"),e.k0s(),e.j41(19,"div",85),e.EFF(20),e.k0s()(),e.j41(21,"div",83)(22,"label",86),e.EFF(23,"orderManagement.order.date"),e.k0s(),e.j41(24,"div",85),e.EFF(25),e.nI1(26,"date"),e.k0s()()(),e.j41(27,"div",87)(28,"div",88)(29,"table",89)(30,"thead")(31,"tr")(32,"th",90),e.EFF(33," orderManagement.order.service "),e.k0s(),e.j41(34,"th",90),e.EFF(35," orderManagement.order.price "),e.k0s(),e.j41(36,"th",90),e.EFF(37," orderManagement.order.notes "),e.k0s()()(),e.j41(38,"tbody"),e.DNE(39,Ur,7,3,"tr",91)(40,Yr,4,3,"tr",92),e.k0s()()()(),e.j41(41,"div",93)(42,"div",94)(43,"label",95),e.EFF(44),e.nI1(45,"translate"),e.k0s(),e.j41(46,"span",96),e.EFF(47),e.nI1(48,"translate"),e.nI1(49,"translate"),e.k0s()(),e.j41(50,"div",97)(51,"label",98),e.EFF(52,"orderManagement.order.notes"),e.k0s(),e.j41(53,"span",99),e.EFF(54),e.k0s()()(),e.j41(55,"div",105)(56,"button",107),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()()}if(2&r){const t=e.XpG();e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader),e.R7$(9),e.SpI(" ",t.evaluationDetails.cityName," "),e.R7$(5),e.SpI(" ",t.evaluationDetails.districtName," "),e.R7$(5),e.SpI(" ",e.i5U(26,11,t.evaluationDetails.visitDate,"yyyy-MM-dd")," "),e.R7$(14),e.Y8G("ngForOf",t.evaluationDetails.evaluationservices),e.R7$(),e.Y8G("ngIf",!t.evaluationDetails.evaluationservices),e.R7$(4),e.SpI(" ",e.bMT(45,14,"orderManagement.order.isUrgent")," "),e.R7$(3),e.SpI(" ",t.evaluationDetails.isUrgent?e.bMT(48,16,"orderManagement.order.yes"):e.bMT(49,18,"orderManagement.order.no")," "),e.R7$(7),e.SpI(" ",t.evaluationDetails.notes||"--"," ")}}function zr(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",75)(1,"h4",76),e.nrm(2,"span",110),e.k0s(),e.j41(3,"button",78),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(4,"form",null,6),e.nrm(6,"ngx-ui-loader",79),e.j41(7,"div",80)(8,"div",81)(9,"div",111),e.nrm(10,"lord-icon",112),e.j41(11,"div",113),e.nrm(12,"h3",114)(13,"p",115),e.k0s()(),e.j41(14,"div",116)(15,"button",106),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.FinishEvaluation())}),e.k0s(),e.j41(16,"button",107),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}let Hr=(()=>{class r extends G.w{constructor(t,i,n,a,o,s,b,u,j,F,x,T,I,X,ce,pe){super(t,i,j,n,s,b,u),this.baseService=n,this.orderPendingService=a,this.orderAssignService=o,this.authDaamService=F,this.excelService=x,this.cityService=T,this.districtService=I,this.channelService=X,this.cancelReasonService=ce,this.router=pe,this.title="orderManagement.assignEvaluation.title",this.titleOperation="orderManagement.assignEvaluation.titleOperation",this.keySelected="",this.assignUsers=[],this.times=[],this.teams=[],this.employees=[],this.searchForm={},this.assignForm={},this.isResolveList=!1,this.employeeGroups=[],this.activeindex="1",this.active=1,this.formPassword={},this.roles=[],this.userTypes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.countLoad=2,this.orderSelected=0,this.selectedCallCounter=0,this.cities=[],this.districts=[],this.channels=[],this.callHistory={},this.cancelReasons=[],this.GetCities(),this.getEvalTeams(),this.GetReturnReasons()}GetReturnReasons(){this.cancelReasonService.getDropDown().subscribe(t=>{this.cancelReasons=t.data},t=>{console.log(t)})}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetDistricts(t){this.districtService.getByCityId(t).subscribe(i=>{this.districts=i.data},i=>{console.log(i)})}GetChannels(){this.channelService.getDropDown().subscribe(t=>{this.channels=t.data},t=>{console.log(t)})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,h.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){var i;if(this.ngxLoader.startLoader(_.a7),console.log(this.searchForm),(i=this.searchForm.dates)+void 0&&i.includes("to")){var t=i.split("to").map(n=>n.trim());this.pagination.visitDateFrom=t[0]+"T00:00:00.000",this.pagination.visitDateTo=t[1]+"T23:59:59.999"}else this.pagination.visitDateFrom=null,this.pagination.visitDateTo=null;(i=this.searchForm.creationDates)+void 0&&i.includes("to")?(t=i.split("to").map(a=>a.trim()),this.pagination.creationDateFrom=t[0]+"T00:00:00.000",this.pagination.creationDateTo=t[1]+"T23:59:59.999"):(this.pagination.creationDateFrom=null,this.pagination.creationDateTo=null),this.pagination.subject=this.searchForm.name,null!=this.searchForm.status&&(this.pagination.status=Number.parseInt(this.searchForm.status)),null!=this.searchForm.priority&&(this.pagination.priority=Number.parseInt(this.searchForm.priority)),this.loadentities()}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.ngxLoader.startLoader("assignEvalLoader"),this.pagination.isEvaluationAssign=!0,this.baseService.get(this.pagination).pipe((0,h.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader("assignEvalLoader"),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader("assignEvalLoader"),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({orderCode:i.orderCode,visitDate:i.visitDate,notes:i.notes,createdDate:i.createdDate,assignDate:i.assignDate,finishDate:i.finishDate,districtName:i.districtName,cityName:i.cityName,agentName:i.agentName,mobile:i.mobile,email:i.email,creationUser:i.creationUser,channelName:i.channelName,teamNames:i.teamNames,services:i.services,workTimes:i.workTimes,paymentTypeName:i.paymentTypeName,finishUser:i.finishUser,isCancel:i.isCancel,isReopen:i.isReopen,isFree:i.isFree,isFinish:i.isFinish})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,"User",[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}goRegister(){this.router.navigateByUrl("/managment/order/new")}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return t.isCancel?"bg-warning-subtle text-warning":t.isFinish?"bg-success-subtle text-success":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen||t.isFree?"bg-warning-subtle text-warning":"bg-success-subtle text-success"}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isFree?"orderManagement.order.free":"orderManagement.order.finished"}openModal(t,i,n="md"){this.orderSelected=t,this.assignForm.code=t,this.modalService.open(i,{centered:!0,size:n})}oncityChange(t){this.GetDistricts(t.code)}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}getEvalById(t){this.baseService.getById(t).subscribe(i=>{this.evaluationDetails=i.data,this.assignForm.teamCode=i.date.teamCode,this.assignForm.assignDate=i.date.assignDate},()=>{this.alertService.error()})}getEvalTeams(){this.baseService.EvaluationLookUp().subscribe(t=>{this.teams=t.data.teams},()=>{this.alertService.error()})}ChangeAssignTeam(){this.ngxLoader.startLoader(_.Fq),this.baseService.ChangeAssignTeam(this.assignForm).subscribe(t=>{this.ngxLoader.stopLoader(_.Fq),this.loadentities(),this.modalService.dismissAll(),t.success?this.alertService.success():this.alertService.error("general.message."+t.message)},()=>{this.alertService.error(),this.ngxLoader.stopLoader(_.Fq)})}FinishEvaluation(){this.ngxLoader.startLoader(_.Fq),this.baseService.SaveEvaluationFinish({}).subscribe(t=>{this.ngxLoader.stopLoader(_.Fq),this.loadentities(),this.modalService.dismissAll(),t.success?this.alertService.success():this.alertService.error("general.message."+t.message)},()=>{this.alertService.error(),this.ngxLoader.stopLoader(_.Fq)})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(f.nX),e.rXU(g.c$),e.rXU(oe.W),e.rXU(de.H),e.rXU(Ie),e.rXU(y.u),e.rXU(c.vh),e.rXU(v.eD),e.rXU(m.Bq),e.rXU(A.J),e.rXU(L.V),e.rXU(z.h),e.rXU(H.m),e.rXU(J.l),e.rXU(se.e),e.rXU(f.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-assign-evaluation"]],features:[e.Vt3],decls:48,vars:41,consts:[["tableMaster",""],["deleteModal",""],["evaluateModal",""],["showModal",""],["finishModal",""],["tooltipContent",""],["formEntity","ngForm"],["assignDate","ngModel"],["teamCode","ngModel"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"reset","search","exportXlsx","addNew","showAllStr","showAdd","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","agentName","name","agentName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","code","bindLabel","name",3,"change","ngModelChange","placeholder","items","multiple","ngModel"],["name","employeeCode","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],[1,"col-12","col-md-4","mb-2"],["type","text","mwlFlatpickr","","id","isDate","mode","range",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["translate","",2,"width",".5%"],["pSortableColumn","orderCode","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["translate","",2,"width","15%"],["translate","",2,"width","10%"],["translate","",2,"width","8%"],[1,"fs-5"],[1,"badge","bg-primary-subtle","text-primary"],[1,"cursor-pointer","badge","bg-danger-subtle","text-danger","fs-6",3,"click"],[1,"ri-clipboard-line"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.order.nothing",4,"ngIf"],["class","badge bg-success-subtle text-success",4,"ngIf"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.priceEvaluation.isUrgent",4,"ngIf"],["class","badge bg-success-subtle text-success","translate","orderManagement.priceEvaluation.normal",4,"ngIf"],["tooltipPosition","top",1,"ri-history-fill","d-inline","text-primary","fs-16","align-middle","me-1",3,"ngbTooltip"],[1,"d-inline"],[1,"dropdown-custom"],["type","button",1,"btn","dropbtn","btn-soft-secondary","btn-sm","dropdown-custom","arrow-none"],[1,"ri-more-fill"],[1,"dropdown-menu","dropdown-menu-end","dropdown-content",2,"left","0"],[3,"click"],["href","javascript:void(0);",1,"dropdown-item"],[1,"ri-eye-fill","align-bottom","me-2","text-muted"],["translate","general.action.view"],[1,"ri-user-follow-fill","align-bottom","me-2","text-muted"],["translate","orderManagement.priceEvaluation.reassign"],[1,"ri-chat-delete-fill","align-bottom","me-2","text-muted"],["translate","orderManagement.priceEvaluation.cancel"],["translate","orderManagement.finishedEvaluation.finish"],["translate","orderManagement.order.nothing",1,"badge","bg-danger-subtle","text-danger"],[1,"badge","bg-success-subtle","text-success"],["translate","orderManagement.priceEvaluation.isUrgent",1,"badge","bg-danger-subtle","text-danger"],["translate","orderManagement.priceEvaluation.normal",1,"badge","bg-success-subtle","text-success"],[1,"ri-history-fill","text-warning"],[1,"ri-user-location-fill","text-primary"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"success","dismiss","orderId"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["translate","orderManagement.assignEvaluation.reassignEval",1,"fw-bold","fs-4"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-body"],[1,"mx-4"],[1,"col-12","col-md-4","mb-3"],["translate","",1,"fw-bold","form-label","w-100"],[1,"form-control","w-100"],["for","visitDate","translate","",1,"fw-bold","form-label"],[1,"mt-4","row",2,"border-top","1px solid rgba(128,128,128,0.29)"],[1,"col-12","text-center","mt-4"],[1,"table","table-bordered"],["translate",""],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"mt-4","pt-3","row",2,"border-top","1px solid rgba(128,128,128,0.29)"],[1,"col-md-12","mb-3","d-flex"],[1,"fw-bold","form-label","w-25"],[1,"fw-bold","form-label","w-75"],[1,"col-12","col-md-12","mb-3","d-flex"],["translate","",1,"fw-bold","form-label","w-25"],[1,"fw-bold","form-label","w-75","form-control","py-3"],[1,"col-12","col-md-6","mb-3"],["for","assignDate","translate","",1,"fw-bold","form-label"],[1,"input-group"],["InputTirmFilter","","name","mobile","type","date","id","assignDate",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["name","teamCode","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],[1,"d-flex","gap-2","justify-content-end","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger",3,"click"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],["colspan","4"],["translate","orderManagement.assignEvaluation.title",1,"fw-bold","fs-4"],["translate","orderManagement.finishedEvaluation.title",1,"fw-bold","fs-4"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",9)(1,"div",10)(2,"div",11),e.nrm(3,"ngx-ui-loader",12),e.j41(4,"base-filter",13),e.bIt("reset",function(){return e.eBV(a),e.Njj(n.onReset())})("search",function(){return e.eBV(a),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(n.onExportXlsx())})("addNew",function(){return e.eBV(a),e.Njj(n.goRegister())}),e.qex(5,14),e.j41(6,"div",15)(7,"div",16)(8,"input",17),e.nI1(9,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.orderCode,s)||(n.pagination.orderCode=s),e.Njj(s)}),e.k0s(),e.nrm(10,"i",18),e.k0s()(),e.j41(11,"div",15)(12,"div",16)(13,"input",19),e.nI1(14,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.agentName,s)||(n.pagination.agentName=s),e.Njj(s)}),e.k0s(),e.nrm(15,"i",18),e.k0s()(),e.j41(16,"div",15)(17,"div",16)(18,"input",17),e.nI1(19,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.mobile,s)||(n.pagination.mobile=s),e.Njj(s)}),e.k0s(),e.nrm(20,"i",18),e.k0s()(),e.j41(21,"div",15)(22,"div",16)(23,"ng-select",20),e.nI1(24,"translate"),e.bIt("change",function(s){return e.eBV(a),e.Njj(n.oncityChange(s))}),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.cityCode,s)||(n.pagination.cityCode=s),e.Njj(s)}),e.k0s()()(),e.j41(25,"div",15)(26,"div",16)(27,"ng-select",21),e.nI1(28,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.districtName,s)||(n.pagination.districtName=s),e.Njj(s)}),e.k0s()()(),e.j41(29,"div",22)(30,"input",23),e.nI1(31,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.creationDates,s)||(n.searchForm.creationDates=s),e.Njj(s)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(32,"div",24)(33,"div",25)(34,"p-table",26,0),e.bIt("onLazyLoad",function(s){return e.eBV(a),e.Njj(n.tableChange(s))})("selectionChange",function(s){return e.eBV(a),e.Njj(n.onSelectionChange(s))}),e.DNE(36,Rr,23,0,"ng-template",27)(37,Vr,55,20,"ng-template",28),e.k0s()(),e.DNE(38,Gr,2,0,"div",29)(39,Lr,6,8,"div",30),e.k0s()()()(),e.DNE(40,$r,1,1,"ng-template",null,1,e.C5r)(42,Ar,70,27,"ng-template",null,2,e.C5r)(44,Pr,57,20,"ng-template",null,3,e.C5r)(46,zr,17,3,"ng-template",null,4,e.C5r)}2&i&&(e.R7$(3),e.Y8G("loaderId","assignEvalLoader"),e.R7$(),e.Y8G("showAllStr",!1)("showAdd",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,29,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.orderCode),e.R7$(5),e.FS9("placeholder",e.bMT(14,31,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.agentName),e.R7$(5),e.FS9("placeholder",e.bMT(19,33,"orderManagement.order.mobile")),e.R50("ngModel",n.pagination.mobile),e.R7$(5),e.FS9("placeholder",e.bMT(24,35,"orderManagement.order.cityName")),e.Y8G("items",n.cities)("multiple",!1),e.R50("ngModel",n.pagination.cityCode),e.R7$(4),e.FS9("placeholder",e.bMT(28,37,"orderManagement.order.districtName")),e.Y8G("items",n.districts)("multiple",!1),e.R50("ngModel",n.pagination.districtName),e.R7$(3),e.FS9("placeholder",e.bMT(31,39,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[c.Sq,c.bT,d.qT,d.me,d.Q0,d.BC,d.cb,d.vS,d.cV,m.s5,R.kL,$.b,U.p,Y.g,g.Mm,C.XI,P.Ei,C.Tg,v.Cv,V.vr,m.md,B.m,me,c.vh,g.D9]})}}return r})();function Jr(r,l){1&r&&(e.j41(0,"tr",28)(1,"th",29),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",30),e.nrm(4,"i",31),e.EFF(5," orderManagement.order.orderCode "),e.k0s(),e.j41(6,"th",32),e.EFF(7," general.table.creationTime "),e.k0s(),e.j41(8,"th",33),e.EFF(9," orderManagement.order.agentName "),e.k0s(),e.j41(10,"th",33),e.EFF(11," orderManagement.order.mobile "),e.k0s(),e.j41(12,"th",34),e.EFF(13," orderManagement.order.cityName "),e.k0s(),e.j41(14,"th",34),e.EFF(15," orderManagement.order.districtName "),e.k0s(),e.j41(16,"th",34),e.EFF(17," orderManagement.priceEvaluation.status "),e.k0s(),e.j41(18,"th",34),e.EFF(19," orderManagement.order.visitDate "),e.k0s(),e.j41(20,"th",34),e.EFF(21," orderManagement.order.notes "),e.k0s()())}function qr(r,l){1&r&&e.nrm(0,"span",43)}function Qr(r,l){if(1&r&&(e.j41(0,"span",44),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI("",t.districtName," ")}}function Wr(r,l){1&r&&e.nrm(0,"span",45)}function Kr(r,l){1&r&&e.nrm(0,"span",46)}function Zr(r,l){if(1&r){const t=e.RV6();e.j41(0,"tr",35)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td")(4,"bdi"),e.EFF(5),e.k0s()(),e.j41(6,"td"),e.EFF(7),e.nI1(8,"date"),e.j41(9,"span",36),e.EFF(10),e.k0s()(),e.j41(11,"td"),e.EFF(12),e.k0s(),e.j41(13,"td")(14,"span",37),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.copytext(n.mobile))}),e.EFF(15),e.nrm(16,"i",38),e.k0s()(),e.j41(17,"td"),e.EFF(18),e.k0s(),e.j41(19,"td"),e.DNE(20,qr,1,0,"span",39)(21,Qr,2,1,"span",40),e.k0s(),e.j41(22,"td"),e.DNE(23,Wr,1,0,"span",41)(24,Kr,1,0,"span",42),e.k0s(),e.j41(25,"td"),e.EFF(26),e.nI1(27,"date"),e.k0s(),e.j41(28,"td"),e.EFF(29),e.k0s()()}if(2&r){const t=l.$implicit,i=l.rowIndex;e.R7$(2),e.JRh(i+1),e.R7$(3),e.SpI("#SO#",t.evaluationCode,""),e.R7$(2),e.SpI("",e.i5U(8,13,t.createdDate,"yyyy-MM-dd HH:mm")," "),e.R7$(3),e.SpI("",t.createdBy," "),e.R7$(2),e.JRh(t.agentName),e.R7$(3),e.SpI("",t.mobile," "),e.R7$(3),e.JRh(t.cityName),e.R7$(2),e.Y8G("ngIf",""==t.districtName),e.R7$(),e.Y8G("ngIf",""!==t.districtName),e.R7$(2),e.Y8G("ngIf",t.isUrgent),e.R7$(),e.Y8G("ngIf",!t.isUrgent),e.R7$(2),e.JRh(e.i5U(27,16,t.visitDate,"yyyy-MM-dd HH:mm")),e.R7$(3),e.JRh(t.notes)}}function ea(r,l){1&r&&(e.j41(0,"div",47),e.EFF(1," general.table.noData "),e.k0s())}function ta(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",48)(1,"div",49),e.nrm(2,"ngb-pagination-info",50),e.j41(3,"table-length",51),e.bIt("lengthChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",52)(5,"ngb-pagination",53),e.bIt("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,n)||(a.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function na(r,l){if(1&r){const t=e.RV6();e.j41(0,"cancel-evaluation-model",54),e.bIt("success",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.loadentities())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderId",t.orderSelected)}}function ia(r,l){if(1&r&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s()()),2&r){const t=l.$implicit;e.R7$(2),e.JRh(t.serviceCode),e.R7$(2),e.JRh(t.price),e.R7$(2),e.JRh(t.notes)}}function ra(r,l){1&r&&(e.j41(0,"tr")(1,"td",85),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&r&&(e.R7$(2),e.JRh(e.bMT(3,1,"orderManagement.order.noData")))}function aa(r,l){if(1&r){const t=e.RV6();e.j41(0,"form",null,3),e.nrm(2,"ngx-ui-loader",55),e.j41(3,"div",56)(4,"div",57)(5,"button",58),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",59)(7,"div",60)(8,"div",6)(9,"div",61)(10,"label",62),e.EFF(11,"orderManagement.order.cityName"),e.k0s(),e.j41(12,"div",63),e.EFF(13),e.k0s()(),e.j41(14,"div",61)(15,"label",62),e.EFF(16,"orderManagement.order.districtName"),e.k0s(),e.j41(17,"div",63),e.EFF(18),e.k0s()(),e.j41(19,"div",61)(20,"label",64),e.EFF(21,"orderManagement.order.date"),e.k0s(),e.j41(22,"div",63),e.EFF(23),e.nI1(24,"date"),e.k0s()()(),e.j41(25,"div",65)(26,"div",66)(27,"table",67)(28,"thead")(29,"tr")(30,"th",68),e.EFF(31," orderManagement.order.service "),e.k0s(),e.j41(32,"th",68),e.EFF(33," orderManagement.order.price "),e.k0s(),e.j41(34,"th",68),e.EFF(35," orderManagement.order.notes "),e.k0s()()(),e.j41(36,"tbody"),e.DNE(37,ia,7,3,"tr",69)(38,ra,4,3,"tr",70),e.k0s()()()(),e.j41(39,"div",65)(40,"div",71)(41,"label",72),e.EFF(42),e.nI1(43,"translate"),e.k0s(),e.j41(44,"span",73),e.EFF(45),e.nI1(46,"translate"),e.nI1(47,"translate"),e.k0s()(),e.j41(48,"div",74)(49,"label",75),e.EFF(50,"orderManagement.order.notes"),e.k0s(),e.j41(51,"span",76),e.EFF(52),e.k0s()(),e.j41(53,"div",77)(54,"label",78),e.EFF(55,"orderManagement.order.assignDate"),e.k0s(),e.j41(56,"div",79)(57,"input",80,4),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.assignForm.assignDate,n)||(a.assignForm.assignDate=n),e.Njj(n)}),e.k0s()()(),e.j41(59,"div",77)(60,"label",78),e.EFF(61,"orderManagement.order.team"),e.k0s(),e.j41(62,"ng-select",81,5),e.nI1(64,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.assignForm.teamCode,n)||(a.assignForm.teamCode=n),e.Njj(n)}),e.k0s()()(),e.j41(65,"div",82)(66,"button",83),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.ChangeAssignTeam())}),e.k0s(),e.j41(67,"button",84),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader),e.R7$(11),e.SpI(" ",t.evaluationDetails.cityName," "),e.R7$(5),e.SpI(" ",t.evaluationDetails.districtName," "),e.R7$(5),e.SpI(" ",e.i5U(24,16,t.evaluationDetails.visitDate,"mediumDate")," "),e.R7$(14),e.Y8G("ngForOf",t.evaluationDetails.evaluationservices),e.R7$(),e.Y8G("ngIf",!t.evaluationDetails.evaluationservices),e.R7$(4),e.SpI(" ",e.bMT(43,19,"orderManagement.order.isUrgent")," "),e.R7$(3),e.SpI(" ",t.evaluationDetails.isUrgent?e.bMT(46,21,"orderManagement.order.yes"):e.bMT(47,23,"orderManagement.order.no")," "),e.R7$(7),e.SpI(" ",t.evaluationDetails.notes," "),e.R7$(5),e.R50("ngModel",t.assignForm.assignDate),e.R7$(5),e.FS9("placeholder",e.bMT(64,25,"orderManagement.order.team")),e.Y8G("items",t.teams)("multiple",!1),e.R50("ngModel",t.assignForm.teamCode)}}let sa=(()=>{class r extends G.w{constructor(t,i,n,a,o,s,b,u,j,F,x,T,I,X){super(t,i,u,n,o,s,b),this.baseService=n,this.orderPendingService=a,this.authDaamService=j,this.excelService=F,this.cityService=x,this.districtService=T,this.channelService=I,this.router=X,this.title="orderManagement.finishedEvaluation.title",this.titleOperation="orderManagement.finishedEvaluation.titleOperation",this.keySelected="",this.assignUsers=[],this.times=[],this.teams=[],this.employees=[],this.searchForm={},this.assignForm={},this.isResolveList=!0,this.employeeGroups=[],this.activeindex="1",this.active=1,this.formPassword={},this.roles=[],this.userTypes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.countLoad=2,this.orderSelected=0,this.selectedCallCounter=0,this.cities=[],this.districts=[],this.channels=[],this.callHistory={},this.GetCities(),this.getEvalTeams()}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetDistricts(t){this.districtService.getByCityId(t).subscribe(i=>{this.districts=i.data},i=>{console.log(i)})}GetChannels(){this.channelService.getDropDown().subscribe(t=>{this.channels=t.data},t=>{console.log(t)})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,h.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){var i;if(this.ngxLoader.startLoader(_.a7),console.log(this.searchForm),(i=this.searchForm.dates)+void 0&&i.includes("to")){var t=i.split("to").map(n=>n.trim());this.pagination.visitDateFrom=t[0]+"T00:00:00.000",this.pagination.visitDateTo=t[1]+"T23:59:59.999",this.loadentities()}else this.pagination.visitDateFrom=null,this.pagination.visitDateTo=null;(i=this.searchForm.creationDates)+void 0&&i.includes("to")?(t=i.split("to").map(a=>a.trim()),this.pagination.creationDateFrom=t[0]+"T00:00:00.000",this.pagination.creationDateTo=t[1]+"T23:59:59.999",this.loadentities()):(this.pagination.creationDateFrom=null,this.pagination.creationDateTo=null),this.pagination.subject=this.searchForm.name,null!=this.searchForm.status&&(this.pagination.status=Number.parseInt(this.searchForm.status)),null!=this.searchForm.priority&&(this.pagination.priority=Number.parseInt(this.searchForm.priority)),this.loadentities(),this.loadentities()}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.ngxLoader.startLoader("finishEvalLoader"),this.pagination.isEvaluationFinish=!0,this.baseService.get(this.pagination).pipe((0,h.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader("finishEvalLoader"),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader("finishEvalLoader"),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({orderCode:i.orderCode,visitDate:i.visitDate,notes:i.notes,createdDate:i.createdDate,assignDate:i.assignDate,finishDate:i.finishDate,districtName:i.districtName,cityName:i.cityName,agentName:i.agentName,mobile:i.mobile,email:i.email,creationUser:i.creationUser,channelName:i.channelName,teamNames:i.teamNames,services:i.services,workTimes:i.workTimes,paymentTypeName:i.paymentTypeName,finishUser:i.finishUser,isCancel:i.isCancel,isReopen:i.isReopen,isFree:i.isFree,isFinish:i.isFinish})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,"User",[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}goRegister(){this.router.navigateByUrl("/managment/order/new")}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return t.isCancel?"bg-warning-subtle text-warning":t.isFinish?"bg-success-subtle text-success":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen||t.isFree?"bg-warning-subtle text-warning":"bg-success-subtle text-success"}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isFree?"orderManagement.order.free":"orderManagement.order.finished"}openModal(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}oncityChange(t){this.GetDistricts(t.code)}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}getEvalById(t){this.baseService.getById(t).subscribe(i=>{this.evaluationDetails=i.data},()=>{this.alertService.error()})}getEvalTeams(){this.baseService.EvaluationLookUp().subscribe(t=>{this.teams=t.data.teams},()=>{this.alertService.error()})}ChangeAssignTeam(){this.baseService.ChangeAssignTeam(this.assignForm).subscribe(t=>{this.modalService.dismissAll(),t.success?this.alertService.success():this.alertService.error("general.message."+t.message)},()=>{this.alertService.error()})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(f.nX),e.rXU(g.c$),e.rXU(oe.W),e.rXU(de.H),e.rXU(y.u),e.rXU(c.vh),e.rXU(v.eD),e.rXU(m.Bq),e.rXU(A.J),e.rXU(L.V),e.rXU(z.h),e.rXU(H.m),e.rXU(J.l),e.rXU(f.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-all-finished-evaluation"]],features:[e.Vt3],decls:44,vars:41,consts:[["tableMaster",""],["deleteModal",""],["evaluateModal",""],["formEntity","ngForm"],["assignDate","ngModel"],["teamCode","ngModel"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"reset","search","exportXlsx","addNew","showAllStr","showAdd","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","agentName","name","agentName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","code","bindLabel","name",3,"change","ngModelChange","placeholder","items","multiple","ngModel"],["name","employeeCode","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],[1,"col-12","col-md-4","mb-2"],["type","text","mwlFlatpickr","","id","isDate","mode","range",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["translate","",2,"width",".5%"],["pSortableColumn","orderCode","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["translate","",2,"width","12%"],["translate","",2,"width","10%"],["translate","",2,"width","8%"],[1,"fs-5"],[1,"badge","bg-primary-subtle","text-primary"],[1,"cursor-pointer","badge","bg-danger-subtle","text-danger","fs-6",3,"click"],[1,"ri-clipboard-line"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.order.nothing",4,"ngIf"],["class","badge bg-success-subtle text-success",4,"ngIf"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.priceEvaluation.isUrgent",4,"ngIf"],["class","badge bg-success-subtle text-success","translate","orderManagement.priceEvaluation.normal",4,"ngIf"],["translate","orderManagement.order.nothing",1,"badge","bg-danger-subtle","text-danger"],[1,"badge","bg-success-subtle","text-success"],["translate","orderManagement.priceEvaluation.isUrgent",1,"badge","bg-danger-subtle","text-danger"],["translate","orderManagement.priceEvaluation.normal",1,"badge","bg-success-subtle","text-success"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"success","dismiss","orderId"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mx-4"],[1,"col-12","col-md-4","mb-3"],["translate","",1,"fw-bold","form-label","w-100"],[1,"form-control","w-100"],["for","visitDate","translate","",1,"fw-bold","form-label"],[1,"mt-5","row"],[1,"col-12","text-center","mt-4"],[1,"table","table-bordered"],["translate",""],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"col-md-12","mb-3","d-flex"],[1,"fw-bold","form-label","w-25"],[1,"fw-bold","form-label","w-75"],[1,"col-12","col-md-12","mb-3","d-flex"],["translate","",1,"fw-bold","form-label","w-25"],[1,"fw-bold","form-label","w-75","form-control","py-3"],[1,"col-12","col-md-6","mb-3"],["for","assignDate","translate","",1,"fw-bold","form-label"],[1,"input-group"],["InputTirmFilter","","name","mobile","type","date","id","assignDate",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["name","teamCode","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],[1,"d-flex","gap-2","justify-content-end","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger",3,"click"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],["colspan","4"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",6)(1,"div",7)(2,"div",8),e.nrm(3,"ngx-ui-loader",9),e.j41(4,"base-filter",10),e.bIt("reset",function(){return e.eBV(a),e.Njj(n.onReset())})("search",function(){return e.eBV(a),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(n.onExportXlsx())})("addNew",function(){return e.eBV(a),e.Njj(n.goRegister())}),e.qex(5,11),e.j41(6,"div",12)(7,"div",13)(8,"input",14),e.nI1(9,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.orderCode,s)||(n.pagination.orderCode=s),e.Njj(s)}),e.k0s(),e.nrm(10,"i",15),e.k0s()(),e.j41(11,"div",12)(12,"div",13)(13,"input",16),e.nI1(14,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.agentName,s)||(n.pagination.agentName=s),e.Njj(s)}),e.k0s(),e.nrm(15,"i",15),e.k0s()(),e.j41(16,"div",12)(17,"div",13)(18,"input",14),e.nI1(19,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.mobile,s)||(n.pagination.mobile=s),e.Njj(s)}),e.k0s(),e.nrm(20,"i",15),e.k0s()(),e.j41(21,"div",12)(22,"div",13)(23,"ng-select",17),e.nI1(24,"translate"),e.bIt("change",function(s){return e.eBV(a),e.Njj(n.oncityChange(s))}),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.cityCode,s)||(n.pagination.cityCode=s),e.Njj(s)}),e.k0s()()(),e.j41(25,"div",12)(26,"div",13)(27,"ng-select",18),e.nI1(28,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.districtName,s)||(n.pagination.districtName=s),e.Njj(s)}),e.k0s()()(),e.j41(29,"div",19)(30,"input",20),e.nI1(31,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.creationDates,s)||(n.searchForm.creationDates=s),e.Njj(s)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(32,"div",21)(33,"div",22)(34,"p-table",23,0),e.bIt("onLazyLoad",function(s){return e.eBV(a),e.Njj(n.tableChange(s))})("selectionChange",function(s){return e.eBV(a),e.Njj(n.onSelectionChange(s))}),e.DNE(36,Jr,22,0,"ng-template",24)(37,Zr,30,19,"ng-template",25),e.k0s()(),e.DNE(38,ea,2,0,"div",26)(39,ta,6,8,"div",27),e.k0s()()()(),e.DNE(40,na,1,1,"ng-template",null,1,e.C5r)(42,aa,68,27,"ng-template",null,2,e.C5r)}2&i&&(e.R7$(3),e.Y8G("loaderId","finishEvalLoader"),e.R7$(),e.Y8G("showAllStr",!1)("showAdd",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,29,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.orderCode),e.R7$(5),e.FS9("placeholder",e.bMT(14,31,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.agentName),e.R7$(5),e.FS9("placeholder",e.bMT(19,33,"orderManagement.order.mobile")),e.R50("ngModel",n.pagination.mobile),e.R7$(5),e.FS9("placeholder",e.bMT(24,35,"orderManagement.order.cityName")),e.Y8G("items",n.cities)("multiple",!1),e.R50("ngModel",n.pagination.cityCode),e.R7$(4),e.FS9("placeholder",e.bMT(28,37,"orderManagement.order.districtName")),e.Y8G("items",n.districts)("multiple",!1),e.R50("ngModel",n.pagination.districtName),e.R7$(3),e.FS9("placeholder",e.bMT(31,39,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[c.Sq,c.bT,d.qT,d.me,d.Q0,d.BC,d.cb,d.vS,d.cV,m.s5,R.kL,$.b,U.p,Y.g,g.Mm,C.XI,P.Ei,C.Tg,v.Cv,V.vr,B.m,me,c.vh,g.D9]})}}return r})();function oa(r,l){1&r&&(e.j41(0,"tr",28)(1,"th",29),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",30),e.nrm(4,"i",31),e.EFF(5," orderManagement.order.orderCode "),e.k0s(),e.j41(6,"th",32),e.EFF(7," general.table.creationTime "),e.k0s(),e.j41(8,"th",33),e.EFF(9," orderManagement.order.agentName "),e.k0s(),e.j41(10,"th",33),e.EFF(11," orderManagement.order.mobile "),e.k0s(),e.j41(12,"th",34),e.EFF(13," orderManagement.order.cityName "),e.k0s(),e.j41(14,"th",34),e.EFF(15," orderManagement.order.districtName "),e.k0s(),e.j41(16,"th",34),e.EFF(17," orderManagement.priceEvaluation.status "),e.k0s(),e.j41(18,"th",33),e.EFF(19," orderManagement.order.cancelReasonName "),e.k0s()())}function la(r,l){1&r&&e.nrm(0,"span",43)}function da(r,l){if(1&r&&(e.j41(0,"span",44),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI("",t.districtName," ")}}function ma(r,l){1&r&&e.nrm(0,"span",45)}function ca(r,l){1&r&&e.nrm(0,"span",46)}function pa(r,l){if(1&r){const t=e.RV6();e.j41(0,"tr",35)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td")(4,"bdi"),e.EFF(5),e.k0s()(),e.j41(6,"td"),e.EFF(7),e.nI1(8,"date"),e.j41(9,"span",36),e.EFF(10),e.k0s()(),e.j41(11,"td"),e.EFF(12),e.k0s(),e.j41(13,"td")(14,"span",37),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.copytext(n.mobile))}),e.EFF(15),e.nrm(16,"i",38),e.k0s()(),e.j41(17,"td"),e.EFF(18),e.k0s(),e.j41(19,"td"),e.DNE(20,la,1,0,"span",39)(21,da,2,1,"span",40),e.k0s(),e.j41(22,"td"),e.DNE(23,ma,1,0,"span",41)(24,ca,1,0,"span",42),e.k0s(),e.j41(25,"td"),e.EFF(26),e.k0s()()}if(2&r){const t=l.$implicit,i=l.rowIndex;e.R7$(2),e.JRh(i+1),e.R7$(3),e.SpI("#SO#",t.evaluationCode,""),e.R7$(2),e.SpI("",e.i5U(8,12,t.createdDate,"yyyy-MM-dd HH:mm")," "),e.R7$(3),e.SpI("",t.createdBy," "),e.R7$(2),e.JRh(t.agentName),e.R7$(3),e.SpI("",t.mobile," "),e.R7$(3),e.JRh(t.cityName),e.R7$(2),e.Y8G("ngIf",""==t.districtName),e.R7$(),e.Y8G("ngIf",""!==t.districtName),e.R7$(2),e.Y8G("ngIf",t.isUrgent),e.R7$(),e.Y8G("ngIf",!t.isUrgent),e.R7$(2),e.JRh(t.cancelReasonName)}}function ga(r,l){1&r&&(e.j41(0,"div",47),e.EFF(1," general.table.noData "),e.k0s())}function _a(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",48)(1,"div",49),e.nrm(2,"ngb-pagination-info",50),e.j41(3,"table-length",51),e.bIt("lengthChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",52)(5,"ngb-pagination",53),e.bIt("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,n)||(a.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function ha(r,l){if(1&r){const t=e.RV6();e.j41(0,"cancel-evaluation-model",54),e.bIt("success",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.loadentities())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderId",t.orderSelected)}}function ua(r,l){if(1&r&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s()()),2&r){const t=l.$implicit;e.R7$(2),e.JRh(t.serviceCode),e.R7$(2),e.JRh(t.price),e.R7$(2),e.JRh(t.notes)}}function ba(r,l){1&r&&(e.j41(0,"tr")(1,"td",85),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&r&&(e.R7$(2),e.JRh(e.bMT(3,1,"orderManagement.order.noData")))}function fa(r,l){if(1&r){const t=e.RV6();e.j41(0,"form",null,3),e.nrm(2,"ngx-ui-loader",55),e.j41(3,"div",56)(4,"div",57)(5,"button",58),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",59)(7,"div",60)(8,"div",6)(9,"div",61)(10,"label",62),e.EFF(11,"orderManagement.order.cityName"),e.k0s(),e.j41(12,"div",63),e.EFF(13),e.k0s()(),e.j41(14,"div",61)(15,"label",62),e.EFF(16,"orderManagement.order.districtName"),e.k0s(),e.j41(17,"div",63),e.EFF(18),e.k0s()(),e.j41(19,"div",61)(20,"label",64),e.EFF(21,"orderManagement.order.date"),e.k0s(),e.j41(22,"div",63),e.EFF(23),e.nI1(24,"date"),e.k0s()()(),e.j41(25,"div",65)(26,"div",66)(27,"table",67)(28,"thead")(29,"tr")(30,"th",68),e.EFF(31," orderManagement.order.service "),e.k0s(),e.j41(32,"th",68),e.EFF(33," orderManagement.order.price "),e.k0s(),e.j41(34,"th",68),e.EFF(35," orderManagement.order.notes "),e.k0s()()(),e.j41(36,"tbody"),e.DNE(37,ua,7,3,"tr",69)(38,ba,4,3,"tr",70),e.k0s()()()(),e.j41(39,"div",65)(40,"div",71)(41,"label",72),e.EFF(42),e.nI1(43,"translate"),e.k0s(),e.j41(44,"span",73),e.EFF(45),e.nI1(46,"translate"),e.nI1(47,"translate"),e.k0s()(),e.j41(48,"div",74)(49,"label",75),e.EFF(50,"orderManagement.order.notes"),e.k0s(),e.j41(51,"span",76),e.EFF(52),e.k0s()(),e.j41(53,"div",77)(54,"label",78),e.EFF(55,"orderManagement.order.assignDate"),e.k0s(),e.j41(56,"div",79)(57,"input",80,4),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.assignForm.assignDate,n)||(a.assignForm.assignDate=n),e.Njj(n)}),e.k0s()()(),e.j41(59,"div",77)(60,"label",78),e.EFF(61,"orderManagement.order.team"),e.k0s(),e.j41(62,"ng-select",81,5),e.nI1(64,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.assignForm.teamCode,n)||(a.assignForm.teamCode=n),e.Njj(n)}),e.k0s()()(),e.j41(65,"div",82)(66,"button",83),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.ChangeAssignTeam())}),e.k0s(),e.j41(67,"button",84),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader),e.R7$(11),e.SpI(" ",t.evaluationDetails.cityName," "),e.R7$(5),e.SpI(" ",t.evaluationDetails.districtName," "),e.R7$(5),e.SpI(" ",e.i5U(24,16,t.evaluationDetails.visitDate,"mediumDate")," "),e.R7$(14),e.Y8G("ngForOf",t.evaluationDetails.evaluationservices),e.R7$(),e.Y8G("ngIf",!t.evaluationDetails.evaluationservices),e.R7$(4),e.SpI(" ",e.bMT(43,19,"orderManagement.order.isUrgent")," "),e.R7$(3),e.SpI(" ",t.evaluationDetails.isUrgent?e.bMT(46,21,"orderManagement.order.yes"):e.bMT(47,23,"orderManagement.order.no")," "),e.R7$(7),e.SpI(" ",t.evaluationDetails.notes," "),e.R7$(5),e.R50("ngModel",t.assignForm.assignDate),e.R7$(5),e.FS9("placeholder",e.bMT(64,25,"orderManagement.order.team")),e.Y8G("items",t.teams)("multiple",!1),e.R50("ngModel",t.assignForm.teamCode)}}let va=(()=>{class r extends G.w{constructor(t,i,n,a,o,s,b,u,j,F,x,T,I,X){super(t,i,u,n,o,s,b),this.baseService=n,this.orderPendingService=a,this.authDaamService=j,this.excelService=F,this.cityService=x,this.districtService=T,this.channelService=I,this.router=X,this.title="orderManagement.canceledEvaluation.title",this.titleOperation="orderManagement.canceledEvaluation.titleOperation",this.keySelected="",this.assignUsers=[],this.times=[],this.teams=[],this.employees=[],this.searchForm={},this.assignForm={},this.isResolveList=!0,this.employeeGroups=[],this.activeindex="1",this.active=1,this.formPassword={},this.roles=[],this.userTypes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.countLoad=2,this.orderSelected=0,this.selectedCallCounter=0,this.cities=[],this.districts=[],this.channels=[],this.callHistory={},this.GetCities(),this.getEvalTeams()}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetDistricts(t){this.districtService.getByCityId(t).subscribe(i=>{this.districts=i.data},i=>{console.log(i)})}GetChannels(){this.channelService.getDropDown().subscribe(t=>{this.channels=t.data},t=>{console.log(t)})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,h.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){var i;if(this.ngxLoader.startLoader(_.a7),console.log(this.searchForm),(i=this.searchForm.dates)+void 0&&i.includes("to")){var t=i.split("to").map(n=>n.trim());this.pagination.visitDateFrom=t[0]+"T00:00:00.000",this.pagination.visitDateTo=t[1]+"T23:59:59.999",this.loadentities()}else this.pagination.visitDateFrom=null,this.pagination.visitDateTo=null;(i=this.searchForm.creationDates)+void 0&&i.includes("to")?(t=i.split("to").map(a=>a.trim()),this.pagination.creationDateFrom=t[0]+"T00:00:00.000",this.pagination.creationDateTo=t[1]+"T23:59:59.999",this.loadentities()):(this.pagination.creationDateFrom=null,this.pagination.creationDateTo=null),this.pagination.subject=this.searchForm.name,null!=this.searchForm.status&&(this.pagination.status=Number.parseInt(this.searchForm.status)),null!=this.searchForm.priority&&(this.pagination.priority=Number.parseInt(this.searchForm.priority)),this.loadentities(),this.loadentities()}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.ngxLoader.startLoader("canceledLoader"),this.pagination.isEvaluationCancele=!0,this.baseService.get(this.pagination).pipe((0,h.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader("canceledLoader"),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader("canceledLoader"),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({orderCode:i.orderCode,visitDate:i.visitDate,notes:i.notes,createdDate:i.createdDate,assignDate:i.assignDate,finishDate:i.finishDate,districtName:i.districtName,cityName:i.cityName,agentName:i.agentName,mobile:i.mobile,email:i.email,creationUser:i.creationUser,channelName:i.channelName,teamNames:i.teamNames,services:i.services,workTimes:i.workTimes,paymentTypeName:i.paymentTypeName,finishUser:i.finishUser,isCancel:i.isCancel,isReopen:i.isReopen,isFree:i.isFree,isFinish:i.isFinish})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,"User",[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}goRegister(){this.router.navigateByUrl("/managment/order/new")}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return t.isCancel?"bg-warning-subtle text-warning":t.isFinish?"bg-success-subtle text-success":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen||t.isFree?"bg-warning-subtle text-warning":"bg-success-subtle text-success"}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isFree?"orderManagement.order.free":"orderManagement.order.finished"}openModal(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}oncityChange(t){this.GetDistricts(t.code)}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}getEvalById(t){this.baseService.getById(t).subscribe(i=>{this.evaluationDetails=i.data},()=>{this.alertService.error()})}getEvalTeams(){this.baseService.EvaluationLookUp().subscribe(t=>{this.teams=t.data.teams},()=>{this.alertService.error()})}ChangeAssignTeam(){this.baseService.ChangeAssignTeam(this.assignForm).subscribe(t=>{this.modalService.dismissAll(),t.success?this.alertService.success():this.alertService.error("general.message."+t.message)},()=>{this.alertService.error()})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(f.nX),e.rXU(g.c$),e.rXU(oe.W),e.rXU(de.H),e.rXU(y.u),e.rXU(c.vh),e.rXU(v.eD),e.rXU(m.Bq),e.rXU(A.J),e.rXU(L.V),e.rXU(z.h),e.rXU(H.m),e.rXU(J.l),e.rXU(f.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-canceled-evaluation"]],features:[e.Vt3],decls:44,vars:41,consts:[["tableMaster",""],["deleteModal",""],["evaluateModal",""],["formEntity","ngForm"],["assignDate","ngModel"],["teamCode","ngModel"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[3,"reset","search","exportXlsx","addNew","showAllStr","showAdd","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","agentName","name","agentName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","code","bindLabel","name",3,"change","ngModelChange","placeholder","items","multiple","ngModel"],["name","employeeCode","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],[1,"col-12","col-md-4","mb-2"],["type","text","mwlFlatpickr","","id","isDate","mode","range",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],[1,"card-body"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["translate","",2,"width",".5%"],["pSortableColumn","orderCode","translate","",2,"width","6%"],[1,"ri-expand-up-down-line"],["translate","",2,"width","12%"],["translate","",2,"width","10%"],["translate","",2,"width","8%"],[1,"fs-5"],[1,"badge","bg-primary-subtle","text-primary"],[1,"cursor-pointer","badge","bg-danger-subtle","text-danger","fs-6",3,"click"],[1,"ri-clipboard-line"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.order.nothing",4,"ngIf"],["class","badge bg-success-subtle text-success",4,"ngIf"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.priceEvaluation.isUrgent",4,"ngIf"],["class","badge bg-success-subtle text-success","translate","orderManagement.priceEvaluation.normal",4,"ngIf"],["translate","orderManagement.order.nothing",1,"badge","bg-danger-subtle","text-danger"],[1,"badge","bg-success-subtle","text-success"],["translate","orderManagement.priceEvaluation.isUrgent",1,"badge","bg-danger-subtle","text-danger"],["translate","orderManagement.priceEvaluation.normal",1,"badge","bg-success-subtle","text-success"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[3,"success","dismiss","orderId"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mx-4"],[1,"col-12","col-md-4","mb-3"],["translate","",1,"fw-bold","form-label","w-100"],[1,"form-control","w-100"],["for","visitDate","translate","",1,"fw-bold","form-label"],[1,"mt-5","row"],[1,"col-12","text-center","mt-4"],[1,"table","table-bordered"],["translate",""],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"col-md-12","mb-3","d-flex"],[1,"fw-bold","form-label","w-25"],[1,"fw-bold","form-label","w-75"],[1,"col-12","col-md-12","mb-3","d-flex"],["translate","",1,"fw-bold","form-label","w-25"],[1,"fw-bold","form-label","w-75","form-control","py-3"],[1,"col-12","col-md-6","mb-3"],["for","assignDate","translate","",1,"fw-bold","form-label"],[1,"input-group"],["InputTirmFilter","","name","mobile","type","date","id","assignDate",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["name","teamCode","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],[1,"d-flex","gap-2","justify-content-end","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger",3,"click"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],["colspan","4"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",6)(1,"div",7)(2,"div",8),e.nrm(3,"ngx-ui-loader",9),e.j41(4,"base-filter",10),e.bIt("reset",function(){return e.eBV(a),e.Njj(n.onReset())})("search",function(){return e.eBV(a),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(n.onExportXlsx())})("addNew",function(){return e.eBV(a),e.Njj(n.goRegister())}),e.qex(5,11),e.j41(6,"div",12)(7,"div",13)(8,"input",14),e.nI1(9,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.orderCode,s)||(n.pagination.orderCode=s),e.Njj(s)}),e.k0s(),e.nrm(10,"i",15),e.k0s()(),e.j41(11,"div",12)(12,"div",13)(13,"input",16),e.nI1(14,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.agentName,s)||(n.pagination.agentName=s),e.Njj(s)}),e.k0s(),e.nrm(15,"i",15),e.k0s()(),e.j41(16,"div",12)(17,"div",13)(18,"input",14),e.nI1(19,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.mobile,s)||(n.pagination.mobile=s),e.Njj(s)}),e.k0s(),e.nrm(20,"i",15),e.k0s()(),e.j41(21,"div",12)(22,"div",13)(23,"ng-select",17),e.nI1(24,"translate"),e.bIt("change",function(s){return e.eBV(a),e.Njj(n.oncityChange(s))}),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.cityCode,s)||(n.pagination.cityCode=s),e.Njj(s)}),e.k0s()()(),e.j41(25,"div",12)(26,"div",13)(27,"ng-select",18),e.nI1(28,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.districtName,s)||(n.pagination.districtName=s),e.Njj(s)}),e.k0s()()(),e.j41(29,"div",19)(30,"input",20),e.nI1(31,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.creationDates,s)||(n.searchForm.creationDates=s),e.Njj(s)}),e.k0s()(),e.bVm(),e.k0s(),e.j41(32,"div",21)(33,"div",22)(34,"p-table",23,0),e.bIt("onLazyLoad",function(s){return e.eBV(a),e.Njj(n.tableChange(s))})("selectionChange",function(s){return e.eBV(a),e.Njj(n.onSelectionChange(s))}),e.DNE(36,oa,20,0,"ng-template",24)(37,pa,27,15,"ng-template",25),e.k0s()(),e.DNE(38,ga,2,0,"div",26)(39,_a,6,8,"div",27),e.k0s()()()(),e.DNE(40,ha,1,1,"ng-template",null,1,e.C5r)(42,fa,68,27,"ng-template",null,2,e.C5r)}2&i&&(e.R7$(3),e.Y8G("loaderId","canceledLoader"),e.R7$(),e.Y8G("showAllStr",!1)("showAdd",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(9,29,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.orderCode),e.R7$(5),e.FS9("placeholder",e.bMT(14,31,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.agentName),e.R7$(5),e.FS9("placeholder",e.bMT(19,33,"orderManagement.order.mobile")),e.R50("ngModel",n.pagination.mobile),e.R7$(5),e.FS9("placeholder",e.bMT(24,35,"orderManagement.order.cityName")),e.Y8G("items",n.cities)("multiple",!1),e.R50("ngModel",n.pagination.cityCode),e.R7$(4),e.FS9("placeholder",e.bMT(28,37,"orderManagement.order.districtName")),e.Y8G("items",n.districts)("multiple",!1),e.R50("ngModel",n.pagination.districtName),e.R7$(3),e.FS9("placeholder",e.bMT(31,39,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(4),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[c.Sq,c.bT,d.qT,d.me,d.Q0,d.BC,d.cb,d.vS,d.cV,m.s5,R.kL,$.b,U.p,Y.g,g.Mm,C.XI,P.Ei,C.Tg,v.Cv,V.vr,B.m,me,c.vh,g.D9]})}}return r})();function Ca(r,l){1&r&&e.nrm(0,"priceEvaluation")}function ja(r,l){1&r&&e.nrm(0,"app-assign-evaluation")}function Fa(r,l){1&r&&e.nrm(0,"app-all-finished-evaluation")}function Ma(r,l){1&r&&e.nrm(0,"app-canceled-evaluation")}let xa=(()=>{class r extends G.w{constructor(t,i,n,a,o,s,b,u){super(t,i,b,n,a,o,s),this.baseService=n,this.authDaamService=u,this.title="orderManagement.order.title",this.titleOperation="orderManagement.order.titleOperation",this.active=1,this.activeindex="2"}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(f.nX),e.rXU(g.c$),e.rXU(q.Q),e.rXU(y.u),e.rXU(c.vh),e.rXU(v.eD),e.rXU(m.Bq),e.rXU(A.J))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-all-eval-order"]],features:[e.Vt3],decls:21,vars:6,consts:[["nav","ngbNav"],[1,"row"],[1,"col-lg-12"],["ngbNav","",1,"nav","nav-tabs-custom","card-header-tabs","border-bottom-0",3,"activeIdChange","navChange","activeId"],[3,"ngbNavItem"],["ngbNavLink",""],["translate","orderManagement.order.priceEvaluation"],["ngbNavContent",""],["translate","orderManagement.order.assignEvaluation"],["translate","orderManagement.order.finishEvaluation"],["translate","orderManagement.order.canceledEvaluation"],[1,"mt-2",3,"ngbNavOutlet"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"ul",3,0),e.mxI("activeIdChange",function(s){return e.eBV(a),e.DH7(n.active,s)||(n.active=s),e.Njj(s)}),e.bIt("navChange",function(s){return e.eBV(a),e.Njj(n.onNavChange(s))}),e.j41(4,"li",4)(5,"a",5),e.nrm(6,"span",6),e.k0s(),e.DNE(7,Ca,1,0,"ng-template",7),e.k0s(),e.j41(8,"li",4)(9,"a",5),e.nrm(10,"span",8),e.k0s(),e.DNE(11,ja,1,0,"ng-template",7),e.k0s(),e.j41(12,"li",4)(13,"a",5),e.nrm(14,"span",9),e.k0s(),e.DNE(15,Fa,1,0,"ng-template",7),e.k0s(),e.j41(16,"li",4)(17,"a",5),e.nrm(18,"span",10),e.k0s(),e.DNE(19,Ma,1,0,"ng-template",7),e.k0s()(),e.nrm(20,"div",11),e.k0s()()}if(2&i){const a=e.sdS(3);e.R7$(2),e.R50("activeId",n.active),e.R7$(2),e.Y8G("ngbNavItem",1),e.R7$(4),e.Y8G("ngbNavItem",2),e.R7$(4),e.Y8G("ngbNavItem",3),e.R7$(4),e.Y8G("ngbNavItem",4),e.R7$(4),e.Y8G("ngbNavOutlet",a)}},dependencies:[m.Um,m.X9,m.sy,m.Gx,m.Ri,m.WA,m.m_,g.Mm,yr,Hr,sa,va],encapsulation:2})}}return r})(),Ta=(()=>{class r{constructor(){this.breadCrumbItems=[],this.addOrders="orderManagement.order.addOrders"}ngOnInit(){}static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["order-register"]],decls:3,vars:4,consts:[[3,"title","breadcrumbItems"]],template:function(i,n){1&i&&(e.nrm(0,"app-breadcrumbs",0),e.nI1(1,"translate"),e.nrm(2,"order-operation")),2&i&&(e.FS9("title",e.bMT(1,2,n.addOrders)),e.Y8G("breadcrumbItems",n.breadCrumbItems))},dependencies:[ue.m,Z.L,g.D9],encapsulation:2})}}return r})();var re=p(56701);let be=(()=>{class r extends fe.d{constructor(t){super(t,ie.c.apiUrl+"ExpensesItem/")}Delete(t){return this.http.delete(`${this.baseUrl}Delete/${t}`)}editExpensesItems(t,i){return this.http.put(this.baseUrl+"Edit/"+t,i)}static{this.\u0275fac=function(i){return new(i||r)(e.KVO(ve.Qq))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var Ce=p(54384);function Sa(r,l){1&r&&(e.j41(0,"tr",24)(1,"th",25),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",26),e.nrm(4,"i",27),e.EFF(5," orderManagement.expensesItems.name "),e.k0s(),e.j41(6,"th",28),e.nrm(7,"i",27),e.EFF(8," orderManagement.expensesItems.notes "),e.k0s(),e.j41(9,"th",28),e.nrm(10,"i",27),e.EFF(11," orderManagement.expensesItems.isActive "),e.k0s(),e.nrm(12,"th",29),e.k0s())}function Ia(r,l){1&r&&e.nrm(0,"span",37)}function ka(r,l){1&r&&e.nrm(0,"span",38)}function ya(r,l){if(1&r){const t=e.RV6();e.j41(0,"tr",30)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.DNE(8,Ia,1,0,"span",31)(9,ka,1,0,"span",32),e.k0s(),e.j41(10,"td")(11,"button",33),e.nI1(12,"translate"),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),o=e.sdS(22);return e.Njj(a.editModal(n,o))}),e.nrm(13,"i",34),e.k0s(),e.j41(14,"button",35),e.nI1(15,"translate"),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),o=e.sdS(24);return e.Njj(a.openModal(n.expensesItemCode,o))}),e.nrm(16,"i",36),e.k0s()()()}if(2&r){const t=l.$implicit,i=l.rowIndex;e.R7$(2),e.JRh(i+1),e.R7$(2),e.JRh(t.expensesItemName),e.R7$(2),e.JRh(t.notes?t.notes:"--"),e.R7$(2),e.Y8G("ngIf",t.isActive),e.R7$(),e.Y8G("ngIf",!t.isActive),e.R7$(2),e.FS9("pTooltip",e.bMT(12,7,"general.edit")),e.R7$(3),e.FS9("pTooltip",e.bMT(15,9,"general.delete"))}}function Ra(r,l){1&r&&(e.j41(0,"div",39),e.EFF(1," general.table.noData"),e.k0s())}function Ea(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",40)(1,"div",41),e.nrm(2,"ngb-pagination-info",42),e.j41(3,"table-length",43),e.bIt("lengthChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",44)(5,"ngb-pagination",45),e.bIt("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,n)||(a.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function Na(r,l){1&r&&(e.j41(0,"span",67),e.EFF(1,"general.action.register "),e.k0s())}function Da(r,l){1&r&&(e.j41(0,"span",67),e.EFF(1,"general.action.edit "),e.k0s())}function Oa(r,l){1&r&&(e.j41(0,"div",68),e.EFF(1," general.message.filedIdRequired"),e.k0s())}function wa(r,l){1&r&&(e.j41(0,"div",68),e.EFF(1," general.message.filedIdRequired"),e.k0s())}function Va(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",46)(1,"h4",47),e.DNE(2,Na,2,0,"span",48)(3,Da,2,0,"span",48),e.nrm(4,"span",49),e.k0s(),e.j41(5,"button",50),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"form",51,3),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onSubmit())}),e.nrm(8,"ngx-ui-loader",17),e.j41(9,"div",52)(10,"div",53)(11,"div",54)(12,"div",7)(13,"div",55)(14,"label",56),e.EFF(15,"orderManagement.expensesItems.name"),e.k0s(),e.j41(16,"div",57)(17,"input",58,4),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.form.expensesItemName,n)||(a.form.expensesItemName=n),e.Njj(n)}),e.k0s(),e.DNE(19,Oa,2,0,"div",59),e.k0s()(),e.j41(20,"div",55)(21,"label",60),e.EFF(22,"orderManagement.expensesItems.notes"),e.k0s(),e.j41(23,"div",57)(24,"textarea",61,5),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.form.notes,n)||(a.form.notes=n),e.Njj(n)}),e.EFF(26,"                                "),e.k0s(),e.DNE(27,wa,2,0,"div",59),e.k0s()(),e.j41(28,"div",55)(29,"label",62),e.EFF(30,"orderManagement.expensesItems.isActive"),e.k0s(),e.j41(31,"p-inputSwitch",63),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.form.isActive,n)||(a.form.isActive=n),e.Njj(n)}),e.k0s()()(),e.j41(32,"div",64),e.nrm(33,"button",65),e.j41(34,"button",66),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()()}if(2&r){const t=e.sdS(7),i=e.sdS(18),n=e.sdS(25),a=e.XpG();e.R7$(2),e.Y8G("ngIf",!a.isEditForm),e.R7$(),e.Y8G("ngIf",a.isEditForm),e.R7$(5),e.Y8G("hasProgressBar",!1)("fgsType",a.loaderOperationShap)("loaderId",a.operationLoader),e.R7$(9),e.R50("ngModel",a.form.expensesItemName),e.R7$(2),e.Y8G("ngIf",i.invalid&&i.touched),e.R7$(5),e.R50("ngModel",a.form.notes),e.R7$(3),e.Y8G("ngIf",n.invalid&&n.touched),e.R7$(4),e.R50("ngModel",a.form.isActive),e.R7$(2),e.Y8G("disabled",!t.valid)}}function Ga(r,l){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",69),e.bIt("deleteConfirm",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.DeleteConfirm())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}}let La=(()=>{class r extends G.w{constructor(t,i,n,a,o,s,b,u,j,F){super(t,i,b,o,n,a,s),this.baseService=o,this.service=u,this.excelService=j,this.router=F,this.title="orderManagement.expensesItems.title",this.submitted=!1,this.cities={},this.channels={},this.leadTypes={},this.isResolveList=!0,this.configRoute()}configRoute(){this.routerActive.data.pipe((0,h.Q)(this.notifier)).subscribe(t=>{this.entities=t.data.data,this.pagination.totalItems=t.data.totalItems},()=>{this.alertService.error()})}onSubmit(){this.ngxLoader.startLoader(this.operationLoader),!0===this.isEditForm?this.editEntity():this.registerEntity()}onSearch(){this.ngxLoader.startLoader(this.searchLoader),this.loadentities()}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,"Service Type",[])}mapExcel(){let t=[];return this.entities?.forEach(i=>{t.push({title:i.title,body:i.body,type:i.type,isActive:this.getTranslationText("general.table.active")})}),t}editModal(t,i,n="md"){this.isEditForm=!0,this.form=t,this.modalService.open(i,{centered:!0,size:n})}editEntity(){let t=this.mapForm(this.form);this.baseService.editExpensesItems(t.expensesItemCode,t).pipe((0,D.O)(),(0,O.c)(this.mainDelay),(0,w.Z)(),(0,h.Q)(this.notifier),(0,N.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(i=>{i.success?this.submitFunished():this.alertService.error("general.message."+i.message)},i=>{this.alertService.error("general.message."+i)})}DeleteConfirm(){console.log(this.selectedRow),this.ngxLoader.startLoader(this.deleteLoader),this.baseService.Delete(this.selectedRow[0].id).pipe((0,D.O)(),(0,O.c)(this.mainDelay),(0,w.Z)(),(0,h.Q)(this.notifier),(0,N.j)(()=>this.ngxLoader.stopLoader(this.deleteLoader))).subscribe(i=>{i.success?(this.alertService.success(),this.loadentities(),this.modalService.dismissAll(),this.resetSelected()):this.alertService.error("general.message."+i)},()=>{this.alertService.error()})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(f.nX),e.rXU(g.c$),e.rXU(y.u),e.rXU(c.vh),e.rXU(be),e.rXU(v.eD),e.rXU(m.Bq),e.rXU(Ce.m),e.rXU(L.V),e.rXU(f.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-expenses-categories"]],features:[e.Vt3],decls:25,vars:19,consts:[["tableMaster",""],["whatsappModal",""],["deleteModal",""],["formEntity","ngForm"],["expensesItemName","ngModel"],["notes","ngModel"],[3,"title","breadcrumbItems"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],[3,"reset","search","exportXlsx","addNew","totalItems","title"],["control",""],[1,"col-12","col-md-6","mb-2"],[1,"search-box"],["InputTirmFilter","","type","search","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],[1,"card-body"],[3,"hasProgressBar","fgsType","loaderId"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["translate","",2,"width",".5%"],["pSortableColumn","name","translate","",2,"width","10%"],[1,"ri-expand-up-down-line"],["pSortableColumn","mobile","translate","",2,"width","10%"],["translate","",2,"width","20%"],[1,"fs-5"],["class","badge bg-success-subtle text-success p-2","translate","general.table.active",4,"ngIf"],["class","badge bg-danger-subtle text-danger p-2","translate","general.table.noActive",4,"ngIf"],["tooltipPosition","top",1,"btn","btn-sm","btn-soft-info","edit-list","mx-2",3,"click","pTooltip"],[1,"ri-pencil-fill","align-bottom","mx-1"],["tooltipPosition","top",1,"btn","btn-sm","btn-soft-danger","remove-list",3,"click","pTooltip"],[1,"ri-delete-bin-5-fill","align-bottom"],["translate","general.table.active",1,"badge","bg-success-subtle","text-success","p-2"],["translate","general.table.noActive",1,"badge","bg-danger-subtle","text-danger","p-2"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["class","fw-bold fs-4","translate","",4,"ngIf"],["translate","orderManagement.expensesItems.title",1,"fw-bold","fs-4"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[3,"ngSubmit"],[1,"modal-content"],[1,"modal-body"],[1,"mx-2"],[1,"col-12","col-md-12","mb-3"],["for","expensesItemName","translate","",1,"fw-bold","form-label","required"],[1,"input-group"],["InputTirmFilter","","name","expensesItemName","type","text","required","","id","expensesItemName",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["for","notes","translate","",1,"fw-bold","form-label","required"],["InputTirmFilter","","name","notes","rows","3","id","notes",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["for","isActive","translate","",1,"fw-bold","form-label","d-block"],["id","isActive","name","isActive","inputId","isActive",3,"ngModelChange","ngModel"],[1,"d-flex","gap-2","justify-content-end","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger",3,"disabled"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],["translate","",1,"fw-bold","fs-4"],["translate","",1,"text-danger","text-center"],[3,"deleteConfirm","dismiss"]],template:function(i,n){if(1&i){const a=e.RV6();e.nrm(0,"app-breadcrumbs",6),e.nI1(1,"translate"),e.j41(2,"div",7)(3,"div",8)(4,"div",9)(5,"base-filter",10),e.bIt("reset",function(){return e.eBV(a),e.Njj(n.onReset())})("search",function(){return e.eBV(a),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(n.onExportXlsx())})("addNew",function(){e.eBV(a);const s=e.sdS(22);return e.Njj(n.openModalTitle(s))}),e.qex(6,11),e.j41(7,"div",12)(8,"div",13)(9,"input",14),e.nI1(10,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.filterValue,s)||(n.pagination.filterValue=s),e.Njj(s)}),e.k0s(),e.nrm(11,"i",15),e.k0s()(),e.bVm(),e.k0s(),e.j41(12,"div",16),e.nrm(13,"ngx-ui-loader",17),e.j41(14,"div",18)(15,"p-table",19,0),e.bIt("onLazyLoad",function(s){return e.eBV(a),e.Njj(n.tableChange(s))})("selectionChange",function(s){return e.eBV(a),e.Njj(n.onSelectionChange(s))}),e.DNE(17,Sa,13,0,"ng-template",20)(18,ya,17,11,"ng-template",21),e.k0s()(),e.DNE(19,Ra,2,0,"div",22)(20,Ea,6,8,"div",23),e.k0s()()()(),e.DNE(21,Va,35,11,"ng-template",null,1,e.C5r)(23,Ga,1,0,"ng-template",null,2,e.C5r)}2&i&&(e.FS9("title",e.bMT(1,15,n.title)),e.Y8G("breadcrumbItems",n.breadCrumbItems),e.R7$(5),e.Y8G("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(10,17,"task.tasklist.subject")),e.R50("ngModel",n.pagination.filterValue),e.R7$(4),e.Y8G("hasProgressBar",!1)("fgsType",n.loaderSearchShap)("loaderId",n.searchLoader),e.R7$(2),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[c.bT,d.qT,d.me,d.BC,d.cb,d.YS,d.vS,d.cV,m.s5,ue.m,$.b,ae.w,U.p,Y.g,g.Mm,C.XI,P.Ei,C.Tg,Me.HW,v.Cv,B.m,K.m,g.D9],encapsulation:2})}}return r})();var ke=p(56131);let $a=(()=>{class r extends ke.E{constructor(t,i,n){super(t,i,n)}static{this.\u0275fac=function(i){return new(i||r)(e.KVO(f.Ix),e.KVO(be),e.KVO(y.u))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var ye=p(99437),Re=p(18810);let je=(()=>{class r extends fe.d{constructor(t){super(t,ie.c.apiUrl+"ExpensesOrder/")}Delete(t){return this.http.delete(`${this.baseUrl}Delete/${t}`)}editExpensesItems(t,i){return this.http.put(this.baseUrl+"Edit/"+t,i)}static{this.\u0275fac=function(i){return new(i||r)(e.KVO(ve.Qq))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function Ba(r,l){1&r&&(e.j41(0,"tr",28)(1,"th",29),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",30),e.nrm(4,"i",31),e.EFF(5," orderManagement.expensesOrders.code "),e.k0s(),e.j41(6,"th",32),e.nrm(7,"i",31),e.EFF(8," orderManagement.expensesOrders.expensesItem "),e.k0s(),e.j41(9,"th",32),e.nrm(10,"i",31),e.EFF(11," orderManagement.expensesOrders.date "),e.k0s(),e.j41(12,"th",32),e.nrm(13,"i",31),e.EFF(14," orderManagement.expensesOrders.price "),e.k0s(),e.j41(15,"th",32),e.nrm(16,"i",31),e.EFF(17," orderManagement.expensesOrders.creationUser "),e.k0s(),e.j41(18,"th",32),e.nrm(19,"i",31),e.EFF(20," orderManagement.expensesOrders.creationDate "),e.k0s(),e.j41(21,"th",32),e.nrm(22,"i",31),e.EFF(23," orderManagement.expensesOrders.attachFile "),e.k0s(),e.nrm(24,"th",33),e.k0s())}function Xa(r,l){if(1&r&&(e.nrm(0,"i",41),e.EFF(1),e.nI1(2,"date"),e.nrm(3,"br")(4,"i",42),e.EFF(5),e.nI1(6,"date"),e.nrm(7,"br")(8,"i",43),e.EFF(9)),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",e.i5U(2,3,t.creationTime,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",e.i5U(6,6,t.updatedDate,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",t.createdUserName," ")}}function Aa(r,l){if(1&r){const t=e.RV6();e.j41(0,"tr",34)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.nI1(9,"date"),e.k0s(),e.j41(10,"td"),e.EFF(11),e.k0s(),e.j41(12,"td"),e.EFF(13),e.nI1(14,"date"),e.k0s(),e.j41(15,"td"),e.EFF(16),e.k0s(),e.j41(17,"td")(18,"a",35),e.EFF(19," orderManagement.expensesOrders.show "),e.k0s()(),e.j41(20,"td"),e.DNE(21,Xa,10,9,"ng-template",null,3,e.C5r),e.nrm(23,"i",36),e.j41(24,"button",37),e.nI1(25,"translate"),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),o=e.sdS(22);return e.Njj(a.editModal(n,o))}),e.nrm(26,"i",38),e.k0s(),e.j41(27,"button",39),e.nI1(28,"translate"),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),o=e.sdS(24);return e.Njj(a.openModal(n.expensesOrderCode,o))}),e.nrm(29,"i",40),e.k0s()()()}if(2&r){const t=l.$implicit,i=l.rowIndex,n=e.sdS(22),a=e.XpG();e.R7$(2),e.JRh(i+1),e.R7$(2),e.JRh(t.expensesOrderCode),e.R7$(2),e.JRh(t.expensesItemName),e.R7$(2),e.JRh(e.i5U(9,11,t.expensesDate,"dd-MM-yyyy")),e.R7$(3),e.JRh(t.expensesValue),e.R7$(2),e.JRh(e.i5U(14,14,t.createdDate,"dd-MM-yyyy")),e.R7$(3),e.JRh(t.createdUserName),e.R7$(2),e.FS9("href",a.serverPath+t.attachFilePath,e.B4B),e.R7$(5),e.Y8G("ngbTooltip",n),e.R7$(),e.FS9("pTooltip",e.bMT(25,17,"general.edit")),e.R7$(3),e.FS9("pTooltip",e.bMT(28,19,"general.delete"))}}function Ua(r,l){1&r&&(e.j41(0,"div",44),e.EFF(1," general.table.noData "),e.k0s())}function Ya(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",45)(1,"div",46),e.nrm(2,"ngb-pagination-info",47),e.j41(3,"table-length",48),e.bIt("lengthChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",49)(5,"ngb-pagination",50),e.bIt("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,n)||(a.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function Pa(r,l){1&r&&(e.j41(0,"span",87),e.EFF(1,"general.action.register "),e.k0s())}function za(r,l){1&r&&(e.j41(0,"span",87),e.EFF(1,"general.action.edit "),e.k0s())}function Ha(r,l){1&r&&(e.j41(0,"div",88),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Ja(r,l){1&r&&(e.j41(0,"div",88),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function qa(r,l){1&r&&(e.j41(0,"div",88),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Qa(r,l){1&r&&(e.j41(0,"div",88),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function Wa(r,l){if(1&r){const t=e.RV6();e.j41(0,"i",89),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.removeImage())}),e.k0s()}}function Ka(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",51)(1,"h4",52),e.DNE(2,Pa,2,0,"span",53)(3,za,2,0,"span",53),e.nrm(4,"span",54),e.k0s(),e.j41(5,"button",55),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"form",56,4),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onSubmit())}),e.nrm(8,"ngx-ui-loader",21),e.j41(9,"div",57)(10,"div",58)(11,"div",59)(12,"div",11)(13,"div",60)(14,"div",11)(15,"div",61)(16,"label",62),e.EFF(17,"orderManagement.expensesOrders.expensesItem"),e.k0s(),e.j41(18,"ng-select",63,5),e.nI1(20,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.form.expensesItemCode,n)||(a.form.expensesItemCode=n),e.Njj(n)}),e.k0s(),e.DNE(21,Ha,2,0,"div",64),e.k0s(),e.j41(22,"div",61)(23,"label",65),e.EFF(24,"orderManagement.expensesOrders.price"),e.k0s(),e.j41(25,"div",66)(26,"input",67,6),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.form.expensesValue,n)||(a.form.expensesValue=n),e.Njj(n)}),e.k0s(),e.DNE(28,Ja,2,0,"div",64),e.k0s()(),e.j41(29,"div",61)(30,"label",68),e.EFF(31,"orderManagement.expensesOrders.date"),e.k0s(),e.j41(32,"div",66)(33,"input",69,7),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.form.expensesDate,n)||(a.form.expensesDate=n),e.Njj(n)}),e.k0s(),e.DNE(35,qa,2,0,"div",64),e.k0s()(),e.j41(36,"div",61)(37,"label",70),e.EFF(38,"orderManagement.expensesOrders.notes"),e.k0s(),e.j41(39,"div",66)(40,"textarea",71,8),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.form.notes,n)||(a.form.notes=n),e.Njj(n)}),e.EFF(42,"                                "),e.k0s(),e.DNE(43,Qa,2,0,"div",64),e.k0s()()()(),e.j41(44,"div",60)(45,"div",72)(46,"label",62),e.EFF(47,"orderManagement.expensesOrders.attachFile"),e.k0s(),e.j41(48,"div",73)(49,"label",74),e.bIt("click",function(){e.eBV(t);const n=e.sdS(54);return e.Njj(n.click())}),e.j41(50,"div",75)(51,"div",76),e.nrm(52,"i",77),e.k0s()()(),e.j41(53,"input",78,9),e.bIt("change",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.onFileChanged(n))}),e.k0s()(),e.j41(55,"div",79)(56,"div",80),e.DNE(57,Wa,1,0,"i",81),e.j41(58,"div",82),e.nrm(59,"img",83),e.k0s()()()()()(),e.j41(60,"div",84),e.nrm(61,"button",85),e.j41(62,"button",86),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()()}if(2&r){const t=e.sdS(7),i=e.sdS(19),n=e.sdS(27),a=e.sdS(34),o=e.sdS(41),s=e.XpG();e.R7$(2),e.Y8G("ngIf",!s.isEditForm),e.R7$(),e.Y8G("ngIf",s.isEditForm),e.R7$(5),e.Y8G("hasProgressBar",!1)("fgsType",s.loaderOperationShap)("loaderId",s.operationLoader),e.R7$(10),e.FS9("placeholder",e.bMT(20,18,"orderManagement.expensesOrders.expensesItem")),e.Y8G("items",s.expensesItems),e.R50("ngModel",s.form.expensesItemCode),e.R7$(3),e.Y8G("ngIf",i.invalid&&i.touched),e.R7$(5),e.R50("ngModel",s.form.expensesValue),e.R7$(2),e.Y8G("ngIf",n.invalid&&n.touched),e.R7$(5),e.R50("ngModel",s.form.expensesDate),e.R7$(2),e.Y8G("ngIf",a.invalid&&a.touched),e.R7$(5),e.R50("ngModel",s.form.notes),e.R7$(3),e.Y8G("ngIf",o.invalid&&o.touched),e.R7$(14),e.Y8G("ngIf",s.image.path),e.R7$(2),e.Y8G("src",s.image.isApi?s.serverPath+s.image.path:s.image.path,e.B4B),e.R7$(2),e.Y8G("disabled",!t.valid||!s.image.path)}}function Za(r,l){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",90),e.bIt("deleteConfirm",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.DeleteConfirm())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}}let es=(()=>{class r extends G.w{constructor(t,i,n,a,o,s,b,u,j,F,x,T){super(t,i,u,o,n,a,b),this.baseService=o,this.expensesCategoriesService=s,this.service=j,this.excelService=F,this._formDataService=x,this.router=T,this.title="orderManagement.expensesOrders.title",this.submitted=!1,this.cities={},this.channels={},this.leadTypes={},this.image={isApi:!1,path:""},this.form={image:""},this.isResolveList=!0,this.serverPath=ie.c.mediaUrl,this.configRoute(),this.getExpensesItems()}configRoute(){this.routerActive.data.pipe((0,h.Q)(this.notifier)).subscribe(t=>{this.entities=t.data.data,this.pagination.totalItems=t.data.totalItems},()=>{this.alertService.error()})}getExpensesItems(){this.expensesCategoriesService.getDropDown().subscribe({next:t=>{this.expensesItems=t.data}})}onSubmit(){this.ngxLoader.startLoader(this.operationLoader),!0===this.isEditForm?this.editEntity():this.registerEntity()}onSearch(){this.ngxLoader.startLoader(this.searchLoader),this.loadentities()}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,"Service Type",[])}mapExcel(){let t=[];return this.entities?.forEach(i=>{t.push({title:i.title,body:i.body,type:i.type,isActive:this.getTranslationText("general.table.active")})}),t}editModal(t,i,n="lg"){this.isEditForm=!0,this.form=t,this.image={isApi:!0,path:t.attachFilePath},this.modalService.open(i,{centered:!0,size:n})}registerEntity(){let t=this._formDataService.formatFormData(this.form);this.baseService.register(t).pipe((0,D.O)(),(0,O.c)(this.mainDelay),(0,w.Z)(),(0,h.Q)(this.notifier),(0,N.j)(()=>this.ngxLoader.stopLoader(this.operationLoader)),(0,ye.W)(i=>(0,Re.$)(i))).subscribe(i=>{i.success?this.submitFunished():this.alertService.error("general.message."+i.message)},i=>{this.alertService.error("general.message."+i)})}editEntity(){let t=this._formDataService.formatFormData(this.form);this.baseService.editExpensesItems(this.form.expensesOrderCode,t).pipe((0,D.O)(),(0,O.c)(this.mainDelay),(0,w.Z)(),(0,h.Q)(this.notifier),(0,N.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(i=>{i.success?this.submitFunished():this.alertService.error("general.message."+i.message)},i=>{this.alertService.error("general.message."+i)})}DeleteConfirm(){console.log(this.selectedRow),this.ngxLoader.startLoader(this.deleteLoader),this.baseService.Delete(this.selectedRow[0].id).pipe((0,D.O)(),(0,O.c)(this.mainDelay),(0,w.Z)(),(0,h.Q)(this.notifier),(0,N.j)(()=>this.ngxLoader.stopLoader(this.deleteLoader))).subscribe(i=>{i.success?(this.alertService.success(),this.loadentities(),this.modalService.dismissAll(),this.resetSelected()):this.alertService.error("general.message."+i)},()=>{this.alertService.error()})}onFileChanged(t){if(t.target.files&&t.target.files[0]){let i=t.target.files.length;for(let n=0;n<i;n++){let a=new FileReader;this.form.image=t.target.files.item(n),a.onload=o=>{this.image={isApi:!1,path:o.target.result}},a.readAsDataURL(t.target.files[n])}}}removeImage(){console.log(),this.form.image="",this.image={id:0,path:""}}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(f.nX),e.rXU(g.c$),e.rXU(y.u),e.rXU(c.vh),e.rXU(je),e.rXU(be),e.rXU(v.eD),e.rXU(m.Bq),e.rXU(Ce.m),e.rXU(L.V),e.rXU(he.Q),e.rXU(f.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-expenses-orders"]],features:[e.Vt3],decls:25,vars:19,consts:[["tableMaster",""],["whatsappModal",""],["deleteModal",""],["tooltipContent",""],["formEntity","ngForm"],["expensesItemCode","ngModel"],["expensesValue","ngModel"],["expensesDate","ngModel"],["notes","ngModel"],["FileInput",""],[3,"title","breadcrumbItems"],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],[3,"reset","search","exportXlsx","addNew","totalItems","title"],["control",""],[1,"col-12","col-md-6","mb-2"],[1,"search-box"],["InputTirmFilter","","type","search","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],[1,"card-body"],[3,"hasProgressBar","fgsType","loaderId"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["translate","",2,"width",".5%"],["pSortableColumn","name","translate","",2,"width","10%"],[1,"ri-expand-up-down-line"],["pSortableColumn","mobile","translate","",2,"width","10%"],["translate","",2,"width","20%"],[1,"fs-5"],["target","_blank","translate","",3,"href"],["tooltipPosition","top",1,"mdi","mdi-cog-outline","d-inline","text-muted","fs-16","align-middle","me-1",3,"ngbTooltip"],["tooltipPosition","top",1,"btn","btn-sm","btn-soft-info","edit-list","mx-2",3,"click","pTooltip"],[1,"ri-pencil-fill","align-bottom","mx-1"],["tooltipPosition","top",1,"btn","btn-sm","btn-soft-danger","remove-list",3,"click","pTooltip"],[1,"ri-delete-bin-5-fill","align-bottom"],[1,"ri-history-fill","text-warning"],[1,"ri-history-fill","text-danger"],[1,"ri-user-location-fill","text-primary"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["class","fw-bold fs-4","translate","",4,"ngIf"],["translate","orderManagement.expensesOrders.title",1,"fw-bold","fs-4"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[3,"ngSubmit"],[1,"modal-content"],[1,"modal-body"],[1,"mx-2"],[1,"col-12","col-lg-6"],[1,"col-12","col-md-12","mb-3"],["for","expensesItemCode","translate","",1,"fw-bold","form-label","required"],["name","expensesItemCode","bindValue","code","bindLabel","name","id","expensesItemCode","required","",3,"ngModelChange","items","placeholder","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["for","expensesValue","translate","",1,"fw-bold","form-label","required"],[1,"input-group"],["InputTirmFilter","","name","expensesValue","type","number","required","","id","expensesValue",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["for","expensesDate","translate","",1,"fw-bold","form-label","required"],["InputTirmFilter","","name","expensesDate","type","date","required","","id","expensesDate",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["for","notes","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","name","notes","rows","3","id","notes",1,"form-control","fs-6",3,"ngModelChange","ngModel"],[1,"position-relative","d-inline-block"],[1,"position-absolute","top-100","start-100","translate-middle"],["placement","right","ngbTooltip","Select Image",1,"mb-0",3,"click"],[1,"avatar-xs"],[1,"avatar-title","bg-light","border","rounded-circle","text-muted","cursor-pointer"],[1,"ri-image-fill"],["value","","type","file","accept","image/png, image/gif, image/jpeg",1,"form-control","d-none",3,"change"],[1,"d-flex","justify-content-center","w-100"],[1,"avatar-xl-custom","mx-2","position-relative"],["class","position-absolute bx bx-x-circle text-white","style","background: red; top: 1px; right: -4px; font-size: 1rem;\n                                                border-radius: 50% ",3,"click",4,"ngIf"],[1,"avatar-title","bg-light","rounded"],["id","product-img1","alt","",1,"avatar-xl-custom","h-auto",3,"src"],[1,"d-flex","gap-2","justify-content-end","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger",3,"disabled"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],["translate","",1,"fw-bold","fs-4"],["translate","",1,"text-danger","text-center"],[1,"position-absolute","bx","bx-x-circle","text-white",2,"background","red","top","1px","right","-4px","font-size","1rem","border-radius","50%",3,"click"],[3,"deleteConfirm","dismiss"]],template:function(i,n){if(1&i){const a=e.RV6();e.nrm(0,"app-breadcrumbs",10),e.nI1(1,"translate"),e.j41(2,"div",11)(3,"div",12)(4,"div",13)(5,"base-filter",14),e.bIt("reset",function(){return e.eBV(a),e.Njj(n.onReset())})("search",function(){return e.eBV(a),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(n.onExportXlsx())})("addNew",function(){e.eBV(a);const s=e.sdS(22);return e.Njj(n.openModalTitle(s,"lg"))}),e.qex(6,15),e.j41(7,"div",16)(8,"div",17)(9,"input",18),e.nI1(10,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.filterValue,s)||(n.pagination.filterValue=s),e.Njj(s)}),e.k0s(),e.nrm(11,"i",19),e.k0s()(),e.bVm(),e.k0s(),e.j41(12,"div",20),e.nrm(13,"ngx-ui-loader",21),e.j41(14,"div",22)(15,"p-table",23,0),e.bIt("onLazyLoad",function(s){return e.eBV(a),e.Njj(n.tableChange(s))})("selectionChange",function(s){return e.eBV(a),e.Njj(n.onSelectionChange(s))}),e.DNE(17,Ba,25,0,"ng-template",24)(18,Aa,30,21,"ng-template",25),e.k0s()(),e.DNE(19,Ua,2,0,"div",26)(20,Ya,6,8,"div",27),e.k0s()()()(),e.DNE(21,Ka,63,20,"ng-template",null,1,e.C5r)(23,Za,1,0,"ng-template",null,2,e.C5r)}2&i&&(e.FS9("title",e.bMT(1,15,n.title)),e.Y8G("breadcrumbItems",n.breadCrumbItems),e.R7$(5),e.Y8G("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(10,17,"task.tasklist.subject")),e.R50("ngModel",n.pagination.filterValue),e.R7$(4),e.Y8G("hasProgressBar",!1)("fgsType",n.loaderSearchShap)("loaderId",n.searchLoader),e.R7$(2),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[c.bT,d.qT,d.me,d.Q0,d.BC,d.cb,d.YS,d.vS,d.cV,m.s5,ue.m,$.b,ae.w,U.p,Y.g,g.Mm,C.XI,P.Ei,C.Tg,v.Cv,V.vr,m.md,B.m,K.m,c.vh,g.D9],encapsulation:2})}}return r})(),ts=(()=>{class r extends ke.E{constructor(t,i,n){super(t,i,n)}static{this.\u0275fac=function(i){return new(i||r)(e.KVO(f.Ix),e.KVO(je),e.KVO(y.u))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function ns(r,l){1&r&&(e.j41(0,"tr",27)(1,"th",28),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",29),e.nrm(4,"i",30),e.EFF(5," orderManagement.expensesOrders.code "),e.k0s(),e.j41(6,"th",31),e.nrm(7,"i",30),e.EFF(8," orderManagement.expensesOrders.expensesItem "),e.k0s(),e.j41(9,"th",31),e.nrm(10,"i",30),e.EFF(11," orderManagement.expensesOrders.date "),e.k0s(),e.j41(12,"th",31),e.nrm(13,"i",30),e.EFF(14," orderManagement.expensesOrders.price "),e.k0s(),e.j41(15,"th",31),e.nrm(16,"i",30),e.EFF(17," orderManagement.expensesOrders.creationUser "),e.k0s(),e.j41(18,"th",31),e.nrm(19,"i",30),e.EFF(20," orderManagement.expensesOrders.creationDate "),e.k0s(),e.j41(21,"th",31),e.nrm(22,"i",30),e.EFF(23," orderManagement.expensesOrders.attachFile "),e.k0s(),e.nrm(24,"th",32),e.k0s())}function is(r,l){if(1&r&&(e.nrm(0,"i",40),e.EFF(1),e.nI1(2,"date"),e.nrm(3,"br")(4,"i",41),e.EFF(5),e.nI1(6,"date"),e.nrm(7,"br")(8,"i",42),e.EFF(9)),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",e.i5U(2,3,t.creationTime,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",e.i5U(6,6,t.updatedDate,"yyyy-MM-dd HH:mm:ss")," "),e.R7$(4),e.SpI(" ",t.createdUserName," ")}}function rs(r,l){if(1&r){const t=e.RV6();e.j41(0,"tr",33)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.nI1(9,"date"),e.k0s(),e.j41(10,"td"),e.EFF(11),e.k0s(),e.j41(12,"td"),e.EFF(13),e.k0s(),e.j41(14,"td"),e.EFF(15),e.nI1(16,"date"),e.k0s(),e.j41(17,"td")(18,"a",34),e.EFF(19," orderManagement.expensesOrders.show "),e.k0s()(),e.j41(20,"td"),e.DNE(21,is,10,9,"ng-template",null,3,e.C5r),e.nrm(23,"i",35),e.j41(24,"button",36),e.nI1(25,"translate"),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),o=e.sdS(20);return e.Njj(a.editModal(n,o))}),e.nrm(26,"i",37),e.k0s(),e.j41(27,"button",38),e.nI1(28,"translate"),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),o=e.sdS(22);return e.Njj(a.openModal(n.expensesOrderCode,o))}),e.nrm(29,"i",39),e.k0s()()()}if(2&r){const t=l.$implicit,i=l.rowIndex,n=e.sdS(22),a=e.XpG();e.R7$(2),e.JRh(i+1),e.R7$(2),e.JRh(t.expensesOrderCode),e.R7$(2),e.JRh(t.expensesItemName),e.R7$(2),e.JRh(e.i5U(9,11,t.expensesDate,"dd-MM-yyyy")),e.R7$(3),e.JRh(t.expensesValue),e.R7$(2),e.JRh(t.createdUserName),e.R7$(2),e.JRh(e.i5U(16,14,t.createdDate,"dd-MM-yyyy")),e.R7$(3),e.FS9("href",a.serverPath+t.attachFilePath,e.B4B),e.R7$(5),e.Y8G("ngbTooltip",n),e.R7$(),e.FS9("pTooltip",e.bMT(25,17,"general.edit")),e.R7$(3),e.FS9("pTooltip",e.bMT(28,19,"general.delete"))}}function as(r,l){1&r&&(e.j41(0,"div",43),e.EFF(1," general.table.noData "),e.k0s())}function ss(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",44)(1,"div",45),e.nrm(2,"ngb-pagination-info",46),e.j41(3,"table-length",47),e.bIt("lengthChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.ListItemChange(n))}),e.k0s()(),e.j41(4,"div",48)(5,"ngb-pagination",49),e.bIt("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.pageChanged(n))}),e.mxI("pageChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.pagination.pageNumber,n)||(a.pagination.pageNumber=n),e.Njj(n)}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("pagination",t.pagination),e.R7$(),e.Y8G("lengthTable",t.tableLengthSelect),e.R7$(2),e.Y8G("pageSize",t.pagination.pageSize)("collectionSize",t.pagination.totalItems),e.R50("page",t.pagination.pageNumber),e.Y8G("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}function os(r,l){1&r&&(e.j41(0,"span",87),e.EFF(1,"general.action.register "),e.k0s())}function ls(r,l){1&r&&(e.j41(0,"span",87),e.EFF(1,"general.action.edit "),e.k0s())}function ds(r,l){1&r&&(e.j41(0,"div",88),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function ms(r,l){1&r&&(e.j41(0,"div",88),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function cs(r,l){1&r&&(e.j41(0,"div",88),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function ps(r,l){1&r&&(e.j41(0,"div",88),e.EFF(1," general.message.filedIdRequired "),e.k0s())}function gs(r,l){if(1&r){const t=e.RV6();e.j41(0,"i",89),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.removeImage())}),e.k0s()}}function _s(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",50)(1,"h4",51),e.DNE(2,os,2,0,"span",52)(3,ls,2,0,"span",52),e.nrm(4,"span",53),e.k0s(),e.j41(5,"button",54),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"form",55,4),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onSubmit())}),e.nrm(8,"ngx-ui-loader",56),e.j41(9,"div",57)(10,"div",58)(11,"div",59)(12,"div",10)(13,"div",60)(14,"div",10)(15,"div",61)(16,"label",62),e.EFF(17,"orderManagement.expensesOrders.expensesItem"),e.k0s(),e.j41(18,"ng-select",63,5),e.nI1(20,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.form.expensesItemCode,n)||(a.form.expensesItemCode=n),e.Njj(n)}),e.k0s(),e.DNE(21,ds,2,0,"div",64),e.k0s(),e.j41(22,"div",61)(23,"label",65),e.EFF(24,"orderManagement.expensesOrders.price"),e.k0s(),e.j41(25,"div",66)(26,"input",67,6),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.form.expensesValue,n)||(a.form.expensesValue=n),e.Njj(n)}),e.k0s(),e.DNE(28,ms,2,0,"div",64),e.k0s()(),e.j41(29,"div",61)(30,"label",68),e.EFF(31,"orderManagement.expensesOrders.date"),e.k0s(),e.j41(32,"div",66)(33,"input",69,7),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.form.expensesDate,n)||(a.form.expensesDate=n),e.Njj(n)}),e.k0s(),e.DNE(35,cs,2,0,"div",64),e.k0s()(),e.j41(36,"div",61)(37,"label",70),e.EFF(38,"orderManagement.expensesOrders.notes"),e.k0s(),e.j41(39,"div",66)(40,"textarea",71,8),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.form.notes,n)||(a.form.notes=n),e.Njj(n)}),e.EFF(42,"                                "),e.k0s(),e.DNE(43,ps,2,0,"div",64),e.k0s()()()(),e.j41(44,"div",60)(45,"div",72)(46,"label",62),e.EFF(47,"orderManagement.expensesOrders.attachFile"),e.k0s(),e.j41(48,"div",73)(49,"label",74),e.bIt("click",function(){e.eBV(t);const n=e.sdS(54);return e.Njj(n.click())}),e.j41(50,"div",75)(51,"div",76),e.nrm(52,"i",77),e.k0s()()(),e.j41(53,"input",78,9),e.bIt("change",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.onFileChanged(n))}),e.k0s()(),e.j41(55,"div",79)(56,"div",80),e.DNE(57,gs,1,0,"i",81),e.j41(58,"div",82),e.nrm(59,"img",83),e.k0s()()()()()(),e.j41(60,"div",84),e.nrm(61,"button",85),e.j41(62,"button",86),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()()}if(2&r){const t=e.sdS(7),i=e.sdS(19),n=e.sdS(27),a=e.sdS(34),o=e.sdS(41),s=e.XpG();e.R7$(2),e.Y8G("ngIf",!s.isEditForm),e.R7$(),e.Y8G("ngIf",s.isEditForm),e.R7$(5),e.Y8G("hasProgressBar",!1)("fgsType",s.loaderOperationShap)("loaderId",s.operationLoader),e.R7$(10),e.FS9("placeholder",e.bMT(20,20,"orderManagement.expensesOrders.expensesItem")),e.Y8G("items",s.expensesItems),e.R50("ngModel",s.form.expensesItemCode),e.R7$(3),e.Y8G("ngIf",i.invalid&&i.touched),e.R7$(5),e.R50("ngModel",s.form.expensesValue),e.R7$(2),e.Y8G("ngIf",n.invalid&&n.touched),e.R7$(5),e.R50("ngModel",s.form.expensesDate),e.Y8G("altInput",!0)("convertModelValue",!0),e.R7$(2),e.Y8G("ngIf",a.invalid&&a.touched),e.R7$(5),e.R50("ngModel",s.form.notes),e.R7$(3),e.Y8G("ngIf",o.invalid&&o.touched),e.R7$(14),e.Y8G("ngIf",s.image.path),e.R7$(2),e.Y8G("src",s.image.isApi?s.serverPath+s.image.path:s.image.path,e.B4B),e.R7$(2),e.Y8G("disabled",!t.valid||!s.image.path)}}function hs(r,l){if(1&r){const t=e.RV6();e.j41(0,"delete-modal",90),e.bIt("deleteConfirm",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.DeleteConfirm())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}}let us=(()=>{class r extends G.w{constructor(t,i,n,a,o,s,b,u,j,F,x,T){super(t,i,u,o,n,a,b),this.baseService=o,this.expensesCategoriesService=s,this.service=j,this.excelService=F,this._formDataService=x,this.router=T,this.title="orderManagement.expensesOrders.title",this.submitted=!1,this.cities={},this.channels={},this.leadTypes={},this.image={isApi:!1,path:""},this.form={image:""},this.isResolveList=!0,this.serverPath=ie.c.mediaUrl,this.loadentities(),this.getExpensesItems()}getExpensesItems(){this.expensesCategoriesService.getDropDown().subscribe({next:t=>{this.expensesItems=t.data}})}onSubmit(){this.ngxLoader.startLoader(this.operationLoader),!0===this.isEditForm?this.editEntity():this.registerEntity()}onSearch(){this.ngxLoader.startLoader(this.searchLoader),this.loadentities()}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.ngxLoader.startLoader(this.searchLoader),this.baseService.get(this.pagination).pipe((0,h.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader(this.searchLoader),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader(this.searchLoader),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,"Service Type",[])}mapExcel(){let t=[];return this.entities?.forEach(i=>{t.push({title:i.title,body:i.body,type:i.type,isActive:this.getTranslationText("general.table.active")})}),t}editModal(t,i,n="lg"){this.isEditForm=!0,this.form=t,this.image={isApi:!0,path:t.attachFilePath},this.modalService.open(i,{centered:!0,size:n})}registerEntity(){let t=this._formDataService.formatFormData(this.form);this.baseService.register(t).pipe((0,D.O)(),(0,O.c)(this.mainDelay),(0,w.Z)(),(0,h.Q)(this.notifier),(0,N.j)(()=>this.ngxLoader.stopLoader(this.operationLoader)),(0,ye.W)(i=>(0,Re.$)(i))).subscribe(i=>{i.success?this.submitFunished():this.alertService.error("general.message."+i.message)},i=>{this.alertService.error("general.message."+i)})}editEntity(){let t=this._formDataService.formatFormData(this.form);this.baseService.editExpensesItems(this.form.expensesOrderCode,t).pipe((0,D.O)(),(0,O.c)(this.mainDelay),(0,w.Z)(),(0,h.Q)(this.notifier),(0,N.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(i=>{i.success?this.submitFunished():this.alertService.error("general.message."+i.message)},i=>{this.alertService.error("general.message."+i)})}DeleteConfirm(){console.log(this.selectedRow),this.ngxLoader.startLoader(this.deleteLoader),this.baseService.Delete(this.selectedRow[0].id).pipe((0,D.O)(),(0,O.c)(this.mainDelay),(0,w.Z)(),(0,h.Q)(this.notifier),(0,N.j)(()=>this.ngxLoader.stopLoader(this.deleteLoader))).subscribe(i=>{i.success?(this.alertService.success(),this.loadentities(),this.modalService.dismissAll(),this.resetSelected()):this.alertService.error("general.message."+i)},()=>{this.alertService.error()})}onFileChanged(t){if(t.target.files&&t.target.files[0]){let i=t.target.files.length;for(let n=0;n<i;n++){let a=new FileReader;this.form.image=t.target.files.item(n),a.onload=o=>{this.image={isApi:!1,path:o.target.result}},a.readAsDataURL(t.target.files[n])}}}removeImage(){console.log(),this.form.image="",this.image={id:0,path:""}}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(f.nX),e.rXU(g.c$),e.rXU(y.u),e.rXU(c.vh),e.rXU(je),e.rXU(be),e.rXU(v.eD),e.rXU(m.Bq),e.rXU(Ce.m),e.rXU(L.V),e.rXU(he.Q),e.rXU(f.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-team-expenses-orders"]],features:[e.Vt3],decls:23,vars:14,consts:[["tableMaster",""],["whatsappModal",""],["deleteModal",""],["tooltipContent",""],["formEntity","ngForm"],["expensesItemCode","ngModel"],["expensesValue","ngModel"],["expensesDate","ngModel"],["notes","ngModel"],["FileInput",""],[1,"row"],[1,"col-lg-12"],[1,"card","grid"],[3,"reset","search","exportXlsx","addNew","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-6","mb-2"],[1,"search-box"],["InputTirmFilter","","type","search","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],[1,"card-body"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[1,"table-responsive"],["dataKey","id",3,"onLazyLoad","selectionChange","value","rows","lazy","totalRecords"],["pTemplate","header"],["pTemplate","body"],["class","text-center text-danger text-bold fs-6 p-3","translate","",4,"ngIf"],["class","row px-1 py-1 overflow-hidden",4,"ngIf"],[1,""],["translate","",2,"width",".5%"],["pSortableColumn","name","translate","",2,"width","10%"],[1,"ri-expand-up-down-line"],["pSortableColumn","mobile","translate","",2,"width","10%"],["translate","",2,"width","20%"],[1,"fs-5"],["target","_blank","translate","",3,"href"],["tooltipPosition","top",1,"mdi","mdi-cog-outline","d-inline","text-muted","fs-16","align-middle","me-1",3,"ngbTooltip"],["tooltipPosition","top",1,"btn","btn-sm","btn-soft-info","edit-list","mx-2",3,"click","pTooltip"],[1,"ri-pencil-fill","align-bottom","mx-1"],["tooltipPosition","top",1,"btn","btn-sm","btn-soft-danger","remove-list",3,"click","pTooltip"],[1,"ri-delete-bin-5-fill","align-bottom"],[1,"ri-history-fill","text-warning"],[1,"ri-history-fill","text-danger"],[1,"ri-user-location-fill","text-primary"],["translate","",1,"text-center","text-danger","text-bold","fs-6","p-3"],[1,"row","px-1","py-1","overflow-hidden"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[3,"pagination"],[3,"lengthChange","lengthTable"],[1,"col-sm-12","col-md-7","fs-3","d-flex","align-items-center","justify-content-center","justify-content-md-end"],[3,"pageChange","pageSize","collectionSize","page","maxSize","rotate","boundaryLinks"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["class","fw-bold fs-4","translate","",4,"ngIf"],["translate","orderManagement.expensesOrders.title",1,"fw-bold","fs-4"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[3,"ngSubmit"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-body"],[1,"mx-2"],[1,"col-12","col-lg-6"],[1,"col-12","col-md-12","mb-3"],["for","expensesItemCode","translate","",1,"fw-bold","form-label","required"],["name","expensesItemCode","bindValue","code","bindLabel","name","id","expensesItemCode","required","",3,"ngModelChange","items","placeholder","ngModel"],["class","text-danger text-center  ","translate","",4,"ngIf"],["for","expensesValue","translate","",1,"fw-bold","form-label","required"],[1,"input-group"],["InputTirmFilter","","name","expensesValue","type","number","required","","id","expensesValue",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["for","expensesDate","translate","",1,"fw-bold","form-label","required"],["InputTirmFilter","","name","expensesDate","mwlFlatpickr","","type","date","required","","id","expensesDate",1,"form-control","fs-6",3,"ngModelChange","ngModel","altInput","convertModelValue"],["for","notes","translate","",1,"fw-bold","form-label"],["InputTirmFilter","","name","notes","rows","3","id","notes",1,"form-control","fs-6",3,"ngModelChange","ngModel"],[1,"position-relative","d-inline-block"],[1,"position-absolute","top-100","start-100","translate-middle"],["placement","right","ngbTooltip","Select Image",1,"mb-0",3,"click"],[1,"avatar-xs"],[1,"avatar-title","bg-light","border","rounded-circle","text-muted","cursor-pointer"],[1,"ri-image-fill"],["value","","type","file","accept","image/png, image/gif, image/jpeg",1,"form-control","d-none",3,"change"],[1,"d-flex","justify-content-center","w-100"],[1,"avatar-xl-custom","mx-2","position-relative"],["class","position-absolute bx bx-x-circle text-white","style","background: red; top: 1px; right: -4px; font-size: 1rem;\n                                                border-radius: 50% ",3,"click",4,"ngIf"],[1,"avatar-title","bg-light","rounded"],["id","product-img1","alt","",1,"avatar-xl-custom","h-auto",3,"src"],[1,"d-flex","gap-2","justify-content-end","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger",3,"disabled"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],["translate","",1,"fw-bold","fs-4"],["translate","",1,"text-danger","text-center"],[1,"position-absolute","bx","bx-x-circle","text-white",2,"background","red","top","1px","right","-4px","font-size","1rem","border-radius","50%",3,"click"],[3,"deleteConfirm","dismiss"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",10)(1,"div",11)(2,"div",12)(3,"base-filter",13),e.bIt("reset",function(){return e.eBV(a),e.Njj(n.onReset())})("search",function(){return e.eBV(a),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(n.onExportXlsx())})("addNew",function(){e.eBV(a);const s=e.sdS(20);return e.Njj(n.openModalTitle(s,"lg"))}),e.qex(4,14),e.j41(5,"div",15)(6,"div",16)(7,"input",17),e.nI1(8,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.filterValue,s)||(n.pagination.filterValue=s),e.Njj(s)}),e.k0s(),e.nrm(9,"i",18),e.k0s()(),e.bVm(),e.k0s(),e.j41(10,"div",19),e.nrm(11,"ngx-ui-loader",20),e.j41(12,"div",21)(13,"p-table",22,0),e.bIt("onLazyLoad",function(s){return e.eBV(a),e.Njj(n.tableChange(s))})("selectionChange",function(s){return e.eBV(a),e.Njj(n.onSelectionChange(s))}),e.DNE(15,ns,25,0,"ng-template",23)(16,rs,30,21,"ng-template",24),e.k0s()(),e.DNE(17,as,2,0,"div",25)(18,ss,6,8,"div",26),e.k0s()()()(),e.DNE(19,_s,63,22,"ng-template",null,1,e.C5r)(21,hs,1,0,"ng-template",null,2,e.C5r)}2&i&&(e.R7$(3),e.Y8G("showExport",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(8,12,"task.tasklist.subject")),e.R50("ngModel",n.pagination.filterValue),e.R7$(4),e.Y8G("loaderId",n.searchLoader),e.R7$(2),e.Y8G("value",n.entities)("rows",n.pagination.pageSize)("lazy",!0)("totalRecords",n.pagination.totalItems),e.R7$(4),e.Y8G("ngIf",n.pagination.totalItems<=0),e.R7$(),e.Y8G("ngIf",n.pagination.totalItems>0))},dependencies:[c.bT,d.qT,d.me,d.Q0,d.BC,d.cb,d.YS,d.vS,d.cV,m.s5,R.kL,$.b,ae.w,U.p,Y.g,g.Mm,C.XI,P.Ei,C.Tg,v.Cv,V.vr,m.md,B.m,K.m,c.vh,g.D9],encapsulation:2})}}return r})();const bs=["FileInput"],fs=()=>["assigned.changeStatus"],vs=()=>["assigned.finishedOrder"];function Cs(r,l){if(1&r&&(e.j41(0,"span",55),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI("",t.districtName," ")}}function js(r,l){if(1&r&&(e.qex(0),e.j41(1,"span",56),e.EFF(2),e.k0s(),e.bVm()),2&r){const t=l.$implicit;e.R7$(2),e.JRh(t)}}function Fs(r,l){if(1&r&&(e.qex(0),e.j41(1,"span",56),e.EFF(2),e.k0s(),e.bVm()),2&r){const t=l.$implicit;e.R7$(2),e.JRh(t)}}function Ms(r,l){if(1&r&&(e.qex(0),e.j41(1,"span",56),e.EFF(2),e.k0s(),e.bVm()),2&r){const t=l.$implicit;e.R7$(2),e.JRh(t)}}function xs(r,l){if(1&r){const t=e.RV6();e.j41(0,"a",57),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(),o=e.sdS(29);return e.Njj(a.openChangeStatusModal(n,o))}),e.nrm(1,"i",58)(2,"span",59),e.k0s()}}function Ts(r,l){if(1&r){const t=e.RV6();e.j41(0,"a",60),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,a=e.XpG(),o=e.sdS(31);return a.GetOrderServiceAndPayment(n),e.Njj(a.openChangeStatusModal(n,o,"xl"))}),e.nrm(1,"i",61)(2,"span",62),e.k0s()}}function Ss(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",27)(1,"div",28)(2,"div",16)(3,"bdi")(4,"span")(5,"span"),e.EFF(6),e.nI1(7,"translate"),e.k0s()()(),e.nrm(8,"div",29),e.j41(9,"div",30)(10,"p",31),e.nrm(11,"i",32),e.EFF(12),e.nI1(13,"date"),e.k0s(),e.j41(14,"p",33),e.EFF(15),e.nI1(16,"translate"),e.k0s()(),e.j41(17,"a",34)(18,"h5",35),e.nrm(19,"i",36),e.EFF(20),e.k0s()(),e.j41(21,"div",37)(22,"div",38),e.nrm(23,"i",39),e.EFF(24),e.DNE(25,Cs,2,1,"span",40),e.k0s(),e.j41(26,"div"),e.nrm(27,"i",41),e.j41(28,"span",42),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.copytext(n.mobile))}),e.EFF(29),e.nrm(30,"i",43),e.k0s()()(),e.nrm(31,"hr"),e.j41(32,"div",44)(33,"div"),e.nrm(34,"i",45),e.DNE(35,js,3,1,"ng-container",46),e.k0s()(),e.j41(36,"div",47)(37,"div",48)(38,"h6"),e.nrm(39,"i",49),e.EFF(40),e.nI1(41,"translate"),e.k0s(),e.DNE(42,Fs,3,1,"ng-container",46),e.k0s(),e.j41(43,"div",50)(44,"h6"),e.nrm(45,"i",51),e.EFF(46),e.nI1(47,"translate"),e.k0s(),e.DNE(48,Ms,3,1,"ng-container",46),e.k0s()(),e.j41(49,"div",52),e.DNE(50,xs,3,0,"a",53)(51,Ts,3,0,"a",54),e.k0s()()()()}if(2&r){const t=l.$implicit,i=e.XpG();e.R7$(4),e.ZvI("ribbon ",t.teamStatusName," round-shape "),e.R7$(2),e.JRh(e.bMT(7,18,"orderManagement.order."+t.teamStatusName)),e.R7$(6),e.SpI(" ",e.i5U(13,20,t.visitDate,"yyyy-MM-dd")," "),e.R7$(3),e.Lme(" ",e.bMT(16,23,"orderManagement.order.orderCode"),": #SO#",t.orderCode," "),e.R7$(5),e.SpI(" ",t.agentName," "),e.R7$(4),e.SpI(" ",t.cityName," "),e.R7$(),e.Y8G("ngIf",null!==t.districtName),e.R7$(4),e.SpI("",t.mobile," "),e.R7$(6),e.Y8G("ngForOf",i.getServices(t.services)),e.R7$(5),e.SpI(" ",e.bMT(41,25,"orderManagement.order.assignTo"),""),e.R7$(2),e.Y8G("ngForOf",i.getTimes(t.teamNames)),e.R7$(4),e.SpI(" ",e.bMT(47,27,"orderManagement.order.workTimes"),""),e.R7$(2),e.Y8G("ngForOf",i.getTimes(t.workTimes)),e.R7$(2),e.Y8G("hasPermission",e.lJ4(29,fs)),e.R7$(),e.Y8G("hasPermission",e.lJ4(30,vs))}}function Is(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",71)(1,"label",79),e.EFF(2,"orderManagement.order.cancelReasonName"),e.k0s(),e.j41(3,"ng-select",80),e.nI1(4,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG(2);return e.DH7(a.form.cancelReasonCode,n)||(a.form.cancelReasonCode=n),e.Njj(n)}),e.k0s()()}if(2&r){const t=e.XpG(2);e.R7$(3),e.FS9("placeholder",e.bMT(4,4,"orderManagement.order.cancelReasonName")),e.Y8G("items",t.cancelReasons)("multiple",!1),e.R50("ngModel",t.form.cancelReasonCode)}}function ks(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",63)(1,"div",64)(2,"h4",65),e.nrm(3,"span",66),e.k0s(),e.j41(4,"button",67),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(5,"div",68),e.nrm(6,"ngx-ui-loader",69),e.j41(7,"form",70,5),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.changeStatus())}),e.j41(9,"div",11)(10,"div",71)(11,"label",72),e.EFF(12,"orderManagement.order.changeTeamStatus"),e.k0s(),e.j41(13,"ng-select",73),e.nI1(14,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.form.teamStatus,n)||(a.form.teamStatus=n),e.Njj(n)}),e.k0s()(),e.DNE(15,Is,5,6,"div",74),e.j41(16,"div",71)(17,"label",72),e.EFF(18,"orderManagement.order.teamStatusNotes"),e.k0s(),e.j41(19,"textarea",75),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.form.teamStatusNotes,n)||(a.form.teamStatusNotes=n),e.Njj(n)}),e.k0s()()(),e.j41(20,"div",35)(21,"button",76),e.nrm(22,"i",77)(23,"span",78),e.k0s()()()()()}if(2&r){const t=e.sdS(8),i=e.XpG();e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",i.loaderOperationShap)("loaderId",i.operationLoader),e.R7$(7),e.FS9("placeholder",e.bMT(14,10,"orderManagement.order.changeTeamStatus")),e.Y8G("items",i.statusList)("multiple",!1),e.R50("ngModel",i.form.teamStatus),e.R7$(2),e.Y8G("ngIf",5==i.form.teamStatus),e.R7$(4),e.R50("ngModel",i.form.teamStatusNotes),e.R7$(2),e.Y8G("disabled",!t.valid)}}function ys(r,l){if(1&r&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",t.price," ")}}function Rs(r,l){if(1&r){const t=e.RV6();e.j41(0,"span",122)(1,"input",123),e.nI1(2,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG(3);return e.DH7(a.editPrice,n)||(a.editPrice=n),e.Njj(n)}),e.k0s(),e.j41(3,"button",124),e.bIt("click",function(){e.eBV(t);const n=e.XpG().index,a=e.XpG(2);return e.Njj(a.editEachPrice(n))}),e.nrm(4,"i",125),e.k0s(),e.j41(5,"button",126),e.bIt("click",function(){e.eBV(t);const n=e.XpG(3);return e.Njj(n.isEditPrice=!1)}),e.nrm(6,"i",127),e.k0s()()}if(2&r){const t=e.XpG(3);e.R7$(),e.FS9("placeholder",e.bMT(2,2,"orderManagement.order.notes")),e.R50("ngModel",t.editPrice)}}function Es(r,l){if(1&r){const t=e.RV6();e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.DNE(4,ys,2,1,"span",97)(5,Rs,7,4,"span",118),e.k0s(),e.j41(6,"td"),e.EFF(7),e.k0s(),e.j41(8,"td")(9,"button",119),e.bIt("click",function(){const n=e.eBV(t).index,a=e.XpG(2);return e.Njj(a.deleteService(n))}),e.nrm(10,"i",120),e.k0s(),e.j41(11,"button",92),e.bIt("click",function(){const n=e.eBV(t).index,a=e.XpG(2);return a.isEditPrice=!0,e.Njj(a.editPrice=a.finishOrderForm.invoiceService[n].price)}),e.nrm(12,"i",121),e.k0s()()()}if(2&r){const t=l.$implicit,i=e.XpG(2);e.R7$(2),e.JRh(t.service),e.R7$(2),e.Y8G("ngIf",!i.isEditPrice),e.R7$(),e.Y8G("ngIf",i.isEditPrice),e.R7$(2),e.JRh(t.notes)}}function Ns(r,l){1&r&&(e.j41(0,"tr")(1,"td",128),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&r&&(e.R7$(2),e.JRh(e.bMT(3,1,"orderManagement.order.noData")))}function Ds(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",129)(1,"i",130),e.bIt("click",function(){const n=e.eBV(t),a=n.$implicit,o=n.index,s=e.XpG(2);return e.Njj(s.removeImage(a.id,o))}),e.k0s(),e.j41(2,"div",131),e.nrm(3,"img",132),e.k0s()()}if(2&r){const t=l.$implicit,i=e.XpG(2);e.R7$(3),e.Y8G("src",0==t.id?t.path:i.serverPath+t.path,e.B4B)}}function Os(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",64)(1,"h4",65),e.nrm(2,"span",81),e.k0s(),e.j41(3,"button",67),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(4,"div",68)(5,"form",null,5),e.nrm(7,"ngx-ui-loader",69),e.j41(8,"div",82)(9,"div",68)(10,"div",83)(11,"div",84)(12,"div",85)(13,"label",86),e.EFF(14,"orderManagement.order.services"),e.k0s()(),e.j41(15,"div",87)(16,"ng-select",88,6),e.nI1(18,"translate"),e.bIt("change",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.setService(n))}),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.finishOrderForm.serviceCode,n)||(a.finishOrderForm.serviceCode=n),e.Njj(n)}),e.k0s()(),e.j41(19,"div",87)(20,"div",89)(21,"input",90,7),e.nI1(23,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.finishOrderForm.note,n)||(a.finishOrderForm.note=n),e.Njj(n)}),e.k0s()()(),e.j41(24,"div",91)(25,"button",92),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.addService())}),e.nrm(26,"i",93),e.k0s()(),e.j41(27,"div",94)(28,"table",95)(29,"thead")(30,"tr")(31,"th",96),e.EFF(32," orderManagement.order.service "),e.k0s(),e.j41(33,"th",96),e.EFF(34," orderManagement.order.price "),e.k0s(),e.j41(35,"th",96),e.EFF(36," orderManagement.order.notes "),e.k0s(),e.j41(37,"th",96),e.EFF(38," orderManagement.order.actions "),e.k0s()()(),e.j41(39,"tbody"),e.DNE(40,Es,13,4,"tr",46)(41,Ns,4,3,"tr",97),e.k0s()()()(),e.j41(42,"div",98)(43,"div",99)(44,"label",100),e.EFF(45,"orderManagement.order.assignedOrders.usedShow"),e.k0s(),e.j41(46,"div",101),e.EFF(47),e.k0s()()(),e.j41(48,"div",98)(49,"div",102)(50,"label",103),e.EFF(51,"orderManagement.order.assignedOrders.total"),e.k0s(),e.j41(52,"div",104),e.EFF(53),e.k0s()(),e.j41(54,"div",102)(55,"label",103),e.EFF(56,"orderManagement.order.assignedOrders.extraDiscount"),e.k0s(),e.j41(57,"div",104),e.EFF(58),e.k0s()(),e.j41(59,"div",102)(60,"label",103),e.EFF(61,"orderManagement.order.assignedOrders.tax"),e.k0s(),e.j41(62,"div",104),e.EFF(63),e.k0s()(),e.j41(64,"div",102)(65,"label",103),e.EFF(66,"orderManagement.order.assignedOrders.promotionDiscount"),e.k0s(),e.j41(67,"div",104),e.EFF(68),e.k0s()(),e.j41(69,"div",102)(70,"label",103),e.EFF(71,"orderManagement.order.assignedOrders.net"),e.k0s(),e.j41(72,"div",104),e.EFF(73),e.k0s()(),e.j41(74,"div",102)(75,"label",103),e.EFF(76,"orderManagement.order.assignedOrders.paid"),e.k0s(),e.j41(77,"div",104),e.EFF(78),e.k0s()(),e.j41(79,"div",102)(80,"label",105),e.EFF(81,"orderManagement.order.assignedOrders.paymentMethod"),e.k0s(),e.j41(82,"div",106)(83,"ng-select",107,8),e.nI1(85,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.finishOrderForm.paymentTypeCode,n)||(a.finishOrderForm.paymentTypeCode=n),e.Njj(n)}),e.k0s()()(),e.j41(86,"div",102)(87,"label",103),e.EFF(88,"orderManagement.order.assignedOrders.remain"),e.k0s(),e.j41(89,"div",104),e.EFF(90),e.k0s()(),e.j41(91,"div",108)(92,"label",103),e.EFF(93,"orderManagement.order.assignedOrders.notes"),e.k0s(),e.j41(94,"textarea",109,9),e.nI1(96,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.finishOrderForm.notes,n)||(a.finishOrderForm.notes=n),e.Njj(n)}),e.EFF(97,"                                "),e.k0s()(),e.j41(98,"div",110)(99,"label",103),e.EFF(100,"orderManagement.order.assignedOrders.notes"),e.k0s(),e.j41(101,"div",106)(102,"button",111),e.bIt("click",function(){e.eBV(t);const n=e.sdS(107);return e.Njj(n.click())}),e.EFF(103," orderManagement.order.assignedOrders.select "),e.k0s(),e.j41(104,"div",112),e.DNE(105,Ds,4,1,"div",113),e.k0s()(),e.j41(106,"input",114,10),e.bIt("change",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.onFileChanged(n))}),e.k0s()()(),e.j41(108,"div",115)(109,"button",116),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.finishOrder())}),e.k0s(),e.j41(110,"button",117),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()()()}if(2&r){const t=e.XpG();e.R7$(7),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader),e.R7$(9),e.FS9("placeholder",e.bMT(18,27,"orderManagement.order.services")),e.Y8G("items",t.services)("multiple",!1),e.R50("ngModel",t.finishOrderForm.serviceCode),e.R7$(5),e.FS9("placeholder",e.bMT(23,29,"orderManagement.order.notes")),e.R50("ngModel",t.finishOrderForm.note),e.R7$(19),e.Y8G("ngForOf",t.finishOrderForm.invoiceService),e.R7$(),e.Y8G("ngIf",0==t.finishOrderForm.invoiceService.length),e.R7$(6),e.SpI(" ",t.finishOrderForm.usedShow||"--"," "),e.R7$(6),e.SpI(" ",t.finishOrderForm.total||"0"," "),e.R7$(5),e.SpI(" ",t.finishOrderForm.discountAdd||"0"," "),e.R7$(5),e.SpI(" ",t.finishOrderForm.tax||"0"," "),e.R7$(5),e.SpI(" ",t.finishOrderForm.promotionDiscount||"0"," "),e.R7$(5),e.SpI(" ",t.finishOrderForm.net||"0"," "),e.R7$(5),e.SpI(" ",t.finishOrderForm.paid||"0"," "),e.R7$(5),e.FS9("placeholder",e.bMT(85,31,"orderManagement.order.assignedOrders.paymentMethod")),e.Y8G("items",t.paymentTypes)("multiple",!1),e.R50("ngModel",t.finishOrderForm.paymentTypeCode),e.R7$(7),e.SpI(" ",t.finishOrderForm.remain||"--"," "),e.R7$(4),e.FS9("placeholder",e.bMT(96,33,"orderManagement.order.notes")),e.R50("ngModel",t.finishOrderForm.notes),e.R7$(11),e.Y8G("ngForOf",t.images),e.R7$(4),e.Y8G("disabled",!t.finishOrderForm.paymentTypeCode)}}function ws(r,l){if(1&r&&e.nrm(0,"order-operation",133),2&r){const t=e.XpG();e.Y8G("isOrderEdit",!1)("isInner",!0)("orderCode",t.orderSelected)}}function Vs(r,l){if(1&r){const t=e.RV6();e.j41(0,"order-timeline",134),e.bIt("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderSelected",t.orderSelected)}}function Gs(r,l){if(1&r){const t=e.RV6();e.j41(0,"form",70,5),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.RollBack())}),e.nrm(2,"ngx-ui-loader",69),e.j41(3,"div",82)(4,"div",135)(5,"button",136),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(6,"div",68)(7,"div",137),e.nrm(8,"lord-icon",138),e.j41(9,"div",139),e.nrm(10,"h3",140)(11,"p",141),e.k0s()(),e.j41(12,"div",142),e.nrm(13,"button",143),e.j41(14,"button",117),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(2),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}let Ls=(()=>{class r extends G.w{constructor(t,i,n,a,o,s,b,u,j,F,x,T,I,X,ce,pe,Fe,so){super(t,i,b,n,a,o,s),this.baseService=n,this.authDaamService=u,this.invoicesService=j,this._servicesService=F,this.excelService=x,this._formDataService=T,this.cityService=I,this.districtService=X,this.channelService=ce,this.orderAssignService=pe,this.cancelReasonService=Fe,this.router=so,this.title="orderManagement.order.assignedOrders.title",this.titleOperation="orderManagement.order.assignedOrders.titleOperation",this.language=localStorage.getItem("language"),this.assignUsers=[],this.times=[],this.images=[],this.employees=[],this.searchForm={},this.finishOrderForm={invoiceService:[],invoiceAttachImages:[],usedShow:"",promotionDiscount:""},this.pagination={pageNumber:1,pageSize:100},this.isResolveList=!1,this.editPrice=0,this.isEditPrice=!1,this.formPassword={},this.OrderStatusEnum=te,this.roles=[],this.userTypes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.serverPath=ie.c.mediaUrl,this.countLoad=2,this.orderSelected=0,this.cities=[],this.districts=[],this.channels=[],this.services=[],this.statusList=[],this.cancelReasons=[],this.statusList=this.baseService.getTeamStatus(),this.loadentities(),this.GetCities(),this.GetServicesDropDown(),this.GetPaymentTypesDropDown(),this.GetChannels(),this.translateStatus(),this.GetReturnReasons()}GetReturnReasons(){this.cancelReasonService.getDropDown().subscribe(t=>{this.cancelReasons=t.data},t=>{console.log(t)})}translateStatus(){this.statusList.forEach(t=>{t.name=this.getTranslationText("orderManagement.order."+t.name)})}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetDistricts(t){this.finishOrderForm.districtCode=null,this.districtService.getByCityId(t).subscribe(i=>{this.districts=i.data},i=>{console.log(i)})}GetChannels(){this.channelService.getDropDown().subscribe(t=>{this.channels=t.data},t=>{console.log(t)})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,h.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){var i;if(this.ngxLoader.startLoader("assignLoader"),(i=this.searchForm.dates)+void 0&&i.includes("to")){var t=i.split("to").map(n=>n.trim());this.pagination.visitDateFrom=t[0]+"T00:00:00.000",this.pagination.visitDateTo=t[1]+"T23:59:59.999"}else this.pagination.visitDateFrom=null,this.pagination.visitDateTo=null;(i=this.searchForm.creationDates)+void 0&&i.includes("to")?(t=i.split("to").map(a=>a.trim()),this.pagination.creationDateFrom=t[0]+"T00:00:00.000",this.pagination.creationDateTo=t[1]+"T23:59:59.999"):(this.pagination.creationDateFrom=null,this.pagination.creationDateTo=null),this.pagination.subject=this.searchForm.name,null!=this.searchForm.status&&(this.pagination.status=Number.parseInt(this.searchForm.status)),null!=this.searchForm.priority&&(this.pagination.priority=Number.parseInt(this.searchForm.priority)),this.loadentities()}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.ngxLoader.startLoader("assignLoader"),this.pagination.statusFilter=this.OrderStatusEnum.Assigned,this.orderAssignService.get(this.pagination).pipe((0,h.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader("assignLoader"),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader("assignLoader"),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({"Order Code":i.orderCode,"City Name":i.cityName,"District Name":i.districtName?i.districtName:"--","Agent Name":i.agentName,Mobile:i.mobile,"Assigned To":i.teamNames,Times:i.workTimes,Services:this.getServices(i.services),Status:this.translateService.instant(`orderManagement.order.${i.teamStatusName}`)})}),t}reCallOrder(){this.ngxLoader.startLoader(_.Fq),this.baseService.UpdateCallCounter(this.orderSelected).pipe((0,D.O)(),(0,O.c)(this.mainDelay),(0,w.Z)(),(0,h.Q)(this.notifier),(0,N.j)(()=>this.ngxLoader.stopLoader(_.Fq))).subscribe({next:t=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,this.translateService.instant(this.title),[])}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return t.isCancel?"bg-warning-subtle text-warning":t.isFinish?"bg-success-subtle text-success":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen||t.isFree?"bg-warning-subtle text-warning":"bg-success-subtle text-success"}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isFree?"orderManagement.order.free":"orderManagement.order.finished"}openModal(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}oncityChange(t){this.GetDistricts(t.code)}getTimes(t){return t.split(",")}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}getTeamStatus(t){return 0==t||1==t||2==t?"ribbon-info":3==t?"ribbon-success":4==t||5==t?"ribbon-danger":6==t?"ribbon-danger ":7==t?"ribbon-success":""}openChangeStatusModal(t,i,n="md"){this.form={},this.form.teamStatus=t.teamStatus,this.finishOrderForm.orderCode=t.orderCode,this.orderSelected=t.orderCode,this.modalService.open(i,{centered:!0,size:n})}changeStatus(){this.ngxLoader.startLoader(this.operationLoader),this.baseService.ChangeTeamStatus({OrderCode:this.orderSelected,teamStatus:this.form.teamStatus,cancelReasonCode:this.form.cancelReasonCode,teamStatusNotes:this.form.teamStatusNotes}).pipe((0,h.Q)(this.notifier),(0,N.j)(()=>this.ngxLoader.stopLoader(this.operationLoader))).subscribe(i=>{this.loadentities(),this.alertService.success(),this.modalService.dismissAll()},()=>{this.alertService.error()})}finishOrder(){this.ngxLoader.startLoader(_.Fq);let t=this._formDataService.formatFormData(this.finishOrderForm);this.invoicesService.SaveInvoice(t).subscribe(i=>{this.ngxLoader.stopLoader(_.Fq),this.loadentities(),this.modalService.dismissAll()},i=>{console.log(i),this.ngxLoader.stopLoader(_.Fq)})}GetServicesDropDown(){this._servicesService.getDropDown().subscribe(t=>{this.services=t.data},t=>{console.log(t)})}GetOrderServiceAndPayment(t){this.images=[],this.finishOrderDetails=t,this.finishOrderForm={...this.finishOrderForm,orderCode:t.orderCode,discountAdd:t.discountAmountAdd},this.invoicesService.GetOrderServiceAndPayment(t.orderCode).subscribe(n=>{this.finishOrderForm.invoiceService=[],this.OrderServiceAndPayment=n.data,n.data.forEach(a=>{this.finishOrderForm.invoiceService.push({serviceCode:a.serviceCode,service:a.serviceName,notes:a.notes,price:a.price,paidValue:a.paidValue})}),this.calculatePrices()},n=>{console.log(n)})}GetPaymentTypesDropDown(){this.baseService.GetOrderLookUp().subscribe(t=>{this.paymentTypes=t.data.paymentTypes},t=>{console.log(t)})}setService(t){this.finishOrderForm.service=t.name,this.finishOrderForm.price=t.price}addService(){this.finishOrderForm.invoiceService.push({service:this.finishOrderForm.service,serviceCode:this.finishOrderForm.serviceCode,price:this.finishOrderForm.price,notes:this.finishOrderForm.note,paidValue:0}),this.calculatePrices()}calculatePrices(){const t=this.finishOrderForm.discountAdd||0;let i=0,n=0;this.finishOrderForm.invoiceService.forEach(u=>{i+=+u.price,n+=+u.paidValue});let a=0,o=0,s=0;a=.15*(i-t),o=i-t+a,s=o-n,this.finishOrderForm={...this.finishOrderForm,net:o,tax:a,total:i,remain:s,paid:n}}editEachPrice(t){this.finishOrderForm.invoiceService[t].price=this.editPrice,this.isEditPrice=!1,this.calculatePrices()}deleteService(t){console.log(t),this.finishOrderForm.invoiceService.splice(t,1),this.calculatePrices()}onFileChanged(t){if(t.target.files&&t.target.files[0]){let i=t.target.files.length;for(let n=0;n<i;n++){let a=new FileReader;this.finishOrderForm.invoiceAttachImages.push({attachImage:t.target.files.item(n),type:"file"}),console.log(this.finishOrderForm.invoiceAttachImages),a.onload=o=>{this.images.push({id:0,path:o.target.result,completePath:o.target.result})},a.readAsDataURL(t.target.files[n])}}}removeImage(t,i){this.finishOrderForm.invoiceAttachImages.splice(i,1),this.images.splice(i,1)}getServices(t){return t.split("#")}OpenOrderTimeLineModel(t,i,n="md"){this.orderSelected=t,this.modalService.open(i,{centered:!0,size:n})}RollBack(){this.ngxLoader.startLoader(_.Fq),this.baseService.RemoveAssign(this.orderSelected).pipe((0,D.O)(),(0,O.c)(this.mainDelay),(0,w.Z)(),(0,h.Q)(this.notifier),(0,N.j)(()=>this.ngxLoader.stopLoader(_.Fq))).subscribe({next:t=>{this.modalService.dismissAll(),this.loadentities(),this.alertService.success()}})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(f.nX),e.rXU(g.c$),e.rXU(q.Q),e.rXU(y.u),e.rXU(c.vh),e.rXU(v.eD),e.rXU(m.Bq),e.rXU(A.J),e.rXU(Te.U),e.rXU(Se.N),e.rXU(L.V),e.rXU(he.Q),e.rXU(z.h),e.rXU(H.m),e.rXU(J.l),e.rXU(Ie),e.rXU(se.e),e.rXU(f.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-team-assigned-orders"]],viewQuery:function(i,n){if(1&i&&e.GBs(bs,5),2&i){let a;e.mGM(a=e.lsd())&&(n.FileInput=a.first)}},features:[e.Vt3],decls:38,vars:24,consts:[["changeStatusModal",""],["finishOrderModal",""],["orderModel",""],["OrderTimeLineModel",""],["RollBackModal",""],["formEntity","ngForm"],["serviceCode","ngModel"],["note","ngModel"],["paymentTypeCode","ngModel"],["notes","ngModel"],["FileInput",""],[1,"row"],[1,"col-lg-12"],[1,"grid"],[1,"card"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[1,"card-body"],[3,"reset","search","exportXlsx","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","agentName","name","agentName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"col-12","col-md-4","mb-2"],["type","text","mwlFlatpickr","","id","isDate","mode","range",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],["class","col-xxl-3 col-xl-4 col-lg-4 col-md-6 my-2",4,"ngFor","ngForOf"],[1,"col-xxl-3","col-xl-4","col-lg-4","col-md-6","my-2"],[1,"card","ribbon-box","border","shadow-none","mb-lg-0","material-shadow"],[1,"mb-4","d-flex"],[1,"d-flex","justify-content-between","mt-5"],[1,"text-muted"],[1,"ri-calendar-2-fill","text-muted","me-1","align-bottom"],[1,"text-muted","ms-2"],["href","javascript:void(0);"],[1,"text-center"],[1,"ri-user-2-fill","text-muted","me-1","align-bottom"],[1,"d-flex","gap-4","mb-1","justify-content-between"],[1,"text-success"],[1,"ri-map-pin-2-line","text-success","me-1","align-bottom"],["class","badge bg-success-subtle text-success",4,"ngIf"],[1,"ri-phone-fill","text-info","me-1","align-bottom"],[1,"cursor-pointer","badge","bg-info-subtle","text-info","fs-6",3,"click"],[1,"ri-clipboard-line"],[1,"d-flex","gap-4"],[1,"ri-shake-hands-fill","text-primary","me-1","align-bottom"],[4,"ngFor","ngForOf"],[1,"d-flex","justify-content-between",2,"min-height","112px"],[1,"w-50","text-left"],[1,"ri-group-fill","text-primary","me-1","align-bottom"],[1,"w-50","text-right"],[1,"ri-history-fill","text-primary","me-1","align-bottom"],[1,"mt-2","hstack","gap-2"],["class","btn  btn-sm btn-soft-success w-100",3,"click",4,"hasPermission"],["href","javascript:void(0);","class","btn btn-sm btn-soft-primary w-100",3,"click",4,"hasPermission"],[1,"badge","bg-success-subtle","text-success"],[1,"badge","bg-primary-subtle","text-primary","mx-1"],[1,"btn","btn-sm","btn-soft-success","w-100",3,"click"],[1,"ri-swap-line","label-icon","align-bottom","rounded-pill","fs-16","me-2"],["translate","orderManagement.order.changeTeamStatus"],["href","javascript:void(0);",1,"btn","btn-sm","btn-soft-primary","w-100",3,"click"],[1,"ri-checkbox-circle-fill","align-bottom"],["translate","orderManagement.order.finishOrder"],[1,"modal-content","border-0"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["translate","orderManagement.order.changeTeamStatus",1,"fw-bold","fs-4"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"hasProgressBar","fgsType","loaderId"],[3,"ngSubmit"],[1,"mb-3"],["for","actionMismatch","translate","",1,"fw-bold","form-label"],["name","teamStatus","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["class","mb-3",4,"ngIf"],["rows","2","InputTirmFilter","","name","teamStatusNotes","type","text","id","teamStatusNotes",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["type","submit",1,"btn","btn-primary","btn-label","waves-effect","waves-light","rounded-pill",3,"disabled"],[1,"ri-check-double-line","label-icon","align-middle","rounded-pill","fs-16","me-2"],["translate","general.action.save"],["for","cancelReasonName","translate","",1,"required","fw-bold","form-label"],["name","name","bindValue","code","bindLabel","name","required","",3,"ngModelChange","placeholder","items","multiple","ngModel"],["translate","orderManagement.order.assignedOrders.finishOrder",1,"fw-bold","fs-4"],[1,"modal-content"],[1,""],[1,"mt-2","row"],[1,"col-lg-2","mb-3"],["translate","",1,"fw-bold","form-label","w-100"],[1,"col-12","col-lg-4","mb-2"],["name","serviceCode","bindValue","code","bindLabel","name",3,"change","ngModelChange","items","multiple","placeholder","ngModel"],[1,"input-group"],["InputTirmFilter","","name","note","type","text","id","notes",1,"form-control","fs-6",3,"ngModelChange","placeholder","ngModel"],[1,"col-lg-2","mb-2"],[1,"btn","btn-success","py-1","px-2",3,"click"],[1,"ri-add-fill",2,"font-size","1.2rem"],[1,"col-12","text-center","mt-2"],[1,"table","table-bordered"],["translate",""],[4,"ngIf"],[1,"pt-2","row"],[1,"col-12","col-lg-12","mb-3"],["translate","",1,"fw-bold","form-label"],[1,"form-control","custom-form-textArea"],[1,"col-12","col-lg-6","mb-3","d-flex"],["translate","",1,"fw-bold","form-label","w-25"],[1,"form-control","w-75","custom-form-input"],["translate","",1,"fw-bold","form-label","required","w-25"],[1,"w-75"],["name","paymentTypeCode","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],[1,"col-12","col-lg-12","mb-3","d-flex"],["InputTirmFilter","","name","note","rows","3",1,"form-control","fs-6","w-75",3,"ngModelChange","placeholder","ngModel"],[1,"col-12","col-lg-12","mt-3","d-flex"],["translate","",1,"btn","btn-warning","px-5",3,"click"],[1,"my-3","d-flex"],["class","avatar-lg mx-2 position-relative",4,"ngFor","ngForOf"],["multiple","","value","","type","file","accept","image/png, image/gif, image/jpeg",1,"form-control","d-none",3,"change"],[1,"d-flex","gap-2","justify-content-end","my-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger",3,"click","disabled"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],["class","d-flex",4,"ngIf"],[1,"btn","btn-danger","py-1","px-2","me-1",3,"click"],[1,"ri-delete-bin-3-fill",2,"font-size","1.2rem"],[1,"ri-edit-2-fill",2,"font-size","1.2rem"],[1,"d-flex"],["InputTirmFilter","","name","editPrice","type","text","id","editPrice",1,"form-control","fs-6",3,"ngModelChange","placeholder","ngModel"],[1,"btn","btn-success","py-1","px-2","mx-1",3,"click"],[1,"ri-check-double-fill",2,"font-size","1.2rem"],[1,"btn","btn-danger","py-1","px-2",3,"click"],[1,"ri-close-fill",2,"font-size","1.2rem"],["colspan","4"],[1,"avatar-lg","mx-2","position-relative"],[1,"position-absolute","bx","bx-x-circle","text-white",2,"background","red","top","1px","right","-4px","font-size","1rem","border-radius","50%",3,"click"],[1,"avatar-title","bg-light","rounded"],["id","product-img1","alt","",1,"avatar-md","h-auto",3,"src"],[3,"isOrderEdit","isInner","orderCode"],[3,"dismiss","orderSelected"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",11)(1,"div",12)(2,"div",13)(3,"div",14),e.nrm(4,"ngx-ui-loader",15),e.j41(5,"div",16)(6,"base-filter",17),e.bIt("reset",function(){return e.eBV(a),e.Njj(n.onReset())})("search",function(){return e.eBV(a),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(n.onExportXlsx())}),e.qex(7,18),e.j41(8,"div",19)(9,"div",20)(10,"input",21),e.nI1(11,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.orderCode,s)||(n.pagination.orderCode=s),e.Njj(s)}),e.k0s(),e.nrm(12,"i",22),e.k0s()(),e.j41(13,"div",19)(14,"div",20)(15,"input",23),e.nI1(16,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.agentName,s)||(n.pagination.agentName=s),e.Njj(s)}),e.k0s(),e.nrm(17,"i",22),e.k0s()(),e.j41(18,"div",19)(19,"div",20)(20,"input",21),e.nI1(21,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.mobile,s)||(n.pagination.mobile=s),e.Njj(s)}),e.k0s(),e.nrm(22,"i",22),e.k0s()(),e.j41(23,"div",24)(24,"input",25),e.nI1(25,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.creationDates,s)||(n.searchForm.creationDates=s),e.Njj(s)}),e.k0s()(),e.bVm(),e.k0s()()(),e.j41(26,"div",11),e.DNE(27,Ss,52,31,"div",26),e.k0s()()()(),e.DNE(28,ks,24,12,"ng-template",null,0,e.C5r)(30,Os,111,35,"ng-template",null,1,e.C5r)(32,ws,1,3,"ng-template",null,2,e.C5r)(34,Vs,1,1,"ng-template",null,3,e.C5r)(36,Gs,15,3,"ng-template",null,4,e.C5r)}2&i&&(e.R7$(4),e.Y8G("loaderId","assignLoader"),e.R7$(2),e.Y8G("showAdd",!1)("showExport",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(11,16,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.orderCode),e.R7$(5),e.FS9("placeholder",e.bMT(16,18,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.agentName),e.R7$(5),e.FS9("placeholder",e.bMT(21,20,"orderManagement.order.mobile")),e.R50("ngModel",n.pagination.mobile),e.R7$(4),e.FS9("placeholder",e.bMT(25,22,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(3),e.Y8G("ngForOf",n.entities))},dependencies:[c.Sq,c.bT,d.qT,d.me,d.Q0,d.BC,d.cb,d.YS,d.vS,d.cV,R.kL,$.b,Z.L,g.Mm,v.Cv,V.vr,B.m,ne.p,ee,c.vh,g.D9],encapsulation:2})}}return r})();function $s(r,l){if(1&r&&(e.j41(0,"span",58),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",t.districtName," ")}}function Bs(r,l){1&r&&e.nrm(0,"span",59)}function Xs(r,l){1&r&&e.nrm(0,"span",60)}function As(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",26)(1,"div",11)(2,"div",12)(3,"div",27)(4,"button",28),e.nI1(5,"translate"),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),o=e.sdS(45);return a.getEvalById(n.evaluationCode),e.Njj(a.openModal(n.evaluationCode,o,"lg"))}),e.nrm(6,"i",29),e.k0s(),e.j41(7,"button",30),e.nI1(8,"translate"),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),o=e.sdS(41);return e.Njj(a.openModal(n.evaluationCode,o))}),e.nrm(9,"i",31),e.k0s()(),e.j41(10,"a",32)(11,"h5"),e.EFF(12),e.k0s()(),e.j41(13,"div",33)(14,"p",34)(15,"span",35),e.nrm(16,"i",36),e.nI1(17,"translate"),e.EFF(18),e.nI1(19,"date"),e.k0s(),e.j41(20,"span",35),e.nrm(21,"i",36),e.nI1(22,"translate"),e.EFF(23),e.nI1(24,"date"),e.k0s()(),e.j41(25,"p",37),e.EFF(26),e.nI1(27,"translate"),e.k0s()(),e.j41(28,"div",38)(29,"div",39),e.nrm(30,"i",40),e.EFF(31),e.DNE(32,$s,2,1,"span",41),e.k0s(),e.j41(33,"div",35),e.nrm(34,"i",42),e.j41(35,"span",43),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.copytext(n.mobile))}),e.EFF(36),e.nrm(37,"i",44),e.k0s()()(),e.j41(38,"div",45)(39,"div",35),e.qex(40),e.nrm(41,"i",46),e.nI1(42,"translate"),e.j41(43,"span",47),e.EFF(44),e.k0s(),e.bVm(),e.k0s(),e.j41(45,"div",35),e.nrm(46,"i",48),e.nI1(47,"translate"),e.DNE(48,Bs,1,0,"span",49)(49,Xs,1,0,"span",50),e.k0s()(),e.j41(50,"div",51)(51,"a",52),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),o=e.sdS(43);return a.getEvalById(n.evaluationCode),e.Njj(a.openModal(n.evaluationCode,o,"lg"))}),e.nrm(52,"i",53)(53,"span",54),e.k0s(),e.j41(54,"a",55),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),o=e.sdS(47);return e.Njj(a.openModal(n.evaluationCode,o))}),e.nrm(55,"i",56)(56,"span",57),e.k0s()()()()()}if(2&r){const t=l.$implicit;e.R7$(4),e.FS9("pTooltip",e.bMT(5,17,"general.action.view")),e.R7$(3),e.FS9("pTooltip",e.bMT(8,19,"orderManagement.priceEvaluation.cancel")),e.R7$(5),e.JRh(t.agentName),e.R7$(4),e.FS9("pTooltip",e.bMT(17,21,"general.table.creationTime")),e.R7$(2),e.SpI(" ",e.i5U(19,23,t.createdDate,"yyyy-MM-dd HH:mm")," "),e.R7$(3),e.FS9("pTooltip",e.bMT(22,26,"orderManagement.order.visitDate")),e.R7$(2),e.SpI(" ",e.i5U(24,28,t.visitDate,"yyyy-MM-dd HH:mm")," "),e.R7$(3),e.Lme(" ",e.bMT(27,31,"orderManagement.order.orderCode"),": #SO#",t.evaluationCode," "),e.R7$(5),e.SpI(" ",t.cityName," "),e.R7$(),e.Y8G("ngIf",!t.districtName),e.R7$(4),e.SpI("",t.mobile," "),e.R7$(5),e.FS9("pTooltip",e.bMT(42,33,"orderManagement.order.teamName")),e.R7$(3),e.SpI(" ",t.teamName," "),e.R7$(2),e.FS9("pTooltip",e.bMT(47,35,"orderManagement.priceEvaluation.status")),e.R7$(2),e.Y8G("ngIf",t.isUrgent),e.R7$(),e.Y8G("ngIf",!t.isUrgent)}}function Us(r,l){if(1&r){const t=e.RV6();e.j41(0,"cancel-evaluation-model",61),e.bIt("success",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.loadentities())})("dismiss",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("orderId",t.orderSelected)}}function Ys(r,l){if(1&r&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s()()),2&r){const t=l.$implicit;e.R7$(2),e.JRh(t.serviceCode),e.R7$(2),e.JRh(t.price),e.R7$(2),e.JRh(t.notes)}}function Ps(r,l){1&r&&(e.j41(0,"tr")(1,"td",95),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&r&&(e.R7$(2),e.JRh(e.bMT(3,1,"orderManagement.order.noData")))}function zs(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",62)(1,"h4",63),e.nrm(2,"span",64),e.k0s(),e.j41(3,"button",65),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(4,"form",null,4),e.nrm(6,"ngx-ui-loader",66),e.j41(7,"div",67)(8,"div",68)(9,"div",69)(10,"div",7)(11,"div",70)(12,"label",71),e.EFF(13,"orderManagement.order.cityName"),e.k0s(),e.j41(14,"div",72),e.EFF(15),e.k0s()(),e.j41(16,"div",70)(17,"label",71),e.EFF(18,"orderManagement.order.districtName"),e.k0s(),e.j41(19,"div",72),e.EFF(20),e.k0s()(),e.j41(21,"div",70)(22,"label",73),e.EFF(23,"orderManagement.order.date"),e.k0s(),e.j41(24,"div",72),e.EFF(25),e.nI1(26,"date"),e.k0s()()(),e.j41(27,"div",74)(28,"div",75)(29,"table",76)(30,"thead")(31,"tr")(32,"th",77),e.EFF(33," orderManagement.order.service "),e.k0s(),e.j41(34,"th",77),e.EFF(35," orderManagement.order.price "),e.k0s(),e.j41(36,"th",77),e.EFF(37," orderManagement.order.notes "),e.k0s()()(),e.j41(38,"tbody"),e.DNE(39,Ys,7,3,"tr",78)(40,Ps,4,3,"tr",79),e.k0s()()()(),e.j41(41,"div",80)(42,"div",81)(43,"label",82),e.EFF(44),e.nI1(45,"translate"),e.k0s(),e.j41(46,"span",83),e.EFF(47),e.nI1(48,"translate"),e.nI1(49,"translate"),e.k0s()(),e.j41(50,"div",84)(51,"label",85),e.EFF(52,"orderManagement.order.notes"),e.k0s(),e.j41(53,"span",86),e.EFF(54),e.k0s()(),e.j41(55,"div",87)(56,"label",88),e.EFF(57,"orderManagement.order.assignDate"),e.k0s(),e.j41(58,"div",89)(59,"input",90,5),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.assignForm.assignDate,n)||(a.assignForm.assignDate=n),e.Njj(n)}),e.k0s()()(),e.j41(61,"div",87)(62,"label",88),e.EFF(63,"orderManagement.order.team"),e.k0s(),e.j41(64,"ng-select",91,6),e.nI1(66,"translate"),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.assignForm.teamCode,n)||(a.assignForm.teamCode=n),e.Njj(n)}),e.k0s()()(),e.j41(67,"div",92)(68,"button",93),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.ChangeAssignTeam())}),e.k0s(),e.j41(69,"button",94),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()()}if(2&r){const t=e.XpG();e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader),e.R7$(9),e.SpI(" ",t.evaluationDetails.cityName||"--"," "),e.R7$(5),e.SpI(" ",t.evaluationDetails.districtName||"--"," "),e.R7$(5),e.SpI(" ",e.i5U(26,16,t.evaluationDetails.visitDate,"yyyy-MM-dd")," "),e.R7$(14),e.Y8G("ngForOf",t.evaluationDetails.evaluationservices),e.R7$(),e.Y8G("ngIf",!t.evaluationDetails.evaluationservices),e.R7$(4),e.SpI(" ",e.bMT(45,19,"orderManagement.order.isUrgent")," "),e.R7$(3),e.SpI(" ",t.evaluationDetails.isUrgent?e.bMT(48,21,"orderManagement.order.yes"):e.bMT(49,23,"orderManagement.order.no")," "),e.R7$(7),e.SpI(" ",t.evaluationDetails.notes||"--"," "),e.R7$(5),e.R50("ngModel",t.assignForm.assignDate),e.R7$(5),e.FS9("placeholder",e.bMT(66,25,"orderManagement.order.team")),e.Y8G("items",t.teams)("multiple",!1),e.R50("ngModel",t.assignForm.teamCode)}}function Hs(r,l){if(1&r&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s()()),2&r){const t=l.$implicit;e.R7$(2),e.JRh(t.serviceCode),e.R7$(2),e.JRh(t.price),e.R7$(2),e.JRh(t.notes)}}function Js(r,l){1&r&&(e.j41(0,"tr")(1,"td",95),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&r&&(e.R7$(2),e.JRh(e.bMT(3,1,"orderManagement.order.noData")))}function qs(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",62)(1,"h4",63),e.nrm(2,"span",96),e.k0s(),e.j41(3,"button",65),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(4,"form",null,4),e.nrm(6,"ngx-ui-loader",66),e.j41(7,"div",67)(8,"div",68)(9,"div",69)(10,"div",7)(11,"div",70)(12,"label",71),e.EFF(13,"orderManagement.order.cityName"),e.k0s(),e.j41(14,"div",72),e.EFF(15),e.k0s()(),e.j41(16,"div",70)(17,"label",71),e.EFF(18,"orderManagement.order.districtName"),e.k0s(),e.j41(19,"div",72),e.EFF(20),e.k0s()(),e.j41(21,"div",70)(22,"label",73),e.EFF(23,"orderManagement.order.date"),e.k0s(),e.j41(24,"div",72),e.EFF(25),e.nI1(26,"date"),e.k0s()()(),e.j41(27,"div",74)(28,"div",75)(29,"table",76)(30,"thead")(31,"tr")(32,"th",77),e.EFF(33," orderManagement.order.service "),e.k0s(),e.j41(34,"th",77),e.EFF(35," orderManagement.order.price "),e.k0s(),e.j41(36,"th",77),e.EFF(37," orderManagement.order.notes "),e.k0s()()(),e.j41(38,"tbody"),e.DNE(39,Hs,7,3,"tr",78)(40,Js,4,3,"tr",79),e.k0s()()()(),e.j41(41,"div",80)(42,"div",81)(43,"label",82),e.EFF(44),e.nI1(45,"translate"),e.k0s(),e.j41(46,"span",83),e.EFF(47),e.nI1(48,"translate"),e.nI1(49,"translate"),e.k0s()(),e.j41(50,"div",84)(51,"label",85),e.EFF(52,"orderManagement.order.notes"),e.k0s(),e.j41(53,"span",86),e.EFF(54),e.k0s()()(),e.j41(55,"div",92)(56,"button",94),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()()}if(2&r){const t=e.XpG();e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader),e.R7$(9),e.SpI(" ",t.evaluationDetails.cityName||"--"," "),e.R7$(5),e.SpI(" ",t.evaluationDetails.districtName||"--"," "),e.R7$(5),e.SpI(" ",e.i5U(26,11,t.evaluationDetails.visitDate,"yyyy-MM-dd")," "),e.R7$(14),e.Y8G("ngForOf",t.evaluationDetails.evaluationservices),e.R7$(),e.Y8G("ngIf",!t.evaluationDetails.evaluationservices),e.R7$(4),e.SpI(" ",e.bMT(45,14,"orderManagement.order.isUrgent")," "),e.R7$(3),e.SpI(" ",t.evaluationDetails.isUrgent?e.bMT(48,16,"orderManagement.order.yes"):e.bMT(49,18,"orderManagement.order.no")," "),e.R7$(7),e.SpI(" ",t.evaluationDetails.notes||"--"," ")}}function Qs(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",62)(1,"h4",63),e.nrm(2,"span",97),e.k0s(),e.j41(3,"button",65),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()(),e.j41(4,"form",null,4),e.nrm(6,"ngx-ui-loader",66),e.j41(7,"div",67)(8,"div",68)(9,"div",98),e.nrm(10,"lord-icon",99),e.j41(11,"div",100),e.nrm(12,"h3",101)(13,"p",102),e.k0s()(),e.j41(14,"div",103)(15,"button",93),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.FinishEvaluation())}),e.k0s(),e.j41(16,"button",94),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss())}),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(6),e.Y8G("hasProgressBar",!1)("fgsType",t.loaderOperationShap)("loaderId",t.deleteLoader)}}let Ws=(()=>{class r extends G.w{constructor(t,i,n,a,o,s,b,u,j,F,x,T,I,X){super(t,i,u,n,o,s,b),this.baseService=n,this.orderPendingService=a,this.authDaamService=j,this.excelService=F,this.cityService=x,this.districtService=T,this.channelService=I,this.router=X,this.title="orderManagement.assignEvaluation.title",this.titleOperation="orderManagement.assignEvaluation.titleOperation",this.keySelected="",this.assignUsers=[],this.times=[],this.teams=[],this.employees=[],this.searchForm={},this.assignForm={},this.isResolveList=!1,this.employeeGroups=[],this.activeindex="1",this.active=1,this.formPassword={},this.roles=[],this.userTypes=[],this.actives=[{id:!0,name:"active"},{id:!1,name:"noActive"}],this.countLoad=2,this.orderSelected=0,this.selectedCallCounter=0,this.cities=[],this.districts=[],this.channels=[],this.callHistory={},this.loadentities(),this.GetCities(),this.getEvalTeams()}GetCities(){this.cityService.getDropDown().subscribe(t=>{this.cities=t.data},t=>{console.log(t)})}GetDistricts(t){this.districtService.getByCityId(t).subscribe(i=>{this.districts=i.data},i=>{console.log(i)})}GetChannels(){this.channelService.getDropDown().subscribe(t=>{this.channels=t.data},t=>{console.log(t)})}ngOnInitMore(){}mapForm(t){return{...t}}onUpdateIsActive(t){this.baseService.updateActive(t).pipe((0,h.Q)(this.notifier)).subscribe(i=>{i?this.alertService.success():this.alertService.error("general.message."+i)},i=>{this.alertService.error()})}mapRegisterForm(t){let i={...t};return i.employeeCode=0,i}onSearch(){var i;if(this.ngxLoader.startLoader(_.a7),console.log(this.searchForm),(i=this.searchForm.dates)+void 0&&i.includes("to")){var t=i.split("to").map(n=>n.trim());this.pagination.visitDateFrom=t[0]+"T00:00:00.000",this.pagination.visitDateTo=t[1]+"T23:59:59.999",this.loadentities()}else this.pagination.visitDateFrom=null,this.pagination.visitDateTo=null;(i=this.searchForm.creationDates)+void 0&&i.includes("to")?(t=i.split("to").map(a=>a.trim()),this.pagination.creationDateFrom=t[0]+"T00:00:00.000",this.pagination.creationDateTo=t[1]+"T23:59:59.999",this.loadentities()):(this.pagination.creationDateFrom=null,this.pagination.creationDateTo=null),this.pagination.subject=this.searchForm.name,null!=this.searchForm.status&&(this.pagination.status=Number.parseInt(this.searchForm.status)),null!=this.searchForm.priority&&(this.pagination.priority=Number.parseInt(this.searchForm.priority)),this.loadentities()}loadentities(){this.countLoad=this.countLoad+1,(!this.isResolveList||1!==this.countLoad)&&(this.ngxLoader.startLoader("assignEvalLoader"),this.pagination.isEvaluationAssign=!0,this.baseService.get(this.pagination).pipe((0,h.Q)(this.notifier)).subscribe(t=>{this.ngxLoader.stopLoader("assignEvalLoader"),this.entities=t.data,this.pagination.totalItems=t.totalItems,this.LoadSuccess()},t=>{this.ngxLoader.stopLoader("assignEvalLoader"),this.alertService.error(t)}),this.checkMore=this.checkOne=this.checkAll=!1,this.lengthSelect=0,this.selectedRow=[])}mapExcel(){let t=[];return this.entities.forEach(i=>{t.push({orderCode:i.orderCode,visitDate:i.visitDate,notes:i.notes,createdDate:i.createdDate,assignDate:i.assignDate,finishDate:i.finishDate,districtName:i.districtName,cityName:i.cityName,agentName:i.agentName,mobile:i.mobile,email:i.email,creationUser:i.creationUser,channelName:i.channelName,teamNames:i.teamNames,services:i.services,workTimes:i.workTimes,paymentTypeName:i.paymentTypeName,finishUser:i.finishUser,isCancel:i.isCancel,isReopen:i.isReopen,isFree:i.isFree,isFinish:i.isFinish})}),t}onExportXlsx(){let t=this.mapExcel();this.excelService.exportAsExcelFile(t,"User",[])}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}goRegister(){this.router.navigateByUrl("/managment/order/new")}goEdit(t){this.router.navigateByUrl("/managment/order/new")}getStatus(t){return t.isCancel?"bg-warning-subtle text-warning":t.isFinish?"bg-success-subtle text-success":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen||t.isFree?"bg-warning-subtle text-warning":"bg-success-subtle text-success"}getTrnslate(t){return t.isCancel?"orderManagement.order.cancel":t.isFinish?"orderManagement.order.finish":t.isUrgent?"bg-danger-subtle text-danger":t.isReopen?"orderManagement.order.reopen":t.isFree?"orderManagement.order.free":"orderManagement.order.finished"}openModal(t,i,n="md"){this.orderSelected=t,this.assignForm.code=t,this.modalService.open(i,{centered:!0,size:n})}oncityChange(t){this.GetDistricts(t.code)}copytext(t){navigator.clipboard.writeText(t),this.alertService.info(t)}getEvalById(t){this.baseService.getById(t).subscribe(i=>{this.evaluationDetails=i.data,this.assignForm.teamCode=i.date.teamCode,this.assignForm.assignDate=i.date.assignDate},()=>{this.alertService.error()})}getEvalTeams(){this.baseService.EvaluationLookUp().subscribe(t=>{this.teams=t.data.teams},()=>{this.alertService.error()})}ChangeAssignTeam(){this.ngxLoader.startLoader(_.Fq),this.baseService.ChangeAssignTeam(this.assignForm).subscribe(t=>{this.ngxLoader.stopLoader(_.Fq),this.loadentities(),this.modalService.dismissAll(),t.success?this.alertService.success():this.alertService.error("general.message."+t.message)},()=>{this.alertService.error(),this.ngxLoader.stopLoader(_.Fq)})}FinishEvaluation(){this.ngxLoader.startLoader(_.Fq),this.baseService.SaveEvaluationFinish({}).subscribe(t=>{this.ngxLoader.stopLoader(_.Fq),this.loadentities(),this.modalService.dismissAll(),t.success?this.alertService.success():this.alertService.error("general.message."+t.message)},()=>{this.alertService.error(),this.ngxLoader.stopLoader(_.Fq)})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(f.nX),e.rXU(g.c$),e.rXU(oe.W),e.rXU(de.H),e.rXU(y.u),e.rXU(c.vh),e.rXU(v.eD),e.rXU(m.Bq),e.rXU(A.J),e.rXU(L.V),e.rXU(z.h),e.rXU(H.m),e.rXU(J.l),e.rXU(f.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-team-assign-evaluation"]],features:[e.Vt3],decls:48,vars:42,consts:[["deleteModal",""],["evaluateModal",""],["showModal",""],["finishModal",""],["formEntity","ngForm"],["assignDate","ngModel"],["teamCode","ngModel"],[1,"row"],[1,"col-lg-12"],[1,"grid"],["overlayColor","rgba(255,255,255,0.05)","fgsColor","rgba(255,255,255,0)",3,"loaderId"],[1,"card"],[1,"card-body"],[3,"reset","search","exportXlsx","showAdd","showExport","totalItems","title"],["control",""],[1,"col-12","col-md-2","mb-2"],[1,"search-box"],["InputTirmFilter","","type","number","id","filterValue","name","filterValue",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],[1,"ri-search-line","search-icon"],["InputTirmFilter","","type","search","id","agentName","name","agentName",1,"form-control","search","bg-light","border-light",3,"ngModelChange","placeholder","ngModel"],["name","name","bindValue","code","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],["name","name","bindValue","code","bindLabel","name",3,"change","ngModelChange","placeholder","items","multiple","ngModel"],["name","employeeCode","bindValue","id","bindLabel","name",3,"ngModelChange","placeholder","items","multiple","ngModel"],[1,"col-12","col-md-4","mb-2"],["type","text","mwlFlatpickr","","id","isDate","mode","range",1,"form-control","bg-light","border-light","flatpickr-input","active",3,"ngModelChange","altInput","convertModelValue","placeholder","ngModel"],["class","col-xxl-3 col-xl-4 col-lg-4 col-md-6",4,"ngFor","ngForOf"],[1,"col-xxl-3","col-xl-4","col-lg-4","col-md-6"],[1,"mb-4","d-flex","justify-content-between"],["tooltipPosition","top","type","button","data-bs-toggle","button","aria-pressed","true",1,"btn","btn-icon","btn-soft-primary","float-end",3,"click","pTooltip"],[1,"ri-eye-fill","fs-16"],["tooltipPosition","top","type","button","data-bs-toggle","button","aria-pressed","true",1,"btn","btn-icon","btn-soft-danger","float-end",3,"click","pTooltip"],[1,"ri-chat-delete-fill","fs-16"],["href","javascript:void(0);"],[1,""],[1,"text-muted"],[1,"w-50"],["tooltipPosition","top",1,"ri-calendar-2-fill","text-muted","me-1","align-bottom",3,"pTooltip"],[1,"text-muted","ms-2"],[1,"d-flex","gap-4","mb-1"],[1,"text-success","w-50"],[1,"ri-map-pin-2-line","text-success","me-1","align-bottom"],["class","badge bg-success-subtle text-success",4,"ngIf"],[1,"ri-phone-fill","text-info","me-1","align-bottom"],[1,"cursor-pointer","badge","bg-info-subtle","text-info","fs-6",3,"click"],[1,"ri-clipboard-line"],[1,"d-flex","gap-4"],["tooltipPosition","top",1,"ri-user-2-fill","text-primary","me-1","align-bottom","fs-6",3,"pTooltip"],[1,"badge","bg-primary-subtle","text-primary","mx-1"],["tooltipPosition","top",1,"ri-flag-2-fill","text-primary","me-1","align-bottom","fs-6",3,"pTooltip"],["class","badge bg-danger-subtle text-danger","translate","orderManagement.priceEvaluation.isUrgent",4,"ngIf"],["class","badge bg-success-subtle text-success","translate","orderManagement.priceEvaluation.normal",4,"ngIf"],[1,"mt-2","hstack","gap-2"],[1,"btn","btn-soft-success","w-100",3,"click"],[1,"ri-user-follow-fill","label-icon","align-bottom","rounded-pill","fs-16","me-2"],["translate","orderManagement.priceEvaluation.reassign"],["href","javascript:void(0);",1,"btn","btn-soft-primary","w-100",3,"click"],[1,"ri-checkbox-circle-fill","align-bottom","me-2"],["translate","orderManagement.finishedEvaluation.finish"],[1,"badge","bg-success-subtle","text-success"],["translate","orderManagement.priceEvaluation.isUrgent",1,"badge","bg-danger-subtle","text-danger"],["translate","orderManagement.priceEvaluation.normal",1,"badge","bg-success-subtle","text-success"],[3,"success","dismiss","orderId"],[1,"modal-header","p-3","bg-info-subtle"],[1,"card-title","mb-0"],["translate","orderManagement.assignEvaluation.reassignEval",1,"fw-bold","fs-4"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[3,"hasProgressBar","fgsType","loaderId"],[1,"modal-content"],[1,"modal-body"],[1,"mx-4"],[1,"col-12","col-md-4","mb-3"],["translate","",1,"fw-bold","form-label","w-100"],[1,"form-control","w-100"],["for","visitDate","translate","",1,"fw-bold","form-label"],[1,"mt-4","row",2,"border-top","1px solid rgba(128,128,128,0.29)"],[1,"col-12","text-center","mt-4"],[1,"table","table-bordered"],["translate",""],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"mt-4","pt-3","row",2,"border-top","1px solid rgba(128,128,128,0.29)"],[1,"col-md-12","mb-3","d-flex"],[1,"fw-bold","form-label","w-25"],[1,"fw-bold","form-label","w-75"],[1,"col-12","col-md-12","mb-3","d-flex"],["translate","",1,"fw-bold","form-label","w-25"],[1,"fw-bold","form-label","w-75","form-control","py-3"],[1,"col-12","col-md-6","mb-3"],["for","assignDate","translate","",1,"fw-bold","form-label"],[1,"input-group"],["InputTirmFilter","","name","mobile","type","date","id","assignDate",1,"form-control","fs-6",3,"ngModelChange","ngModel"],["name","teamCode","bindValue","id","bindLabel","name",3,"ngModelChange","items","multiple","placeholder","ngModel"],[1,"d-flex","gap-2","justify-content-end","mt-4","mb-2"],["type","submit","id","save","translate","general.action.save",1,"btn","w-sm","btn-danger",3,"click"],["type","button","data-bs-dismiss","modal","translate","general.action.close",1,"btn","w-sm","btn-light",3,"click"],["colspan","4"],["translate","orderManagement.assignEvaluation.title",1,"fw-bold","fs-4"],["translate","orderManagement.finishedEvaluation.title",1,"fw-bold","fs-4"],[1,"mt-2","text-center"],["src","https://cdn.lordicon.com/gdfrsvpt.json","stroke","bold","state","hover-oscillate","trigger","loop","colors","primary:#f7b84b,secondary:#f06548",2,"width","130px","height","130px"],[1,"pt-2","fs-15","mx-4","mx-sm-5"],["translate","orderManagement.order.AreYouSureMessage"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",7)(1,"div",8)(2,"div",9),e.nrm(3,"ngx-ui-loader",10),e.j41(4,"div",11)(5,"div",12)(6,"base-filter",13),e.bIt("reset",function(){return e.eBV(a),e.Njj(n.onReset())})("search",function(){return e.eBV(a),e.Njj(n.onSearch())})("exportXlsx",function(){return e.eBV(a),e.Njj(n.onExportXlsx())}),e.qex(7,14),e.j41(8,"div",15)(9,"div",16)(10,"input",17),e.nI1(11,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.orderCode,s)||(n.pagination.orderCode=s),e.Njj(s)}),e.k0s(),e.nrm(12,"i",18),e.k0s()(),e.j41(13,"div",15)(14,"div",16)(15,"input",19),e.nI1(16,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.agentName,s)||(n.pagination.agentName=s),e.Njj(s)}),e.k0s(),e.nrm(17,"i",18),e.k0s()(),e.j41(18,"div",15)(19,"div",16)(20,"input",17),e.nI1(21,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.mobile,s)||(n.pagination.mobile=s),e.Njj(s)}),e.k0s(),e.nrm(22,"i",18),e.k0s()(),e.j41(23,"div",15)(24,"div",16)(25,"ng-select",20),e.nI1(26,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.channelCode,s)||(n.pagination.channelCode=s),e.Njj(s)}),e.k0s()()(),e.j41(27,"div",15)(28,"div",16)(29,"ng-select",21),e.nI1(30,"translate"),e.bIt("change",function(s){return e.eBV(a),e.Njj(n.oncityChange(s))}),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.cityCode,s)||(n.pagination.cityCode=s),e.Njj(s)}),e.k0s()()(),e.j41(31,"div",15)(32,"div",16)(33,"ng-select",22),e.nI1(34,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.pagination.districtName,s)||(n.pagination.districtName=s),e.Njj(s)}),e.k0s()()(),e.j41(35,"div",23)(36,"input",24),e.nI1(37,"translate"),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchForm.creationDates,s)||(n.searchForm.creationDates=s),e.Njj(s)}),e.k0s()(),e.bVm(),e.k0s()()(),e.j41(38,"div",7),e.DNE(39,As,57,37,"div",25),e.k0s()()()(),e.DNE(40,Us,1,1,"ng-template",null,0,e.C5r)(42,zs,70,27,"ng-template",null,1,e.C5r)(44,qs,57,20,"ng-template",null,2,e.C5r)(46,Qs,17,3,"ng-template",null,3,e.C5r)}2&i&&(e.R7$(3),e.Y8G("loaderId","assignLoader"),e.R7$(3),e.Y8G("showAdd",!1)("showExport",!1)("totalItems",n.pagination.totalItems)("title",n.title),e.R7$(4),e.FS9("placeholder",e.bMT(11,28,"orderManagement.order.orderCode")),e.R50("ngModel",n.pagination.orderCode),e.R7$(5),e.FS9("placeholder",e.bMT(16,30,"orderManagement.order.agentName")),e.R50("ngModel",n.pagination.agentName),e.R7$(5),e.FS9("placeholder",e.bMT(21,32,"orderManagement.order.mobile")),e.R50("ngModel",n.pagination.mobile),e.R7$(5),e.FS9("placeholder",e.bMT(26,34,"orderManagement.order.channelName")),e.Y8G("items",n.channels)("multiple",!1),e.R50("ngModel",n.pagination.channelCode),e.R7$(4),e.FS9("placeholder",e.bMT(30,36,"orderManagement.order.cityName")),e.Y8G("items",n.cities)("multiple",!1),e.R50("ngModel",n.pagination.cityCode),e.R7$(4),e.FS9("placeholder",e.bMT(34,38,"orderManagement.order.districtName")),e.Y8G("items",n.districts)("multiple",!1),e.R50("ngModel",n.pagination.districtName),e.R7$(3),e.FS9("placeholder",e.bMT(37,40,"orderManagement.order.creationDate")),e.Y8G("altInput",!0)("convertModelValue",!0),e.R50("ngModel",n.searchForm.creationDates),e.R7$(3),e.Y8G("ngForOf",n.entities))},dependencies:[c.Sq,c.bT,d.qT,d.me,d.Q0,d.BC,d.cb,d.vS,d.cV,R.kL,$.b,g.Mm,v.Cv,V.vr,B.m,K.m,me,c.vh,g.D9]})}}return r})();function Ks(r,l){1&r&&e.nrm(0,"app-team-assigned-orders")}function Zs(r,l){1&r&&e.nrm(0,"app-team-assign-evaluation")}function eo(r,l){1&r&&e.nrm(0,"app-team-expenses-orders")}const no=[{path:"list",component:gr,canActivate:[re.g],data:{permission:["order.view"]}},{path:"eval-list",component:xa,canActivate:[re.g],data:{permission:["priceEval.view"]}},{path:"map",component:Ee,canActivate:[re.g],data:{permission:["leads.register"]}},{path:"new",component:Ta,canActivate:[re.g],data:{permission:["order.register"]}},{path:"timeAvailable",component:hr,data:{roles:[]}},{path:"expenses-items",component:La,resolve:{data:$a},canActivate:[re.g],data:{permission:["expensesItems.view"]}},{path:"expenses-orders",component:es,resolve:{data:ts},canActivate:[re.g],data:{permission:["expensesOrders.view"]}},{path:"team-assign",component:(()=>{class r{constructor(){this.active=1,this.activeindex="1"}onNavChange(t){1===t.nextId&&(this.activeindex="1"),3===t.nextId&&(this.activeindex="3")}static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-Team-container"]],decls:17,vars:5,consts:[["nav","ngbNav"],[1,"row"],[1,"col-lg-12"],["ngbNav","",1,"nav","nav-tabs-custom","card-header-tabs","border-bottom-0",3,"activeIdChange","navChange","activeId"],[3,"ngbNavItem"],["ngbNavLink",""],["translate","orderManagement.order.assignedOrders.title"],["ngbNavContent",""],["translate","orderManagement.assignEvaluation.title"],["translate","orderManagement.expensesOrders.title"],[1,"mt-2",3,"ngbNavOutlet"]],template:function(i,n){if(1&i){const a=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"ul",3,0),e.mxI("activeIdChange",function(s){return e.eBV(a),e.DH7(n.active,s)||(n.active=s),e.Njj(s)}),e.bIt("navChange",function(s){return e.eBV(a),e.Njj(n.onNavChange(s))}),e.j41(4,"li",4)(5,"a",5),e.nrm(6,"span",6),e.k0s(),e.DNE(7,Ks,1,0,"ng-template",7),e.k0s(),e.j41(8,"li",4)(9,"a",5),e.nrm(10,"span",8),e.k0s(),e.DNE(11,Zs,1,0,"ng-template",7),e.k0s(),e.j41(12,"li",4)(13,"a",5),e.nrm(14,"span",9),e.k0s(),e.DNE(15,eo,1,0,"ng-template",7),e.k0s()(),e.nrm(16,"div",10),e.k0s()()}if(2&i){const a=e.sdS(3);e.R7$(2),e.R50("activeId",n.active),e.R7$(2),e.Y8G("ngbNavItem",1),e.R7$(4),e.Y8G("ngbNavItem",2),e.R7$(4),e.Y8G("ngbNavItem",3),e.R7$(4),e.Y8G("ngbNavOutlet",a)}},dependencies:[m.Um,m.X9,m.sy,m.Gx,m.Ri,m.WA,m.m_,g.Mm,us,Ls,Ws],encapsulation:2})}}return r})(),canActivate:[re.g],data:{permission:["assigned.view"]}}];let io=(()=>{class r{static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275mod=e.$C({type:r})}static{this.\u0275inj=e.G2t({imports:[f.iI.forChild(no),f.iI]})}}return r})();var ro=p(71144);let ao=(()=>{class r{constructor(){(0,M.eV)(k().loadAnimation)}static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275mod=e.$C({type:r})}static{this.\u0275inj=e.G2t({imports:[c.MD,d.YN,d.X1,m.zH,m.Pv,m.c9,R.ND,E.r,io,S.G,g.h,C.bG,le.q4,Me.H_,m.c9,v.th,V.MQ,m.n8,ro.j,m._f,K.S]})}}return r})()},99902:(ge,W,p)=>{p.d(W,{Q:()=>d});var c=p(54438);let d=(()=>{class m{constructor(){}formatFormData(E){const M=new FormData,Q=(k,S)=>{if(null!=S)if(S instanceof File||S instanceof Blob)M.append(k,S);else if(Array.isArray(S))S.forEach((g,C)=>{if("object"==typeof g&&null!==g)for(const le in g)g.hasOwnProperty(le)&&Q(`${k}[${C}].${le}`,g[le]);else Q(`${k}[${C}]`,g)});else if("object"==typeof S)for(const g in S)S.hasOwnProperty(g)&&Q(`${k}.${g}`,S[g]);else M.append(k,S)};for(const k in E)E.hasOwnProperty(k)&&Q(k,E[k]);return M}formatBody(E){for(const M in E)Array.isArray(E[M])&&E[M].length>0?Object?.keys(E[M][0])?.length>1&&E[M].forEach((Q,k)=>{for(const S in Q)(!Q[S]||0===Q[S])&&delete Q[S]}):!E[M]&&!1!==E[M]&&delete E[M];return E}static{this.\u0275fac=function(M){return new(M||m)}}static{this.\u0275prov=c.jDH({token:m,factory:m.\u0275fac,providedIn:"root"})}}return m})()}}]);